/*
 Joel Espinosa Longi
 j.longi@gmail.com
 https://github.com/jlongi/DescartesJS
 LGPL - http://www.gnu.org/licenses/lgpl.html
 2014-07-19
*/
var babel=function(a){if(a.loadLib)return a;a.falso=a["false"]=a.fals=a.gezurra=a.faux=a.fals="false";a.verdadero=a["true"]=a.veritable=a.egia=a.vrai=a.verdadeiro=a.veritable="true";a.no=a.ez=a.non=a["n\u00e3o"]="false";a["s\u00ed"]=a.yes=a.bai=a.oui=a.si=a["sim "]="true";a.negro=a.black=a.negre=a.beltza=a.noir=a.preto=a["#000000"]="#000000";a.maxenta=a.magenta=a["#ff00ff"]="#ff00ff";a.azul=a.blue=a.blau=a.urdina=a.bleu=a["#0000ff"]="#0000ff";a.turquesa=a.cyan=a.turkesa=a.turquoise=a["#00ffff"]="#00ffff";
a.verde=a.green=a.verd=a.berdea=a.vert=a["#00ff00"]="#00ff00";a.amarillo=a.yellow=a.groc=a.horia=a.jaune=a.amarelo=a["#ffff00"]="#ffff00";a.naranja=a.orange=a.taronja=a.laranja=a.laranxa=a["#ffc800"]="#ffc800";a.rojo=a.red=a.vermell=a.gorria=a.rouge=a.vermello=a.vermelho=a["#ff0000"]="#ff0000";a.pink=a.rosa=a.arrosa=a.rose=a["#ffafaf"]="#ffafaf";a.grisObscuro=a.darkGray=a.grisFosc=a["gris iluna"]=a.grisObscur=a.grisEscuro=a.cinzaEscuro=a["#404040"]="#404040";a.gris=a.gray=a.grisa=a.cinza=a["#808080"]=
"#808080";a.grisClaro=a.lightGray=a.grisClar=a["gris argia"]=a.grisClair=a.cinzaClaro=a["#c0c0c0"]="#c0c0c0";a.blanco=a.white=a.blanc=a.zuria=a.branco=a["#ffffff"]="#ffffff";a.escala=a.scale=a.eskala=a["\u00e9chelle"]="scale";a.nombre=a.name=a.nom=a.izena=a.nome="name";a.ikusgai=a["vis\u00edvel"]=a.visible="visible";a.rastro=a.trace=a.rastre=a.arrastoa="trace";a.fondo=a.background=a.fons=a.hondoa=a.fond=a.fundo="background";a["par\u00e1metro"]=a.parameter=a.parametroa=a["par\u00e2metro"]=a["par\u00e0metre"]=
"parameter";a["sucesi\u00f3n"]=a.sequence=a["successi\u00f3"]=a.segida=a.succession=a["seq\u00fc\u00eancia"]="sequence";a["tama\u00f1o"]=a.size=a.neurria=a.taille=a.tamanho=a["grand\u00e0ria"]="size";a.decimales=a.decimals=a.hamartarra=a["d\u00e9cimales"]=a.decimais="decimals";a.red=a.net=a.xarxa=a.sarea=a["r\u00e9seau"]=a.rede=a.malha="net";a.red10=a.net10=a.xarxa10=a.sarea10=a["r\u00e9seau10"]=a.rede10=a.malha10="net10";a.ejes=a.axes=a.eixos=a.ardatzak=a.eixes="axes";a.texto=a.text=a.testua=a.texte=
"text";a["cr\u00e9ditos"]=a.about=a["cr\u00e8dits"]=a.kreditoak=a["cr\u00e9dits"]=a.sobre="about";a.config=a.konfig=a["configura\u00e7\u00e3o"]="config";a.limpiar=a.clear=a.neteja=a.ezabatu=a.nettoye=a.limpar="clear";a.incr=a.gehi=a.incremento="incr";a.min=a.inf="min";a.max=a.sup=a["m\u00e1x"]="max";a.relleno=a.fill=a.ple=a.betea=a.plein=a.recheo=a.preencher="fill";a["relleno+"]=a["fill+"]=a["ple+"]=a["betea+"]=a["plein+"]=a["recheo+"]=a["preencher+"]=a.fillP="fillP";a["relleno-"]=a["fill-"]=a["ple-"]=
a["betea-"]=a["plein-"]=a["recheo-"]=a["preencher-"]=a.fillM="fillM";a.flecha=a.arrow=a.fletxa=a.gezia=a["fl\u00e8che"]=a.frecha=a.seta="arrow";a.ancho=a.width=a.ample=a.zabalera=a.large=a.largura="width";a.punta=a.spear=a.muturra=a.pointe=a.ponta="spear";a["regi\u00f3n"]=a.region=a["regi\u00f3"]=a.eskualde=a["r\u00e9gion"]=a["rexi\u00f3n"]=a["regi\u00e3o"]="region";a.norte=a.north=a.nord=a.ipar="north";a.sur=a.south=a.sud=a.hego=a.sul="south";a.este=a.east=a.est=a.ekialde=a.leste="east";a.oeste=
a.west=a.oest=a.hegoalde=a.ouest="west";a.exterior=a.external=a.kanpoalde=a.externo="external";a["expresi\u00f3n"]=a.expresion=a["expresi\u00f3"]=a.adierazpen=a["express\u00e3o"]="expresion";a.tipo=a.type=a.tipus=a.mota="type";a["posici\u00f3n"]=a.position=a["posici\u00f3"]=a.posizio=a["posi\u00e7\u00e3o"]="position";a["constricci\u00f3n"]=a.constraint=a["constricci\u00f3"]=a.beharte=a.constriction=a["constrici\u00f3n"]=a["restri\u00e7\u00e3o"]="constraint";a.valor=a.value=a.balio=a.valeur="value";
a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.curva=a.curve=a.corba=a.kurba=a.courbe="curve";a.texto=a.text=a.testu=a.texte="text";a.punto=a.point=a.punt=a.puntu=a.ponto="point";a.segmento=a.segment=a.zuzenki="segment";a.arco=a.arc=a.arku="arc";a["pol\u00edgono"]=a.polygon=a["pol\u00edgon"]=a.poligono=a.polygone="polygon";a.imagen=a.image=a.imatge=a.irudi=a.imaxe=a.imagem="image";a["Versi\u00f3n"]=a.Version=a["Versi\u00f3"]=a["Vers\u00e3o"]=
a.version="version";a.Idioma=a.Language=a.Hizkuntza=a.Langue=a.language="language";a["O.x"]="O.x";a["O.y"]="O.y";a.Botones=a.Buttons=a.Botons=a.Botoiak=a.Boutons=a["Bot\u00f3ns"]=a["Bot\u00f5es"]=a.Botons="Buttons";a["Animaci\u00f3n"]=a.Animation=a["Animaci\u00f3"]=a.Animazio=a["Anima\u00e7\u00e3o"]="Animation";a.constante=a.constant=a.Konstante="constant";a.fuente=a.font=a.iturri=a.source=a.fonte="font";a["num\u00e9rico"]=a.numeric=a["num\u00e8ric"]=a.zenbakizko=a["num\u00e9rique"]="numeric";a["gr\u00e1fico"]=
a.graphic=a["gr\u00e0fic"]=a.grafiko=a.graphique="graphic";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.hacer=a["do"]=a.fer=a.egin=a.faire=a.facer=a.fazer=a.doExpr="doExpr";a.mientras=a["while"]=a.mentre=a.bitartean=a["tandis que"]=a.mentres=a.enquanto=a.whileExpr="whileExpr";a.evaluar=a.evaluate=a.avalua=a.ebaluatu=a["\u00e9valuer"]=a.avaliar="evaluate";a.variable=a.aldagaia=a["vari\u00e1vel"]="variable";a["funci\u00f3n"]=a["function"]=a["funci\u00f3"]=a.funtzio=a.fonction=
a["fun\u00e7\u00e3o"]="function";a.algoritmo=a.algorithm=a.algorisme=a.algorithme="algorithm";a.vector=a.array=a.bektore=a.vecteur=a.matriz="array";a["dibujar-si"]=a["draw-if"]=a["marraztu-baldin"]=a["dessiner-si"]=a["debuxar-se"]=a["desenhar-se"]=a["dibuixa-si"]=a.drawif="drawif";a.dominio=a.range=a.domini=a["izate-eremua"]=a.domain=a["dom\u00ednio"]="range";a.pausa=a.delay=a.eten="delay";a["eje-x"]=a["x-axis"]=a["eix-x"]=a["x-ardatza"]=a["axe-x"]=a["eixe-x"]=a["eixo-x"]=a.x_axis="x_axis";a["eje-y"]=
a["y-axis"]=a["eix-y"]=a["y-ardatza"]=a["axe-y"]=a["eixe-y"]=a["eixo-y"]=a.y_axis="y_axis";a["n\u00fameros"]=a.numbers=a.nombres=a.zenbakiak="numbers";a["exponencial-si"]=a["exponential-if"]=a["esponentzial-baldin"]=a["exponentiel-si"]=a["exponencial-se"]=a.exponentialif="exponentialif";a.familia=a.family=a["fam\u00edlia"]=a.famille="family";a.intervalo=a.interval=a.tarte=a.intervalle="interval";a.pasos=a.steps=a.passos=a.pausoak=a.pas="steps";a.centro=a.center=a.centre=a.zentro="center";a.radio=
a.radius=a.radi=a.erradio=a.rayon=a.raio="radius";a.fin=a.end=a.fi=a.bukaera=a.fim="end";a["una-sola-vez"]=a["only-once"]=a["una-sola-vegada"]=a["behin-bakarrik"]=a["une-seule-fois"]=a["unha-soa-vez"]=a["apenas-uma-vez"]=a.onlyOnce="onlyOnce";a.siempre=a.always=a.sempre=a.beti=a.toujours="always";a["color-int"]=a["int-colour"]=a["barruko-kolore"]=a["couleur-int"]=a["cor-int"]=a.colorInt="colorInt";a.repetir=a.loop=a.repeteix=a.errepikatu=a["r\u00e9p\u00e9ter"]="loop";a.controles=a.controls=a.kontrolak=
a["contr\u00f4les"]=a.controis="controls";a.animar=a.animate=a.anima=a.animatu=a.animer="animate";a.auto="auto";a.alto=a.height=a.alt=a.altu=a.haut=a.altura="height";a.x=a.left="x";a.y=a.top="y";a.espacio=a.space=a.espai=a.espazio=a.espace=a.espazo=a["espa\u00e7o"]="space";a.Nu="Nu";a.Nv="Nv";a.ancho=a.depth=a.amplada=a.zabalera=a.largeur=a.ancho=a.profundidade=a.amplada=a.width="width";a.largo=a.length=a.llargada=a.luzera=a.longueur=a.longo=a.comprimento=a.llargada="length";a.alto=a.height=a["al\u00e7ada"]=
a.altu=a.hauteur=a.alto=a.altura=a["al\u00e7ada"]="height";a.color_reverso=a.backcolor=a.color_revers=a["atzealde kolorea"]=a.couleur_revers=a.cor_reverso=a.cor_de_fundo="backcolor";a.aristas=a.edges=a.arestes=a.ertzak=a["ar\u00eates"]=a.arestas="edges";a.rotini=a.inirot="inirot";a.posini=a.inipos="inipos";a["tri\u00e1ngulo"]=a.triangle=a.hirukia=a["tri\u00e2ngulo"]="triangle";a.cara=a.face=a.aurpegi="face";a.polireg=a.regpoly=a["pol\u00edgonoRegular"]="polireg";a.superficie=a.surface=a["superf\u00edcie"]=
a.azalera="surface";a.cubo=a.cube=a.cub=a.kubo="cube";a["paralelep\u00edpedo"]=a.box=a["paral\u00b7lelep\u00edpede"]=a.paralelepipedo=a["parall\u00e9l\u00e9pip\u00e8de"]="box";a.cono=a.cone=a.con=a.kono=a["c\u00f4ne"]="cone";a.cilindro=a.cylinder=a.cilindre=a.zilindro=a.cylindre="cylinder";a.esfera=a.sphere=a["sph\u00e8re"]="sphere";a.tetraedro=a.tetrahedron=a.tetraedre=a["t\u00e9tra\u00e8dre"]="tetrahedron";a.octaedro=a["octahedron="]=a.octaedre=a.oktaedro=a["octa\u00e8dre"]="octahedron";a.dodecaedro=
a.dodecahedron=a.dodecaedre=a.dodekaedro=a["dod\u00e9ca\u00e8dre"]="dodecahedron";a.icosaedro=a.icosahedron=a.icosaedre=a.ikosaedro=a["icosa\u00e8dre"]="icosahedron";a.elipsoide=a.ellipsoid=a["el\u00b7lipsoide"]=a["ellipso\u00efde"]=a["elips\u00f3ide"]="ellipsoid";a.macro=a.makro="macro";a.id="id";a.modelo=a.model=a.eredu=a["mod\u00e8le"]="model";a.color=a.kolore=a.couleur=a.cor=a.colour=a.kolorea="color";a.luz=a.light=a.llum=a.argia=a["lumi\u00e8re"]="light";a.metal=a.metall=a["m\u00e9tal"]="metal";
a.alambre=a.wire=a.filferro=a.alanbre=a["fil de fer"]=a.arame="wire";a.cortar=a.split=a.talla=a.moztu=a.couper=a.dividir="split";a.despliegue=a.render=a.desplegament=a.zabaltze=a["d\u00e8ploiement"]=a.despregamento=a.processar="render";a.orden=a.sort=a.ordre=a.ordena=a.orde=a.ordenar="sort";a.pintor=a.painter=a.margolari=a.peintre="painter";a["trazado de rayos"]=a["ray trace"]=a["tra\u00e7at de raigs"]=a["izpi trazadura"]=a["trace de rayons"]=a["trazado de raios"]=a["tra\u00e7ado de raios"]=a.raytrace=
"raytrace";a.imagen=a.bg_image=a.imatge=a.irudia=a.imaxe=a.imagem_de_fundo=a.image="image";a.despl_imagen=a.bg_display=a.despl_imatge=a["irudi desplazamendu"]=a.despl_image=a.despr_imaxe=a["apresenta\u00e7\u00e3o_de_imagem"]="bg_display";a["arr-izq"]=a.topleft=a["dalt-esq"]=a["goi-ezk"]=a["au-dessus-gau"]=a["arr-esq"]=a["acima-esquerda"]="topleft";a["expand."]=a.stretch=a.hedatu=a["expandir "]="stretch";a.mosaico=a.patch=a.mosaic=a.mosaiko=a["mosa\u00efque"]="patch";a.centrada=a.center=a.zentratu=
a["centr\u00e9e"]=a.centrado="imgcenter";a.archivo=a.file=a.fitxer=a.artxibo=a.fichier=a.arquivo="file";a.tipo_de_macro=a.macro_type=a.tipus_de_macro=a.makro_mota=a.type_de_macro=a.tipo_de_macro=a.tipo_de_macro=a.tipus_de_macro="macro_type";a.filas_norte=a.rows_north=a.files_nord=a["HTML kodea"]=a.files_nord=a.filas_norte=a.linhas_norte=a.files_nord=a.rowsNorth="rowsNorth";a.filas_sur=a.rows_south=a.files_sud=a.ipar_lerro=a.files_sud=a.filas_sur=a.linhas_sul=a.files_sud=a.rowsSouth="rowsSouth";a.ancho_este=
a.width_east=a.ample_est=a.hego_lerro=a.ample_est=a.ancho_leste=a.largura_leste=a.ample_est=a.widthEast="widthEast";a.ancho_oeste=a.width_west=a.ample_oest=a.ekialde_zabalera=a.ample_ouest=a.ancho_oeste=a.largura_oeste=a.ample_oest=a.widthWest="widthWest";a.fijo=a.fixed=a.fix=a.hegoalde_zabalera=a.fixe=a.fixo="fixed";a["Reiniciar Animaci\u00f3n"]=a["Init Animation"]=a["Reinicia Animaci\u00f3"]=a.finko=a["Recommencer l'Animation"]=a["Reiniciar Anima\u00e7\u00e3o"]=a.initAnimation="initAnimation";a["Explicaci\u00f3n"]=
a.Explanation=a.Azalpena=a.Explication=a["Explica\u00e7\u00e3o"]=a["Explicaci\u00f3"]="Explanation";a.tooltip=a.dica="tooltip";a.discreto=a.discrete=a.discret=a.diskretu="discrete";a.interfaz=a.gui=a["interf\u00edcie"]=a.interfaze=a["interface"]="gui";a.pulsador=a.spinner=a.polsador=a.pultsadore=a.bouton="spinner";a["campo de texto"]=a.textfield=a["camp de text"]=a["testu esarrua"]=a["champ de texte"]="textfield";a["men\u00fa"]=a.choice=a.menu=a.escolha="menu";a.barra=a.scrollbar=a.barre="scrollbar";
a.opciones=a.options=a.opcions=a.aukerak=a["opci\u00f3ns"]=a["op\u00e7\u00f5es"]="options";a.interior=a.barruko=a["int\u00e9rieur"]="interior";a["condici\u00f3n"]=a.condition=a["condici\u00f3"]=a.baldintza=a["condi\u00e7\u00e3o"]="condition";a["acci\u00f3n"]=a.action=a["acci\u00f3"]=a.ekintza=a["a\u00e7\u00e3o"]="action";a.evento=a.event=a.esdeveniment=a.gertaera=a["\u00e9v\u00e9nement"]="event";a["abrir URL"]=a["open URL"]=a["obre URL"]=a["URL zabaldu"]=a["ouvrir URL"]=a.openURL="openURL";a["abrir Escena"]=
a["open Scene"]=a["obre Escena"]=a["eszena zabaldu"]=a["ouvrir Escena"]=a["abrir Cena"]=a.openScene="openScene";a["bot\u00f3n"]=a.button=a["bot\u00f3"]=a.botoi=a.bouton=a["bot\u00e3o"]="button";a.mensaje=a.message=a.mezua=a.mensaxe=a.mensagem=a.missatge="message";a.alternar=a.alternate=a.alterna=a.txandakatu=a.alterner="alternate";a["ejecuci\u00f3n"]=a.execution=a["execuci\u00f3"]=a.gauzatze=a["ex\u00e9cution"]=a["execuci\u00f3n"]=a["execu\u00e7\u00e3o"]="execution";a.calcular=a.calculate=a.calcula=
a.kalkulatu=a.calculer="calculate";a.coord_abs=a.abs_coord=a.koor_abs="abs_coord";a.negrita=a.bold=a.negreta=a.lodi=a["caract\u00e8re gras"]=a.negra=a.negrito="bold";a.cursiva=a.italics=a.etzana=a.italique=a["it\u00e1lico"]="italics";a.subrayada=a.underlined=a.subratllat=a.azpimarratua=a.soulignement=a["subli\u00f1ada"]=a.sublinhado="underlined";a.imagen=a.image=a.imatge=a.irundia=a.imaxe=a.imagem="image";a.pos_mensajes=a.msg_pos=a.pos_missatges=a.mezuen_pos=a.pos_messages=a.pos_mensaxes="msg_pos";
a.izquierda=a.left=a.esquerra=a.eskerrean=a.gauche=a.esquerda=a.esquerda=a.esquerra=a.x="x";a.derecha=a.right=a.dreta=a.eskuinan=a.droite=a.dereita=a.direita=a.dreta="right";a["sensible_a_los_movimientos_del_rat\u00f3n"]=a.sensitive_to_mouse_movements=a["sensible_als_moviments_del_ratol\u00ed"]=a["xagu mugimenduarekiko sentikorra"]=a.sensible_aux_mouvements_du_souris=a.sensible_aos_movementos_do_rato=a["sens\u00edvel_aos_movimentos_do_mouse"]="sensitive_to_mouse_movements";a.reproducir=a.play=a.reprodueix=
a.erreproduzitu=a.reproduire=a.reproduzir=a.playAudio="playAudio";a["activo-si"]=a["active-if"]=a["actiu-si"]=a["altiboa-baldin"]=a["actif-si"]=a["activo-se"]=a["ativo-se"]=a.activeif="activeif";a.rotfin=a.finrot=a.bukrot=a.endrot="endrot";a.posfin=a.finpos=a.bukpos=a.endpos="endpos";a.editable=a.editagarria=a["edit\u00e1vel"]="editable";a.tipo=a.type=a.tipus=a.mota="type";a.R2="R2";a.R3="R3";a.vectores=a.bektoreak=a.vecteurs=a.vetores=a.vectors="vectors";a["fuente puntos"]=a["font size"]=a["font punts"]=
a["puntu iturria"]=a["source points"]=a["fonte puntos"]=a["fonte pontos"]=a.font_size="font_size";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.punto=a.dot=a.punt=a.puntu=a.point=a.ponto="point";a.escenario=a.scenario=a.escenari=a.agertoki=a["sc\u00e8ne"]=a["cen\u00e1rio"]="scenario";a.cID="cID";a.matriz=a.matrix=a.matriu=a.matrice="matrix";a.filas=a.rows=a.files="rows";a.columnas=a.columns=a.colonnes="columns";a.solo_texto=a.only_text=
a.seulement_texte=a["s\u00f3_texto"]=a.tan_sols_texte=a.onlyText="onlyText";a.respuesta=a.answer="answer";a.peso=a.weight=a.pes="weight";a.decimal_symbol=a["signo decimal"]=a["decimal symbol"]="decimal_symbol";a.info="info";a.color_contorn_text=a.color_text_border=a.color_borde_texto=a.muga_testuaren_kolorea=a.couleur_contour_texte=a.cor_borde_texto=a.colore_bordo_testo=a.cor_borda_texto=a.color_contorn_text=a.border="border";a.video=a["vid\u00e9o"]="video";a.audio=a["\u00e0udio"]="audio";a.autoplay=
"autoplay";a.loop="loop";a.poster="poster";a.opacidad=a.opacity=a["opacit\u00e9"]=a.opacitat=a.opacidade="opacity";a.alinear=a.align=a["ali\u00f1ar"]=a.aligner="align";a.malla=a.mesh="mesh";a.local=a.Local="local";a.rectangle=a["rect\u00e1ngulo"]="rectangle";a.generic=a.generico="generic";a.loadLib=!0;a["GUI_espa\u00f1ol"]={decimal_symbol:"Simbolo decimal",language:"Lenguaje",about:"Cr\u00e9ditos",config:"Configuraci\u00f3n",init:"Inicio",clear:"Limpiar"};a.GUI_english={};a["GUI_catal\u00e0"]={};
a.GUI_euskera={};a["GUI_fran\u00e7ais"]={};a.GUI_galego={};a["GUI_portugu\u00eas"]={};a["GUI_valenci\u00e0"]={};a.translate=function(a,e){return e.charAt(0).toUpperCase()+e.substring(1)};a["LANG_espa\u00f1ol"]={"true":"s\u00ed","false":"no",decimal_symbol:"signo decimal",version:"Versi\u00f3n",language:"Idioma",Buttons:"Botones",about:"cr\u00e9ditos",init:"inicio",clear:"limpiar",widthEast:"ancho_este",widthWest:"ancho_oeste",type:"tipo",width:"ancho",height:"alto",drawif:"dibujar-si",exponentialif:"exponencial-si",
activeif:"activo-si",fixed:"fijo",scale:"escala",image:"imagen",bg_display:"despl_imagen",background:"fondo",file:"archivo",topleft:"arr-izq",stretch:"expand.",patch:"mosaico",imgcenter:"centrada",center:"centro",net:"red",net10:"red10",axes:"ejes",text:"texto",numbers:"n\u00fameros",x_axis:"eje-x",y_axis:"eje-y",sensitive_to_mouse_movements:"sensible_a_los_movimientos_del_rat\u00f3n",render:"despliegue",sort:"orden",painter:"pintor",split:"cortar",raytrace:"trazado de rayos",numeric:"num\u00e9rico",
region:"regi\u00f3n",north:"norte",south:"sur",east:"este",west:"oeste",external:"exterior",expresion:"expresi\u00f3n",space:"espacio",name:"nombre",value:"valor",incr:"incremento",gui:"interfaz",spinner:"pulsador",textfield:"campo de texto",menu:"men\u00fa",scrollbar:"barra",options:"opciones",button:"bot\u00f3n",graphic:"gr\u00e1fico",discrete:"discreto",decimals:"decimales",visible:"visible",action:"acci\u00f3n",playAudio:"reproducir",parameter:"par\u00e1metro",interior:"interior",condition:"condici\u00f3n",
action:"acci\u00f3n",event:"evento",openURL:"abrir URL",openScene:"abrir Escena",message:"mensaje",alternate:"alternar",execution:"ejecuci\u00f3n",calculate:"calcular",onlyText:"solo_texto",msg_pos:"pos_mensajes",color:"color",colorInt:"color-int",bold:"negrita",italics:"cursiva",underlined:"subrayada",font_size:"fuente puntos",size:"tama\u00f1o",constraint:"constricci\u00f3n",answer:"respuesta",weight:"peso","function":"funci\u00f3n",algorithm:"algoritmo",array:"vector",doExpr:"hacer",whileExpr:"mientras",
evaluate:"evaluar",range:"dominio",onlyOnce:"una-sola-vez",always:"siempre",matrix:"matriz",rows:"filas",columns:"columnas",constant:"constante",equation:"ecuaci\u00f3n",curve:"curva",sequence:"sucesi\u00f3n",text:"texto",point:"punto",segment:"segmento",arc:"arco",polygon:"pol\u00edgono",image:"imagen",abs_coord:"coord_abs",trace:"rastro",family:"familia",interval:"intervalo",steps:"pasos",fillP:"relleno+",fillM:"relleno-",fill:"relleno",spear:"punta",arrow:"flecha",radius:"radio",end:"fin",vectors:"vectores",
opacity:"opacidad",backcolor:"color_reverso",triangle:"tri\u00e1ngulo",face:"cara",surface:"superficie",cube:"cubo",box:"paralelep\u00edpedo",cone:"cono",cylinder:"cilindro",sphere:"esfera",tetrahedron:"tetraedro",octahedron:"octaedro",dodecahedron:"dodecaedro",icosahedron:"icosaedro",ellipsoid:"elipsoide",model:"modelo",light:"luz",metal:"metal",wire:"alambre",edges:"aristas",length:"largo",Animation:"Animaci\u00f3n",delay:"pausa",controls:"controles",loop:"repetir"};a.toLanguage=function(d,e){return a["LANG_"+
(e||"espa\u00f1ol")][d]||d};return a}(babel||{}),descartesJS=function(a){function d(){var a,b,c,g,f,d,k,h,e;Number.prototype.originalToFixed=Number.prototype.toFixed;Number.prototype.toFixed=function(p){try{return this.originalToFixed(p)}catch(n){p=p?p:0;p=0>p?0:parseInt(p);a=this.toString();f=a.indexOf("e");if(-1!==f)if(d=a.split("e"),h="-"===d[0][0]?"-":"",k="-"===h?parseFloat(d[0].substring(1)).originalToFixed(11):parseFloat(d[0]).originalToFixed(11),e=parseInt(d[1]),b=k.indexOf("."),0>b+e){b=
0>b?1:b;var m=h+"0.",r;r=Math.abs(b+e);r=Array(r+1).join("0");a=m+r+k.replace(".","")}else k=k.replace(".",""),a=h+k+Array(e-k.length+2).join("0");b=a.indexOf(".");c="";if(-1===b)0<p&&(c="."),c+=Array(p+1).join("0"),a+=c;else if(g=a.length-b-1,g>=p)11>=p&&(a=parseFloat(a).originalToFixed(p)),a=0<p?a.substring(0,b+1+p):a.substring(0,b);else{m=0;for(p-=g;m<p;m++)c+="0";a+=c}return a}}}function e(a,b,c){a.fillStyle="#c0c0c0";a.fillRect(b.offsetLeft,b.offsetTop,b.offsetWidth,b.offsetHeight);f(a,b,c.controls)}
function f(a,b,c){for(var g,f=c.length-1;0<=f;f--)g=c[f],a.drawImage(g.getScreenshot(),b.offsetLeft+g.x,b.offsetTop+g.y)}if(a.loadLib)return a;var c=2*Math.PI,b=360/c,k=c/360,g=Math.floor,p,h,q,m,l,s,t,n,u,r;a.rangeOK=1;a.extend=function(a,b){if("function"==typeof Object.create)a.prototype=Object.create(b.prototype);else if(a.prototype.__proto__)a.prototype.__proto__=b.prototype;else for(var c in b.prototype)b.prototype.hasOwnProperty(c)&&(a.prototype[c]=b.prototype[c]);a.prototype.uber=b.prototype};
a.radToDeg=function(a){return a*b};a.degToRad=function(a){return a*k};a.convertFont=function(a){if(""==a)return a;p=a.split(",");h="";"bold"==p[1].toLowerCase()?h+="Bold ":"italic"==p[1].toLowerCase()||"italics"==p[1].toLowerCase()?h+="Italic ":"bold+italic"==p[1].toLowerCase()&&(h+="Italic Bold ");q=p[0].split(" ")[0].toLowerCase();h+=p[2]+"px ";return h="serif"===q||"times new roman"===q||"timesroman"===q||"times"===q?h+"descartesJS_serif, 'Times New Roman', Times, serif":"sansserif"===q||"arial"===
q||"helvetica"===q?h+"descartesJS_sansserif, Arial, Helvetica, Sans-serif":h+"descartesJS_monospace, 'Courier New', Courier, Monospace"};a.drawLine=function(a,b,c,f,d,k,h){a.lineWidth=h||1;a.strokeStyle=k||"black";k=a.lineWidth%2?0.5:0;a.beginPath();a.moveTo(g(b)+k,g(c)+k);a.lineTo(g(f)+k,g(d)+k);a.stroke()};a.getColor=function(a,b){if("string"==typeof b)return b;m=a.evalExpression(b);l=g(255*m[0][0]);s=g(255*m[0][1]);t=g(255*m[0][2]);n=1-m[0][3];return"rgba("+l+","+s+","+t+","+n+")"};a.getFeatures=
function(){a.hasJavaSupport=navigator.javaEnabled();var b=navigator.appVersion.toLowerCase();a.hasTouchSupport=window.hasOwnProperty&&window.hasOwnProperty("ontouchstart")||b.match("android")&&!0;a.hasTouchSupport=navigator.userAgent.toLowerCase().match("qt")?!1:a.hasTouchSupport;a.isIOS=!(!navigator.userAgent.match(/iPad/i)&&!navigator.userAgent.match(/iPhone/i));b=document.createElement("canvas");a.hasCanvasSupport=b.getContext&&b.getContext("2d");a.hasCanvasSupport&&(a.ctx=document.createElement("canvas").getContext("2d"));
d()};a.removeNeedlessDecimals=function(a){var b,c;if("string"==typeof a&&(b=a.indexOf("."),-1!=b)){c=a.substring(b);if(0==parseFloat(c))return a.substring(0,b);for(var g=c.length;0<g;g--)if(0!=c.charAt(g))return a.substring(0,b+g+1)}return a};a.returnValue=function(a){return"number"===typeof a?parseFloat(a.toFixed(11)):a};a.whichButton=function(a){return null!==a.which?2>a.which?"L":2===a.which?"M":"R":2>a.button?"L":4===a.button?"M":"R"};a.getCursorPosition=function(a){a.touches?(a=a.touches[0],
u=a.pageX,r=a.pageY):void 0!=a.pageX&&void 0!=a.pageY?(u=a.pageX,r=a.pageY):(u=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:u,y:r}};a.getTextWidth=function(b,c){a.ctx.font=c;return Math.round(a.ctx.measureText(b).width)};var v={},w=document.createElement("canvas"),y,C,A,D,E,z,B,G;a.getFontMetrics=function(a){if(v[a])return v[a];C=parseFloat(a.match(/(\d+\.*)+px/)[0]);A=2*C;w.setAttribute("width",
A);w.setAttribute("height",A);y=w.getContext("2d");D=Math.floor(A/2);y.save();y.clearRect(0,0,A,A);y.font=a;y.fillStyle="#ff0000";y.fillText("\u00c1p",0,D);E=y.getImageData(0,0,A,A);z=E.data;for(var b=G=B=0,c=z.length;b<c;b+=4)if(255==z[b]){B=Math.floor(b/(4*A));break}for(b=z.length-40;0<=b;b-=4)if(255==z[b]){G=Math.floor(b/(4*A));break}for(var g=[],b=0,c=100;b<c;b++)g[b]=8>=b?3:16>=b?4:20>=b?5:24==b?7:25>=b?6:29>=b?7:34>=b?8:36>=b?9:40>=b?10:48>=b?11:52>=b?13:60>=b?14:64>=b?15:68>=b?16:76>=b?17:
80>=b?18:20;for(var f=[],b=0,c=100;b<c;b++)f[b]=9>=b?4:10==b?3:14>=b?4:18>=b?5:22>=b?6:26>=b?7:30>=b?8:34>=b?9:38>=b?10:40>=b?12:44>=b?12:48>=b?13:52>=b?15:60>=b?15:64>=b?17:68>=b?17:72>=b?18:76>=b?19:80>=b?20:21;for(var d=[],b=0,c=100;b<c;b++)d[b]=8>=b?3:10>=b?4:12>=b?5:14==b?7:16>=b?6:20>=b?7:22>=b?8:27>=b?9:30>=b?10:36==b?12:38>=b?11:40>=b?12:48>=b?14:52>=b?17:56>=b?18:60>=b?19:64==b?22:68>=b?21:72>=b?22:76>=b?23:80>=b?24:25;a.match("sansserif")?G=D+g[C]:a.match("serif")?G=D+f[C]:a.match("monospace")&&
(G=D+d[C]);b={ascent:D-B,descent:G-D,h:G-B,baseline:D-B};y.restore();return v[a]=b};a.getFieldFontSize=function(a){a=Math.min(50,a);return a=24<=a?Math.floor(a/2+2-a/16):20<=a?12:17<=a?11:15<=a?10:9};a.getScreenshot=function(){var b=a.apps[0],c,g=document.createElement("canvas"),d=new Image;if(b){g.setAttribute("width",b.width);g.setAttribute("height",b.height);for(var k=g.getContext("2d"),h=0,p=b.spaces.length;h<p;h++)c=b.spaces[h],"R2"===c.type&&(k.drawImage(c.backgroundCanvas,c.x,c.y),k.drawImage(c.canvas,
c.x,c.y),f(k,c.container,c.ctrs));0<b.northSpace.controls.length&&e(k,b.northSpace.container,b.northSpace);0<b.southSpace.controls.length&&e(k,b.southSpace.container,b.southSpace);0<b.eastSpace.controls.length&&e(k,b.eastSpace.container,b.eastSpace);0<b.westSpace.controls.length&&e(k,b.westSpace.container,b.westSpace);d.src=g.toDataURL("image/png")}return d};a.showAbout=function(){var b;b=a.creativeCommonsLicense?"<html>\n<head>\n<style>\nbody{ text-align:center; }\niframe{ width:650px; height:73px; overflow:hidden; border:1px solid black; }\ndt{ font-weight:bold; margin-top:10px; }\n</style>\n</head>\n<body>\n<iframe src='http://arquimedes.matem.unam.mx/Descartes5/creditos/bannerPatrocinadores.html'></iframe>\n<h2> <a href='http://proyectodescartes.org/' target='_blank'>ProyectoDescartes.org</a> <br> <a href='http://descartesjs.org' target='_blank'>DescartesJS.org</a> </h2>\n<dl>\n<dt> Dise&ntilde;o funcional:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Jos&eacute; R. Galo Sanchez,</nobr>\n<nobr>Juan Madrigal Muga</nobr>\n</dd>\n<dt>Autores del software:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Marta Oliver&oacute; Serrat,</nobr>\n<nobr>Oscar Escamilla Gonz&aacute;lez,</nobr>\n<nobr>Joel Espinosa Longi</nobr>\n</dd>\n</dl>\n<p>\nEl software en Java est&aacute; bajo la licencia\n<a href='https://joinup.ec.europa.eu/software/page/eupl/licence-eupl'>EUPL v.1.1 </a>\n<br>\nEl software en JavaScript est&aacute; bajo licencia\n<a href='http://www.gnu.org/licenses/lgpl.html'>LGPL</a>\n</p>\n<p>\nLa documentaci&oacute;n y el c&oacute;digo fuente se encuentran en :\n<br>\n<a href='http://arquimedes.matem.unam.mx/Descartes5/'>http://arquimedes.matem.unam.mx/Descartes5/</a>\n</p>\n<p>\nEste objeto, creado con Descartes, est&aacute; licenciado\npor sus autores como\n<a href='http://creativecommons.org/licenses/by-nc-sa/2.5/es/'><nobr>Creative Commons</nobr></a>\n<br>\n<a href='http://creativecommons.org/licenses/by-nc-sa/2.5/es/'><img src='http://i.creativecommons.org/l/by-nc-sa/3.0/es/88x31.png'></a>\n</p></body> </html>":
"<html>\n<head>\n<style>\nbody{ text-align:center; }\niframe{ width:650px; height:73px; overflow:hidden; border:1px solid black; }\ndt{ font-weight:bold; margin-top:10px; }\n</style>\n</head>\n<body>\n<iframe src='http://arquimedes.matem.unam.mx/Descartes5/creditos/bannerPatrocinadores.html'></iframe>\n<h2> <a href='http://proyectodescartes.org/' target='_blank'>ProyectoDescartes.org</a> <br> <a href='http://descartesjs.org' target='_blank'>DescartesJS.org</a> </h2>\n<dl>\n<dt> Dise&ntilde;o funcional:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Jos&eacute; R. Galo Sanchez,</nobr>\n<nobr>Juan Madrigal Muga</nobr>\n</dd>\n<dt>Autores del software:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Marta Oliver&oacute; Serrat,</nobr>\n<nobr>Oscar Escamilla Gonz&aacute;lez,</nobr>\n<nobr>Joel Espinosa Longi</nobr>\n</dd>\n</dl>\n<p>\nEl software en Java est&aacute; bajo la licencia\n<a href='https://joinup.ec.europa.eu/software/page/eupl/licence-eupl'>EUPL v.1.1 </a>\n<br>\nEl software en JavaScript est&aacute; bajo licencia\n<a href='http://www.gnu.org/licenses/lgpl.html'>LGPL</a>\n</p>\n<p>\nLa documentaci&oacute;n y el c&oacute;digo fuente se encuentran en :\n<br>\n<a href='http://arquimedes.matem.unam.mx/Descartes5/'>http://arquimedes.matem.unam.mx/Descartes5/</a>\n</p>\n</body> </html>";
var c=window.open("","creditos","width=700,height=500,titlebar=0,toolbar=0,location=0,menubar=0,resizable=0,scrollbars=0,status=0");c.document.write(b);c.document.close()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e;a._externalFilesContent={};a.openExternalFile=function(f){if(a._externalFilesContent[f])return a._externalFilesContent[f];d=null;var c=!1;if(window.XMLHttpRequest)try{c=new XMLHttpRequest}catch(b){c=!1}else if(window.ActiveXObject)try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(k){try{c=
new ActiveXObject("Microsoft.XMLHTTP")}catch(g){c=!1}}e=c;e.open("GET",f,!1);try{e.send(null),d=e.responseText,d.match(String.fromCharCode(65533))&&(e.open("GET",f,!1),e.overrideMimeType("text/plain; charset=ISO-8859-1"),e.send(null),d=e.responseText)}catch(p){console.log("Error to load the file :",f),d=null}return d};a.addExternalFileContent=function(f,c){a._externalFilesContent[f]=c};return a}(descartesJS||{}),descartesJS=function(a){function d(a){r=a.indexOf("--radial--");-1!=r&&(a=a.substring(0,
r));b=a.trim();a={ignoreAcents:!1,ignoreCaps:!1,regExp:null};b[0]==b[b.length-1]&&"'"==b[0]&&(a.ignoreCaps=!0,b=b.substring(1,b.length-1),"`"==b[0]&&"\u00b4"==b[b.length-1]&&(a.ignoreAcents=!0,b=b.substring(1,b.length-1)));"`"==b[0]&&"\u00b4"==b[b.length-1]&&(a.ignoreAcents=!0,b=b.substring(1,b.length-1),b[0]==b[b.length-1]&&"'"==b[0]&&(a.ignoreCaps=!0,b=b.substring(1,b.length-1)));"*"===b.charAt(0)&&"*"!==b.charAt(b.length-1)?b=b.substring(1)+"$":"*"!==b.charAt(0)&&"*"===b.charAt(b.length-1)?b="^"+
b.substring(0,b.length-1):"*"!==b.charAt(0)&&"*"!==b.charAt(b.length-1)?b="^"+b+"$":"*"===b.charAt(0)&&"*"===b.charAt(b.length-1)&&(b=b.substring(1,b.length-1));b=b.replace(/\?/g,"[\\S\\s]{1}");a.regExp=b;return a}function e(a,c){b=(a||"").trim();a={ignoreAcents:!1,ignoreCaps:!1,regExp:null};a.expr=b.split(",");a.expr[0]=a.expr[0].trim();a.expr[0]={type:a.expr[0].charAt(0),expr:c.parser.parse(a.expr[0].substring(1))};a.expr[1]=a.expr[1].trim();a.expr[1]={type:a.expr[1].charAt(a.expr[1].length-1),
expr:c.parser.parse(a.expr[1].substring(0,a.expr[1].length-1))};return a}function f(a,b,c){b=parseFloat(b);h=a.expr[0];q=a.expr[1];m=c.evalExpression(h.expr);l=c.evalExpression(q.expr);s="("==h.type;t="["==h.type;n=")"==q.type;u="]"==q.type;return(s&&b>m||t&&b>=m)&&(n&&b<l||u&&b<=l)?1:0}function c(a){return a.toString().replace(/\u00e1/g,"a").replace(/\u00e9/g,"e").replace(/\u00ed/g,"i").replace(/\u00f3/g,"o").replace(/\u00fa/g,"u").replace(/\u00c1/g,"A").replace(/\u00c9/g,"E").replace(/\u00cd/g,
"I").replace(/\u00d3/g,"O").replace(/\u00da/g,"U").replace(/\u00f1/g,"n").replace(/\u00d1/g,"N")}if(a.loadLib)return a;var b,k,g,p,h,q,m,l,s,t,n,u,r;a.buildRegularExpresionsPatterns=function(a,c){a=a||"";"("===a.charAt(0)&&")"===a.charAt(a.length-1)&&-1===a.indexOf(",")&&(a=a.substring(1,a.length-1));a=a.replace(/&squot;/g,"'").replace(/&amp;/g,"&").split("|");for(var f=0,h=a.length;f<h;f++){k=a[f].split("&");g=[];for(var p=0,n=k.length;p<n;p++)b=k[p],-1===b.indexOf(",")||"("!==b.charAt(0)&&"["!==
b.charAt(0)||")"!==b.charAt(b.length-1)&&"]"!==b.charAt(b.length-1)?g.push(d(b)):g.push(e(b,c));a[f]=g}return a};a.escorrecto=function(b,g,d,h){d=d||a.externalEvaluator;h=h||a.buildRegularExpresionsPatterns(b,d);g=c(g);b=0;for(var e=h.length;b<e;b++){k=h[b];p=!0;for(var n=0,m=k.length;n<m;n++)p=k[n].regExp?p&&!!g.match(RegExp(c(k[n].regExp),"i")):p&&f(k[n],g,d);if(p)return 1}return 0};a.esCorrecto=function(g,d,h,e){h=h||a.externalEvaluator;e=e||a.buildRegularExpresionsPatterns(g,h);g=0;for(var n=
e.length;g<n;g++){k=e[g];p=!0;for(var m=0,r=k.length;m<r;m++)(b=k[m].regExp)?(k[m].ignoreAcents&&(d=c(d),b=c(b)),k[m].ignoreCaps&&(d=d.toLowerCase(),b=c(b).toLowerCase()),p=p&&!!d.match(b)):p=p=p&&f(k[m],d,h);if(p)return 1}return 0};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.getCreativeCommonsLicenseImage=function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAYAAABjyArgAAAABHNCSVQICAgIfAhkiAAACpVJREFUaIHtWm1sU9cZfu61iUYnPP/bJgdhhDbFkVYcCrR0tLHXrVNL01wvgUJDh820tivrkpQQtpEvA4HGhDoe/dCmNfbaVa1WKszX2oUO3xC0OHESm9Hi/FhloyQq1aY5OGgq8ce7H9f3xI7txKFsdKyPdHSPz8dzz33Oe77eY46IVBzHXcUXuOkgIo4DQABwuucUeJ4Hz/NQKBTgeQUUPA9ekXryPDiOB89x4DgO4DiZBQQCJQlJSiKZlEIikZCeyQQSiSSSyQTLS1KSlSciuTEsfjtgY+UmAAAHgGRxFQqFFHjFTFyhkPJ4RUpkDhzHp+ubEiclbFISM5FIhfR4IlPkZDLJhE0X+nbBxspNUALIFFehhDLjKYWTx0/B4/FgcHAQU9GpDKIlqiVYu3YtjN8xouLRR5BIKsDzcalDEjw4cJD6cgaUJGkkANIY4iRxR3x+uN9xIxgMZpTX6XQQqgSsWlNW0Md9Xng4APSns+9BqVQyUZVKpRQUSvSK52B73oaJiYmCGqTRaND4i0aUl9+PeCKBRCKOeDwVEnHE4wlm4emW/PHExzjS9SJGg6MAAIPBAL1eDwAIBAIQRREAUKIrwY7aHfja17+a8/1XPv4ELzle+lzwbKzcJAn8fu8ZKBXKGWGVi7BIqURrcxvcx9ysglqthiAI0Gq1KC8vBwD09vYiHA7D7XZjcnKSlRVMAhoad2LxHYsRj8cRi8cRj8cQj8czpwxK4mrkKn769LOIRqMQBAF2ux1arTajseFwGPX19XC73VCpVGi3tWd91LXoNdTuqPvc8MjzMJ3tO0t9/eeo39dPQwEfXfggQIJJIEiDl9RqNbW1tVEkEqG54HQ6Sa1Ws3oluhI6399HQ4Eh8g71U1//OfL0naUzYg+99+d36XTPKTrx7nHS6XQEgMxmcwafzDP7HTL328f/kBFKdCU5eRx2Oz3+2ObPxDM2Nkbe/n7y9vfT2NhYQTwAiAcARWoOVioUUCoyLVev18Pv96O1tRVqtTprGKTDbDYjFAqxoTQaHEWn7XDGXM6zHYm0G/F5fQgGgxAEAY27ds3JL79DEASMBkcx4vOz9BGfH6PBUawqK8O996xj6b/q6sLzNhtOnj6N3Q27MD4+XhBPent+/9prMKy/DzWbt6Bm8xYY1t+HMz09c/Kkg/q8feQd8tLIhWFyHHEwy9Hr9fNabS5EIhHS6/WMx/Gig0b+OkIDw1467+0jz3nJit99/4+kK5WsNxQKFcwfCoUIAOl0OmYt8igo+cY3acUyLZV/ez09/eMnCQC1tbXRwQMHCQAdffvtgnjk9nj7+yW+u9fRj7ZZqHFnA61YpqUVy7TksNvz8uSwYMmKbc/bAEjzrdPpnNdqc0GtVsPj8bC6toO21F46ZcFcak/N8wheCsJgMGTNcRaLhVm5xWLJyNNqtTAYDBkrezAo8VRUVGDjpk0YHx/HmZ4erFimxb+mrmHrE1tx6cMPUVVdXRCPVqtFNBpF0H8RAFAp/AC/dXWjo/MQ9rQ0AwBc3c68PDJ4AKlhK23F5N1CXV0dG+o3ArVaDbvdDgCYmJjAyROn2IFFEplj27Rc73G5XDnjMnLV0ev1sB3uxEFbB954601UVVfjo8th2A53YunSpXB1OxG8dKkgHhntL0gG95vfvcrSvvfggwCAaDSKT65cycsDpASWrcnj8QCQxKmtrWWFRFGEyWSC0WiE0WiE1WrNm9fV1cXyzGYzs2LPWU+a9XLg+BmB/xO4+5570NF5CGNjY2jc2YCyb92Jd44eRcXDG1CzeQubQ+eCSqWCw+HAHaoleOWVV3KW+fTT63NySAcNjgPPcRgcHAQACILAhBFFEUajMaOSKIoQRRG1tbUwmUxZeRcuXIDT6WRcLpcLg4OD0gkwJawkriRwIBDIapjZbGaWazabs/Jz1ZmdFo1GcaanBx2dh2C+ZEHFwxsAAANeLwa8XhQXF4NbpJyTZ5FSicaGBtyxeDFLG/B6WXyZdlne9gDMgqUPlk9oK1euZAXq6+sBSPNMKBSCx+OBVqvFtm3bmCXr9XqEQiEcO3YsY48MgMWnolPSe8ClPYHS0lKIoohwOJzRMLmDZscBaQ8qiiJ0Oh1L0+l0WTw/efIptO/dh1V3rkTN5i346HIYVdXV6Og8hJqtWwviGR8fR1tLKx5/bDPa9+5D+959aGlqAgDs2r07b3syBAaHjOGaPp/IPWM2m9lkHgqFYDabWZ58+BAEgeXJSF+8JKPNPDZvfExadOSOLARyWaFKYGlyPJ2no/MQLNu348o//o6/hUJw2O3Y09KMqupqWPfvQ9ma1fPyWLZvh2X7dgCAs7sbzu5uXP/0OjZUPIItNY/nbY+M7PHxX8a69eugK9XB7XbDYrFkWetsyKenEl1Jhh9g1ZoylOhKMniKi4uxp6UZX1q8GCPDw/hZXd0N8expacb3H3oIly+HAUijTldaOiePDMmCKdOLlT6fyNbscrkwOTmJQCCA5cuXw2q1sjz5mJyeJyN9yEpnM3l7PIPmtmaoVCq4XC6YTCZWh9K8bOFwGCaTCV1dXVCpVNhRuyPrY3b/sjEnz85dDXjjrTc/E8/qNatRVV2Nqupq6EpLC+IBUs4e38ggioqKsP7e+zAVnYLZbGaW5Ha7sxYyQJoyKisr8+bJ9evr69HV1YUlqiU4/5c+TE9PYzo2jVg8hlgsLjmDEnFE/jmJA9YDbC+p1+uh1+uhVqshiiLr9PmcNNei19BxwMacNLeShzl7BoYHUFRUBGuLFe5jbqjVakQiEVZQFEU4HA7mzDEYDGhtbWUd4HA4WNn0PABYvnw5wuEwHvjuAzhs78T16WnEZgks+42TiSR8Az4cO3rr3Yw3g4cJ7B3qx6JFRTh/7jxqn5X2v3a7HXVpc9aNwOVysVPY/gP78fCGhzAdm8Z0LIZ4LIZYfJbAORzw/8vYWLlJmoPlKx2DsRwajQYAYLVas7ZOC8Hk5CRbXTUaTcoRn7rFSCaRTM3FlLpyul3BA0CSkkgkpHu0fe17AUgCmUymDB9voZicnITRaGR1G3/emHKwJ2ZETrsyYovsrMX2dgEBoKbWJvKNDFLgop+e+OETGR41v9+/IE9XuidNMAkUuOgn38gg7W3fy9L/j8LMj7rnamnI76PADTjcI5EItbW1ZTjc16xdQxc+CNBQwEdNrU23+kNvSWDX9jKaW5tQaRKgVCpx2HYYr7/2Ostb6JWRdV8b4vE4BgYG8cxTz2A+pE8P8smSiDJOmbN/5+PJV0d+R6GOpnxtWhDH7NDc2iRZ8kU/dbteJY1GU3CPaTQachxxUOCin4YCPnr51y8XXJeI5oynp83HM1/9QrhylVkoR5YFy6h7rhY1W2vYVY/o6cWJ4yfmvLZ/VHgUBkM5u9A8fvwE9lv3F9DHEnJZS3reQqyO47i8z4VgtrXOXoTn48srMACsuqsMza0tKF6qSbuNSHc3ImPfKv/xZGJ8HC902nGu99yCP+azTA35eABkCbxQsXN1UiEccwos4/7y+7GhYgPuWn0XvqJSpf46Jb9ZetHVaBTDQ8M4ffL0goVN/wjWsJtgwbl+L2T+nG9NuGkCf4EbB09EX77VjbhdQUTcvwFtwhQyXNo3TwAAAABJRU5ErkJggg==";
return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e,f,c,b,k,g,p,h,q,m,l,s,t;a.Color=function(a,g){this.b=this.g=this.r=0;this.a=1;this.evaluator=g;if(a){if(babel[a]&&("net"===babel[a]&&(a="rojo"),a=babel[a],this.r=parseInt("0x"+a.substring(1,3),16),this.g=parseInt("0x"+a.substring(3,5),16),this.b=parseInt("0x"+a.substring(5,7),16),this.colorStr=a,this.getColor=this.getColorString),6===a.length&&(this.r=parseInt("0x"+a.substring(0,2),16),this.g=parseInt("0x"+
a.substring(2,4),16),this.b=parseInt("0x"+a.substring(4,6),16),this.colorStr="#"+a,this.getColor=this.getColorString),8===a.length&&(this.r=parseInt("0x"+a.substring(2,4),16),this.g=parseInt("0x"+a.substring(4,6),16),this.b=parseInt("0x"+a.substring(6,8),16),this.a=1-parseInt("0x"+a.substring(0,2),16)/255,this.colorStr="rgba("+this.r+","+this.g+","+this.b+","+this.a+")",this.getColor=this.getColorString),"("===a[0]){f=[];c=this.splitComa(a.substring(1,a.length-1));for(var d=0,k=c.length;d<k;d++)b=
parseInt(c[d],16),c[d]!=b.toString(16)&&c[d]!=="0"+b.toString(16)?("["===c[d].charAt(0)&&"]"===c[d].charAt(c[d].length-1)&&(c[d]=c[d].substring(1,c[d].length-1)),f.push(this.evaluator.parser.parse(c[d]))):f.push(this.evaluator.parser.parse((b/255).toString()));this.rExpr=f[0];this.gExpr=f[1];this.bExpr=f[2];this.aExpr=f[3];this.getColor=this.getColorExpression}}else this.colorStr="rgba("+this.r+","+this.g+","+this.b+","+this.a+")",this.getColor=this.getColorString};a.Color.prototype.splitComa=function(a){k=
[];for(var b=h=p=g=0,c=a.length;b<c;b++)q=a.charAt(b),"("===q?g++:")"===q?g--:"["===q?p++:"]"===q?p--:","===q&&0===g&&0===p&&(k.push(a.substring(h,b)),h=b+1);k.push(a.substring(h));return k};a.Color.prototype.getColorString=function(){return this.colorStr};a.Color.prototype.getColorExpression=function(){e=this.evaluator;this.r=d(255*e.evalExpression(this.rExpr));this.g=d(255*e.evalExpression(this.gExpr));this.b=d(255*e.evalExpression(this.bExpr));this.a=1-e.evalExpression(this.aExpr);return"rgba("+
this.r+","+this.g+","+this.b+","+this.a+")"};a.Color.prototype.borderColor=function(){return 380>this.r+this.g+this.b?"#ffffff":"#000000"};a.RGBAToHexColor=function(b){b=b.substring(5,b.length-1).split(",");m=parseInt(b[0]).toString(16);l=parseInt(b[1]).toString(16);s=parseInt(b[2]).toString(16);t=(255-parseInt(255*parseFloat(b[3]))).toString(16);m=1==m.length?"0"+m:m;l=1==l.length?"0"+l:l;s=1==s.length?"0"+s:s;t=1==t.length?"0"+t:t;return new a.Color(t+m+l+s)};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var d=document.head,e=document.createElement("meta");e.setAttribute("http-equiv","X-UA-Compatible");e.setAttribute("content","IE=edge,chrome=1");d.appendChild(e);e=document.createElement("meta");e.setAttribute("name","viewport");e.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=yes");d.appendChild(e);e=document.createElement("meta");e.setAttribute("name","apple-mobile-web-app-capable");e.setAttribute("content","yes");d.appendChild(e);
e=document.createElement("meta");e.setAttribute("name","apple-mobile-web-app-status-bar-style");e.setAttribute("content","black-translucent");d.appendChild(e);(d=document.getElementById("StyleDescartesApps2"))&&d.parentNode.removeChild(d);d=document.createElement("style");d.type="text/css";d.id="StyleDescartesApps2";d.setAttribute("rel","stylesheet");document.head.appendChild(d);d.innerHTML="div.DescartesCatcher{ background-color:rgba(255, 255, 255, 0); cursor:pointer; position:absolute; }\ndiv.DescartesAppContainer{ border:0px solid black; position:relative; overflow:hidden; top:0px; left:0px; }\ndiv.DescartesLoader{ background-color :#CACACA; position:absolute; overflow:hidden; top:0px; left:0px; }\ndiv.DescartesLoaderImage{ background-repeat:no-repeat; background-position:center; position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesLoaderBar{ position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesSpace2DCanvas, canvas.DescartesSpace3DCanvas, div.blocker{ position:absolute; overflow:hidden; left:0px; top:0px; }\ndiv.DescartesSpace2DContainer, div.DescartesSpace3DContainer{ position:absolute; overflow:hidden; line-height:0px; }\ncanvas.DescartesButton{ position:absolute; cursor:pointer; }\ndiv.DescartesButtonContainer{ position:absolute; }\ndiv.DescartesSpinnerContainer, div.DescartesTextFieldContainer, div.DescartesMenuContainer{ background:lightgray; position:absolute; overflow:hidden; }\ninput.DescartesSpinnerField, input.DescartesTextFieldField, input.DescartesMenuField, input.DescartesScrollbarField{ -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family:Arial,Helvetica,'Droid Sans',Sans-serif; padding:0px; border:solid #666 1px; position:absolute; top:0px; }\nlabel.DescartesSpinnerLabel, label.DescartesMenuLabel, label.DescartesScrollbarLabel, label.DescartesTextFieldLabel{ font-family:Arial,Helvetica,'Droid Sans',Sans-serif; font-weight:normal; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:#e0e4e8; position:absolute; left:0px; top:0px; }\ndiv.DescartesGraphicControl{ border-style:none; position:absolute; }\ndiv.DescartesTextAreaContainer{ position:absolute; overflow:hidden; background:#c0d0d8; }\nselect.DescartesMenuSelect{ font-family:Arial,Helvetica,'Droid Sans',Sans-serif; padding-top:0px; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:white; position:absolute; left:0px; top:0px; }\ndiv.DescartesScrollbarContainer{ background:#eee; overflow:hidden; position:absolute; }\ndiv.DescartesEditorContainer{ font-family:Arial,Helvetica,'Droid Sans',Sans-serif; position:fixed; left:0px; top:0px; width:100%; height:100%; background-color:#2e2e2e; z-index:10001; }\ndiv.DescartesEditorTabContainer{ width:100%; height:100%; position:absolute; padding:0px;  }\n.DescartesTabs{ height: 37px; }\n.DescartesTabs > ul{ font-size:18px; list-style:none; padding:0 1px 1px; margin-left:4px; text-align:center; }\n.DescartesTabs > ul > li{ margin-right:1px; padding:8px 8px; float:left; color:#fff; -webkit-user-select:none; -moz-user-select:none; user-select:none; border-radius:7px 7px 0px 0px; background:#0C91EC; background:-moz-linear-gradient(top, #0C91EC 0%, #257AB6 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0C91EC), color-stop(100%,#257AB6)); }\n.DescartesTabs > ul > li:hover{ background:#fff; background:-moz-linear-gradient(top, #FFFFFF 0%, #F3F3F3 10%, #F3F3F3 50%, #FFFFFF 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(10%,#F3F3F3), color-stop(50%,#F3F3F3), color-stop(100%,#FFFFFF)); cursor:pointer; color:#000; }\n.DescartesTabs > ul > li.tabActiveHeader{ background:#fff; background:-moz-linear-gradient(top, #FFFFFF 0%, #F3F3F3 10%, #F3F3F3 50%, #FFFFFF 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(10%,#F3F3F3), color-stop(50%,#F3F3F3), color-stop(100%,#FFFFFF)); cursor:pointer; color:#000; }\n.DescartesTabscontent{ position:absolute; left:5px; right:5px; top:55px; bottom:45px; overflow:y-scroll; padding:10px 10px 25px; background:#000; background:-moz-linear-gradient(top, #FFFFFF 0%, #FFFFFF 90%, #e4e9ed 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(90%,#FFFFFF), color-stop(100%,#e4e9ed)); margin:0px; color:#000; background-color:#000; }\ndiv.DescartesConfigPanel{ position:absolute; left:10px; right:10px; top:10px; bottom:10px; overflow:y-scroll; border:solid 1px #000; border-radius:5px; font-size:18px; padding:10px; line-height:1.5em; overflow:auto; }\ndiv.DescartesLeftPanelClass{ position:absolute; left:10px; top:10px; bottom:10px; width:200px; background-color:; border:1px solid black; overflow:auto; }\ndiv.DescartesLeftPanelClass li:nth-child(odd){ background-color:#6495ED; }\ndiv.DescartesLeftPanelClass li:nth-child(even){ background-color:#ED6495; }\ndiv.DescartesLeftPanelClass > div > ul{ list-style:none; background:#bbb; padding:5px; }\ndiv.DescartesLeftPanelClass > div > ul > li{ padding:5px; -webkit-user-select:none; -moz-user-select:none; user-select:none; cursor:pointer; white-space: nowrap; overflow: hidden; }\ndiv.DescartesRightPanelClass{ position:absolute; left:220px; right: 10px; top:10px; bottom:10px; background-color:; border:1px solid black; overflow:auto; }\ndiv.DescartesLabelAndElementContainer{ padding:4px 8px; margin:4px; display:inline-block; background-color:lightgray; border-radius:3px; }\ndiv.DescartesLabelAndElementContainer > select{ font-family:Monospace; font-size:18px; }\ndiv.DescartesLabelAndElementContainer > input{ font-family:Monospace; font-size:18px; }\ndiv.DescarteslistContainer{ font-family:Arial,Helvetica,Sans-serif; font-size:20px; position:absolute; left:5px; right:5px; top:45px; bottom:45px; border-radius:5px; background-color:#DDD; overflow:auto; }\ndiv.DescarteslistContainer > ul{ margin:5px; padding:5px; padding-bottom:15px; list-style:none; }\ndiv.DescarteslistContainer > ul > li{ padding:7px; margin:1px; }\ndiv.DescarteslistContainer li:nth-child(odd){ background-color:#BBB; }\ndiv.DescarteslistContainer li:nth-child(even){ background-color:#999; }\ndiv.DescartesExtraInfo{ padding: 12px; }\nspan.DescartesSpanName{ background-color:lightblue; margin:5px; }\nspan.DescartesSpanValue{ background-color:#333; color:white; margin:0px; padding:5px; border-radius:3px; line-height:1.75em; }\nspan.DescartesSpanValue br{ display: none; }\nspan.DescartesSpanValue * { display: inline }\ndiv.Descartes_param_name{ background-color:#669; color:#ee5; margin-bottom:10px; }\n.DescartesToolbarPlace{ -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; text-align:center; border-radius:4px 4px 4px 4px;  position:absolute; left:5px; right:5px; top:0px; height:40px; min-width:290px; background: #ccc; padding:4px; }\n.DescartesButtonsPlace{ -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; text-align:center; border-radius:4px 4px 4px 4px;  position:absolute; left:5px; right:5px; bottom:0px; height:40px; min-width:290px; background: #ccc; padding:4px; }\ndiv.DescartesAddPanel{ position:absolute; top:10px; left:10px; width:350px; background-color:white; }\ndiv.DescarteslistContainer li.DescartesElementSelected{ border:1px solid black; background-color:#D66; }\ninput.DescartesEditorButton{ cursor:pointer; width:110px; height:30px; padding:5px 25px; margin:0px 2px; background:#257AB6; border:1px solid #fff; border-radius:7px; box-shadow: inset 0px 1px 0px #3e9cbf, 0px 2px 0px 0px #205c73, 0px 4px 5px #999; color:#fff; font-size:1em; }\ninput.DescartesEditorButton:hover, input.DescartesEditorButton:focus{ background-color:#0C91EC; box-shadow:0 0 1px rgba(0,0,0, .75); }\n";
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.sin,e=Math.floor,f=Math.random,c=Math.round,b=Math.abs,k=String.fromCharCode,g,p,h,q,m,l,s,t,n,u;a.Krypto=function(a){this.key=(a||0).toString()};a.Krypto.prototype.getKey=function(a){g=[];for(var c=0;256>c;c++)g[c]=k(this.alfanum(e(b(7.5*(d(1*c-a)+d(1.4*c+a)+d(0.6*c-a)+d(2.2*c+a))))));return g.join("")};a.Krypto.prototype.encode=function(a){p=e(31*f());this.key=this.getKey(p);q=k(this.alfanum(p));return q+this.encripta(a)};
a.Krypto.prototype.decode=function(a){p=this.numalfa(a.charCodeAt(0));this.key=this.getKey(p);return this.desencripta(a.substring(1))};a.Krypto.prototype.encripta=function(a){return this.bytesToString(this.encriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.encriptaAux=function(a){if(null==a||null==this.key)return null;l=Array(3*a.length);for(var b=0,g=a.length;b<g;b++)n=256*e(a[b]+128)+c(255*f())+65536*c(255*f()),u=e((n<<this.shift(b))/256),l[3*b]=this.alfanum(u%32),l[3*b+1]=this.alfanum(u/32%
32),l[3*b+2]=this.alfanum(u/1024%32);return l};a.Krypto.prototype.desencripta=function(a){return this.bytesToString(this.desencriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.desencriptaAux=function(a){if(null==a||null==this.key)return null;s=Array(a.length/3);for(var b=0,c=s.length;b<c;b++)u=this.numalfa(a[3*b])+32*this.numalfa(a[3*b+1])+1024*this.numalfa(a[3*b+2]),n=e(256*u>>this.shift(b)),t=e(n/256)%256-128,0>t&&(t+=256),s[b]=t;return s};a.Krypto.prototype.alfanum=function(a){a=e(a);return 10>
a?48+a:87+a};a.Krypto.prototype.numalfa=function(a){return 58>a?a-48:a-87};a.Krypto.prototype.stringToBytes=function(a){q=Array(a.length);for(var b=0,c=a.length;b<c;b++)q[b]=a.charCodeAt(b);return q};a.Krypto.prototype.bytesToString=function(a){for(var b=0,c=a.length;b<c;b++)a[b]=k(a[b]);return a.join("")};a.Krypto.prototype.shift=function(a){h=this.key.charCodeAt(a%this.key.length);q=this.numalfa(h);m=e(q/2%8);0==m&&(m=4);return m};a.Krypto.prototype.parseByte=function(a){a=parseInt(a);a=0>a?0:a;
return 255<a?255:a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame;a.Animation=function(d,e){this.parent=d;var f=d.evaluator,c=f.parser,b=new a.Auxiliary(d);this.start=null;this.delay=e.delay?c.parse(e.delay):c.parse("60");this.loop=
e.loop?e.loop:!1;this.auto=void 0==e.auto?!0:e.auto;this.controls=e.controls;this.init=b.splitInstructions(c,e.init);this.doExpr=b.splitInstructions(c,e.doExpr);e.whileExpr&&(this.whileExpr=c.parse(e.whileExpr));var k=this,g,p,h=k.doExpr.length;this.animationExec=function(){for(p=0;p<h;p++)f.evalExpression(k.doExpr[p]);k.parent.update();k.playing&&(0<f.evalExpression(k.whileExpr)||k.loop)?(g=f.evalExpression(k.delay),window.requestAnimationFrame||(k.timer=setTimeout(k.animationExec,10>g?10:g))):(k.stop(),
k.parent.update())};this.playing=!1;this.auto&&this.play()};a.Animation.prototype.play=function(){var a=this;this.playing?this.stop():(this.reinit(),this.playing=!0,delay=this.parent.evaluator.evalExpression(this.delay),this.timer=window.requestAnimationFrame?requestAnimationFrame(function(e){a.step(e)}):setTimeout(this.animationExec,10>delay?10:delay))};a.Animation.prototype.stop=function(){this.playing=!1;window.requestAnimationFrame?window.cancelAnimationFrame(this.timer):clearInterval(this.timer)};
a.Animation.prototype.reinit=function(){for(var a=0,e=this.init.length;a<e;a++)this.parent.evaluator.evalExpression(this.init[a])};a.Animation.prototype.step=function(a){var e=this;null===e.start&&(e.start=a);delay=e.parent.evaluator.evalExpression(e.delay);delay=10>delay?10:delay;a-e.start>delay&&(e.animationExec(),e.start=null);e.playing&&(e.timer=requestAnimationFrame(function(a){e.step(a)}))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Action=function(a,e){this.parent=
a;this.evaluator=this.parent.evaluator};a.Action.prototype.execute=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Message=function(d,e){a.Action.call(this,d,e);this.parameter=(e||"").replace(/\\n/g,"\n").replace(/&squot;/g,"'")};a.extend(a.Message,a.Action);a.Message.prototype.execute=function(){alert(this.parameter)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Calculate=function(d,e){a.Action.call(this,d,e);var f=this.evaluator,
c=f.parser;e=(e||"").replace(/&squot;/g,"'");e=e.replace(/;/g,"\\n");e=e.split("\\n")||[""];for(var b=[],k,g=0,p=e.length;g<p;g++)(k=c.parse(e[g],!0))&&b.push(k);p=b.length;this.execute=function(){for(g=0;g<p;g++)f.evalExpression(b[g])}};a.extend(a.Calculate,a.Action);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenURL=function(d,e){a.Action.call(this,d,e);this.parameter=e;this.target="_blank";var f=this.parameter.indexOf("target");-1!=f&&(this.target=this.parameter.substring(f),
this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,f-1));"javascript"==this.parameter.substring(0,10)?(this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){window.open(this.parameter,this.target)})};a.extend(a.OpenURL,
a.Action);a.OpenURL.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenScene=function(d,e){a.Action.call(this,d,e);this.parameter=e;this.target="_blank";var f=this.parameter.indexOf("target");-1!=f&&(this.target=this.parameter.substring(f),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,f-1));"_blank"!==this.target&&"_parent"!==this.target&&"_self"!==this.target&&"_top"!==
this.target?this.actionExec=function(){window.parent.postMessage({type:"changeTarget",name:this.target,value:this.parameter},"*")}:"javascript"==this.parameter.substring(0,10)?(this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){window.open(this.parameter,this.target,
"width="+this.parent.width+",height="+this.parent.height+",left="+(window.screen.width-this.parent.width)/2+", top="+(window.screen.height-this.parent.height)/2+"location=0,menubar=0,scrollbars=0,status=0,titlebar=0,toolbar=0")})};a.extend(a.OpenScene,a.Action);a.OpenScene.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.About=function(d,e){a.Action.call(this,d,e);e||(this.urlAbout=window.location.href.substring(0,window.location.href.lastIndexOf("/")+
1)+e)};a.extend(a.About,a.Action);a.About.prototype.execute=function(){console.log("about");if(this.urlAbout)var a=window.open(this.urlAbout,"_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes");else a=window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes"),a.document.write("<hmtl><head><title>Cr\u00e9ditos</title></head><body><h1>Aqu\u00ed van los cr\u00e9ditos</h1></body></html>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Config=function(d,e){a.Action.call(this,d,e)};a.extend(a.Config,a.Action);a.Config.prototype.execute=function(){this.parent.editor?this.parent.editor.show():window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes").document.write("<xmp style='width:100%; height:100%;'><script type='text/javascript' src='http://arquimedes.matem.unam.mx/Descartes5/lib/descartes-min.js'>\x3c/script>\n"+this.parent.applet.outerHTML.replace(/<applet/g,"<ajs").replace(/<\/applet/g,
"</ajs")+"</xmp>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Init=function(d,e){a.Action.call(this,d,e)};a.extend(a.Init,a.Action);a.Init.prototype.execute=function(){this.parent.init()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Clear=function(d,e){a.Action.call(this,d,e)};a.extend(a.Clear,a.Action);a.Clear.prototype.execute=function(){this.parent.clear()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animate=
function(d,e){a.Action.call(this,d,e)};a.extend(a.Animate,a.Action);a.Animate.prototype.execute=function(){this.parent.play()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.InitAnimation=function(d,e){a.Action.call(this,d,e)};a.extend(a.InitAnimation,a.Action);a.InitAnimation.prototype.execute=function(){this.parent.reinitAnimation()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=/[\w\.\-//]*(\.ogg|\.oga|\.mp3|\.wav|\.OGG|\.OGA\.MP3|\.WAV)/g;
a.PlayAudio=function(e,f){a.Action.call(this,e,f);f&&f.match(d)?this.filenameExpr=this.evaluator.parser.parse("'"+f.match(d)+"'"):this.filenameExpr=this.evaluator.parser.parse(f)};a.extend(a.PlayAudio,a.Action);a.PlayAudio.prototype.execute=function(){var a=this.theAudio=this.parent.getAudio(this.evaluator.evalExpression(this.filenameExpr));a.paused?a.play():(a.pause(),a.currentTime=0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Auxiliary=function(a,c){this.parent=
a;this.evaluator=this.parent.evaluator;this.expresion=this.id="";this.evaluate="onlyOnce";this.local="";for(var b in c)c.hasOwnProperty(b)&&(this[b]=c[b])};a.Auxiliary.prototype.firstRun=function(){};a.Auxiliary.prototype.update=function(){};var d,e;a.Auxiliary.prototype.splitInstructions=function(a,c){e=[];c=c?c.split(";"):[""];for(var b=0,k=c.length;b<k;b++)(d=a.parse(c[b],!0))&&e.push(d);return e};a.Auxiliary.prototype.getPrivateVariables=function(a,c){e=[];c=c?c.split(/;|,/):[""];for(var b=0,
k=c.length;b<k;b++)(d=a.parse(c[b],!0))&&e.push(d);b=0;for(k=e.length;b<k;b++)e[b]="asign"===e[b].type?e[b].childs[0].value:"identifier"===e[b].type?e[b].value:"";return e};a.Auxiliary.prototype.parseExpressions=function(a){this.init=this.splitInstructions(a,this.init);this.privateVars=this.getPrivateVariables(a,this.local);this.doExpr=this.splitInstructions(a,this.doExpr);this.whileExpr=a.parse(this.whileExpr)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Variable=function(d,
e){a.Auxiliary.call(this,d,e);var f=this.evaluator.parser;this.expresionString=this.expresion;(this.expresion=f.parse(this.expresionString))&&f.setVariable(this.id,this.expresion);this.editable&&(this.registerTextField(),this.parent.editableRegionVisible=!0)};a.extend(a.Variable,a.Auxiliary);a.Variable.prototype.registerTextField=function(){var a=document.createElement("div"),e=document.createElement("label");e.appendChild(document.createTextNode("___"+this.id+"=___"));var f=document.createElement("input");
f.value=this.expresionString;f.disabled=!this.editable;a.appendChild(e);a.appendChild(f);var c=this,b=c.evaluator.parser;f.onkeydown=function(a){13==a.keyCode&&(c.expresion=b.parse(this.value),b.setVariable(c.id,c.expresion),c.parent.update())};this.parent.editableRegion.textFields.push({container:a,type:"div"})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Constant=function(d,e){a.Auxiliary.call(this,d,e);this.expresion=this.evaluator.parser.parse(this.expresion);this.update()};
a.extend(a.Constant,a.Auxiliary);a.Constant.prototype.update=function(){this.evaluator.setVariable(this.id,this.evaluator.evalExpression(this.expresion))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f;a.Vector=function(c,b){d=c.evaluator;e=d.parser;this.size=e.parse("3");a.Auxiliary.call(this,c,b);this.expresion=this.expresion.split(";");this.parseFile=e.parse(this.file);this.update()};a.extend(a.Vector,a.Auxiliary);a.Vector.prototype.update=function(){var c=this.expresion;
d=this.evaluator;e=d.parser;this.oldFile=this.file;if(f=d.evalExpression(this.parseFile))this.file=f;var b;if(this.file){b=(vectorElement=document.getElementById(this.file))&&"descartes/vectorFile"==vectorElement.type?vectorElement.text:a.openExternalFile(this.file);if(null!=b){b=b.replace(/\r/g,"").split("\n");for(var k=[],g=0,p=b.length;g<p;g++)""!=b[g]&&k.push(b[g]);b=k}null==b||1==b.length&&""==b[0]?this.size=0:(c=b,this.size=null);null===this.size&&(this.size=e.parse(c.length+""))}b=[];g=0;for(p=
c.length;g<p;g++)(k=e.parse(c[g],!0))&&"asign"!=k.type&&(k=e.parse(this.id+"["+g+"]="+c[g],!0)),b.push(k);c=[];g=0;for(p=d.evalExpression(this.size);g<p;g++)c.push(0);d.vectors[this.id]=c;d.setVariable(this.id+".long",d.evalExpression(this.size));g=0;for(p=b.length;g<p;g++)d.evalExpression(b[g])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Matrix=function(d,e){var f=d.evaluator,c=f.parser;this.rows=c.parse("3");this.columns=c.parse("3");a.Auxiliary.call(this,d,e);this.expresion=
this.splitInstructions(c,this.expresion);var c=f.evalExpression(this.rows),b=f.evalExpression(this.columns),k=[];k.type="matrix";for(var g,p=0;p<b;p++){g=[];for(var h=0,q=c;h<q;h++)g.push(0);k[p]=g}f.matrices[this.id]=k;this.update()};a.extend(a.Matrix,a.Auxiliary);a.Matrix.prototype.update=function(){var a=this.evaluator,e=a.evalExpression(this.rows),f=a.evalExpression(this.columns);a.setVariable(this.id+".filas",e);a.setVariable(this.id+".columnas",f);var c=a.matrices[this.id];c.rows=e;c.cols=f;
e=0;for(f=this.expresion.length;e<f;e++)a.evalExpression(this.expresion[e])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Function=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator,c=f.parser,b=this.id.indexOf("(");this.name=this.id.substring(0,b);this.params=this.id.substring(b+1,this.id.indexOf(")"));this.domain=this.range?c.parse(this.range):c.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;this.algorithm||
(this.whileExpr=this.doExpr=this.init="");this.parseExpressions(c);this.expresion=c.parse(this.expresion);var k=this;this.functionExec=function(){this.iterations=0;if(k.numberOfParams<=arguments.length){for(var b=[],c=0,d=k.privateVars.length;c<d;c++)b.push(f.getVariable(k.privateVars[c])),f.setVariable(k.privateVars[c],0);for(var e=[],c=0,d=k.params.length;c<d;c++)e[c]=f.getVariable(k.params[c])||0,f.setVariable(k.params[c],arguments[c]);c=0;for(d=k.init.length;c<d;c++)f.evalExpression(k.init[c]);
do{c=0;for(d=k.doExpr.length;c<d;c++)f.evalExpression(k.doExpr[c]);if(1E5<++this.iterations)return console.log("se ha excedido el l\u00edmite de 100000 repeticiones en la funci\u00f3n",this.id),0}while(0<f.evalExpression(k.whileExpr));var m=f.evalExpression(k.expresion);a.rangeOK=f.evalExpression(k.domain);c=0;for(d=k.params.length;c<d;c++)f.setVariable(k.params[c],e[c]);c=0;for(d=k.privateVars.length;c<d;c++)f.setVariable(k.privateVars[c],b[c]);return m}return 0};f.setFunction(this.name,this.functionExec)};
a.extend(a.Function,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Algorithm=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator;this.parseExpressions(f.parser);this.algorithmExec=function(){for(var a=this.iterations=0,b=this.init.length;a<b;a++)f.evalExpression(this.init[a]);do{a=0;for(b=this.doExpr.length;a<b;a++)f.evalExpression(this.doExpr[a]);if(1E5<++this.iterations)return console.log("se ha excedido el l\u00edmite de 100000 repeticiones en el algoritmo",
this.id),0}while(0<f.evalExpression(this.whileExpr))}};a.extend(a.Algorithm,a.Auxiliary);a.Algorithm.prototype.update=function(){this.algorithmExec();"onlyOnce"===this.evaluate&&(this.update=function(){})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Event=function(d,e){a.Auxiliary.call(this,d,e);var f=this.evaluator;this.condition=f.parser.parse(this.condition);this.lastEvaluation=!1;this.action=this.parent.lessonParser.parseAction(this);"onlyOnce"==this.execution&&
(this.eventExec=function(){0<f.evalExpression(this.condition)&&!this.lastEvaluation&&(this.lastEvaluation=!0,this.action.execute())});"alternate"==this.execution&&(this.eventExec=function(){var a=0<f.evalExpression(this.condition);3==this.parent.version?a!=this.lastEvaluation&&(this.action.execute(),this.lastEvaluation=a?!0:!1):a&&!this.lastEvaluation?(this.action.execute(),this.lastEvaluation=!0):!a&&this.lastEvaluation&&(this.lastEvaluation=!1)});"always"==this.execution&&(this.eventExec=function(){0<
f.evalExpression(this.condition)&&this.action.execute()})};a.extend(a.Event,a.Auxiliary);a.Event.prototype.update=function(){this.eventExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.GenericDefinition=function(a,e){this.parent=a;this.evaluator=this.parent.evaluator;this.id="_";for(var f in e)e.hasOwnProperty(f)&&(this[f]=e[f])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round;a.Rectangle=function(d,f){this.fill="";a.GenericDefinition.call(this,
d,f);this.evaluator.setDefinition(this.id,this)};a.extend(a.Rectangle,a.GenericDefinition);a.Rectangle.prototype.update=function(){};a.Rectangle.prototype.draw=function(a,f,c,b){var k=b.space,g=this.evaluator,p=_y=_w=_h=0;b.abs_coord?(p=d(g.evalExpression(this.x)),_y=d(g.evalExpression(this.y)),_w=d(g.evalExpression(this.width)),_h=d(g.evalExpression(this.height))):(p=d(k.getAbsoluteX(g.evalExpression(this.x))),_y=d(k.getAbsoluteY(g.evalExpression(this.y))),_w=g.evalExpression(this.width)*k.scale,
_h=g.evalExpression(this.height)*k.scale);k=d(g.evalExpression(b.width));a.lineWidth=0<k?k:1E-6;k=0==a.lineWidth%2?0:0.5;a.strokeStyle=c.getColor();a.lineCap="round";a.lineJoin="round";a.beginPath();a.moveTo(p+k,_y+k);a.lineTo(p+k+_w,_y+k);a.lineTo(p+k+_w,_y+k+_h);a.lineTo(p+k,_y+k+_h);a.closePath();b.fill&&(a.fillStyle=f.getColor(),a.fill());a.stroke()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b;a.Graphic=function(b,c){this.parent=b;this.evaluator=b.evaluator;
var f=this.evaluator.parser;this.spaceID="";this.background=!1;this.type="";this.drawif=f.parse("1");this.abs_coord=!1;this.color=new a.Color("blue");2!==this.parent.version&&(this.color=new a.Color("20303a"),this.parent.arquimedes&&(this.color=new a.Color("black")));this.trace="";this.expresion=f.parse("(0,0)");this.family="";this.family_interval=f.parse("[0,1]");this.family_steps=f.parse("8");this.editable=!1;this.font=5<=this.parent.version?"Monospaced,PLAIN,15":"Monospaced,PLAIN,12";this.fixed=
!0;this.text="";this.decimals=f.parse("2");for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.trace&&(this.traceCtx=this.space.backgroundCanvas.getContext("2d"));this.font=a.convertFont(this.font);this.fontSize=(this.fontSize=this.font.match(/([\d\.]+)px/))?parseFloat(this.fontSize[1]):10};a.Graphic.prototype.getSpace=function(){for(var a=this.parent.spaces,
b,c=0,f=a.length;c<f;c++)if(b=a[c],b.id==this.spaceID)return b;return a[0]};a.Graphic.prototype.getFamilyValues=function(){d=this.evaluator;e=d.evalExpression(this.family_interval);this.familyInf=e[0][0];this.familySup=e[0][1];this.fSteps=Math.round(d.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic.prototype.drawFamilyAux=function(a,b,c){d=this.evaluator;this.getFamilyValues();f=d.getVariable(this.family);if(0<=this.fSteps)for(var h=
0,e=this.fSteps;h<=e;h++)d.setVariable(this.family,this.familyInf+h*this.family_sep),0<d.evalExpression(this.drawif)&&(this.update(),this.drawAux(a,b,c));d.setVariable("_Text_H_",0);d.setVariable(this.family,f)};a.Graphic.prototype.draw=function(a,b){""!=this.family?this.drawFamilyAux(this.ctx,a,b):0<this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.ctx,a,b))};a.Graphic.prototype.drawTrace=function(a,b){""!=this.family?this.drawFamilyAux(this.traceCtx,a,b):0<this.evaluator.evalExpression(this.drawif)&&
(this.update(),this.drawAux(this.traceCtx,a,b))};a.Graphic.prototype.drawText=function(a,g,f,h,e,m,l,s,t,n,u){if("rtfNode"===g.type)a.fillStyle=e.getColor(),a.strokeStyle=e.getColor(),a.textBaseline="alphabetic",g.draw(a,f,h+1,t,n,l,u,e.getColor());else for("simpleText"===g.type&&(g=g.toString(t,n).split("\\n")),f+=m.match("Arial")?-2:m.match("Times")?-2:0,d=this.evaluator,a.fillStyle=e.getColor(),a.font=m,a.textAlign=l,a.textBaseline=s,this.border&&(a.strokeStyle=this.border.getColor(),a.lineWidth=
3),b=1.2*this.fontSize||0,e=0,m=g.length;e<m;e++)c=g[e],this.border&&(a.lineJoin="round",a.strokeText(c,f,h+b*e)),a.fillText(c,f,h+b*e)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.SimpleText=function(a,c){this.text=c=c.replace("&#x2013","\u2013").replace(/\&squot;/g,"'");this.textElements=[];this.textElementsMacros=[];this.parent=a;this.evaluator=a.evaluator;this.type="simpleText";for(var b="'",d=0,g=0,e=-1,h,q;d<c.length;)h=c.charAt(d),q=c.charAt(d-1),"["===h&&"\\"===
q?(this.textElements.push(c.substring(g,d-1)+"["),this.textElementsMacros.push("'"+c.substring(g,d-1)+"['"),g=d+1):"]"===h&&"\\"===q?(this.textElements.push(c.substring(g,d-1)+"]"),this.textElementsMacros.push("'"+c.substring(g,d-1)+"]'"),g=d+1):"["===h&&-1===e?(this.textElements.push(c.substring(g,d)),this.textElementsMacros.push("'"+c.substring(g,d)+"'"),g=d,e++):"["===h?e++:"]"===h&&0===e?(this.textElements.push(this.evaluator.parser.parse(c.substring(g,d+1))),this.textElementsMacros.push("["+
c.substring(g,d+1)+"]"),g=d+1,e--):("]"==c.charAt(d)&&(e=0>e?e:e-1),b+=c.charAt(d)),d++;this.textElements.push(c.substring(g,d));this.textElementsMacros.push("'"+c.substring(g,d)+"'")};var d,e;a.SimpleText.prototype.toString=function(f,c){d="";for(var b=0,k=this.textElements.length;b<k;b++)"string"===typeof this.textElements[b]?d+=this.textElements[b]:(e=this.evaluator.evalExpression(this.textElements[b])[0][0],""!==e&&("string"===typeof e?d+=e:(e=parseFloat(e),e=c?e.toFixed(f):a.removeNeedlessDecimals(e.toFixed(f)),
d+=e.toString().replace(".",this.parent.decimal_symbol))));return d};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v,w,y,C,A,D,E,z,B,G;a._debug_vez=0;a.Equation=function(b,c){this.width=b.evaluator.parser.parse("1");this.fillM=this.fillP="";a.Graphic.call(this,b,c);this.parseExpression();(this.visible=2===this.parent.version&&void 0==this.visible?!0:this.visible)&&this.registerTextField();l=new a.R2;s=new a.R2;t=new a.R2;r=new a.R2;
n=new a.R2};a.extend(a.Equation,a.Graphic);a.Equation.prototype.parseExpression=function(){if("compOperator"===this.expresion.type){var b=this.expresion.childs[0],c=this.expresion.childs[1];"identifier"!=b.type||"y"!=b.value||c.contains("y")?"identifier"!=c.type||"y"!=c.value||b.contains("y")?"identifier"!=b.type||"x"!=b.value||c.contains("x")?"identifier"!=c.type||"x"!=c.value||b.contains("x")||(this.of_y=!0,this.funExpr=c,this.drawAux=this.drawAuxFun):(this.funExpr=c,this.of_y=!0,this.drawAux=this.drawAuxFun):
(this.funExpr=b,this.of_y=!1,this.drawAux=this.drawAuxFun):(this.funExpr=c,this.of_y=!1,this.drawAux=this.drawAuxFun)}this.newt=new a.R2Newton(this.evaluator,this.expresion)};a.Equation.prototype.update=function(){};a.Equation.prototype.draw=function(){""!=this.family?this.drawFamilyAux(this.ctx,this.fill,this.color):(this.update(),this.drawAux(this.ctx,this.fill,this.color))};a.Equation.prototype.drawFamilyAux=function(a,b,c){e=this.evaluator;this.getFamilyValues();tempParam=e.getVariable(this.family);
if(0<=this.fSteps)for(var g=0,d=this.fSteps;g<=d;g++)e.setVariable(this.family,this.familyInf+g*this.family_sep),this.update(),this.drawAux(a,b,c);e.setVariable(this.family,tempParam)};a.Equation.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Equation.prototype.drawAux=function(H,K,L){if(!(0>=this.evaluator.evalExpression(this.drawif))){var x,J,F;e=this.evaluator;f=e.parser;c=this.space;b=e.evalExpression(this.width);H.strokeStyle=this.color.getColor();H.lineWidth=
b;k=f.getVariable("x");g=f.getVariable("y");p=c.w;h=c.h;q=p/9;3>q&&(q=3);m=h/7;3>m&&(m=3);d=[];l.set(0,0);s.set(0,0);t.set(0,0);var P=0.25,M=8;this.abs_coord||(P/=c.scale,M/=c.scale);H.beginPath();for(G=parseInt(m/2);G<h;G+=m)for(B=parseInt(q/2);B<p;B+=q){if(this.abs_coord){r.set(B,G);u=this.newt.findZero(r,P);if(null==u)continue;e.setVariable("x",u.x);e.setVariable("y",u.y);n.set(u.x,u.y)}else{r.set(c.getRelativeX(B),c.getRelativeY(G));u=this.newt.findZero(r,P);if(null==u)continue;e.setVariable("x",
u.x);e.setVariable("y",u.y);n.set(c.getAbsoluteX(u.x),c.getAbsoluteY(u.y))}v=n.ix();w=n.iy();if(0<=v&&v<p&&0<=w&&w<h){if(d[v+w*c.w])continue;d[v+w*c.w]=!0}a.rangeOK&&(H.moveTo(v,w),H.lineTo(v,w));l.x=u.x;l.y=u.y;s.x=u.x;s.y=u.y;y=this.newt.getUnitNormal();if(0!=y.x||0!=y.y)for(y.rotL90(),t.x=y.x,t.y=y.y,A=C=0,D=!1;2>A;)if(D&&(t.x=-y.x,t.y=-y.y,u.x=l.x,u.y=l.y,s.x=u.x,s.y=u.y,this.abs_coord?n.set(u.x,u.y):n.set(c.getAbsoluteX(u.x),c.getAbsoluteY(u.y)),v=n.ix(),w=n.iy(),D=!1,C=0),u.x+=M*t.x,u.y+=M*
t.y,u=this.newt.findZero(u,P),null!=u){e.setVariable("x",u.x);e.setVariable("y",u.y);t.x=u.x-s.x;t.y=u.y-s.y;t.normalize();if(0==t.x&&0==t.y)break;s.x=u.x;s.y=u.y;this.abs_coord?n.set(u.x,u.y):n.set(c.getAbsoluteX(u.x),c.getAbsoluteY(u.y));E=parseInt(n.ix());z=parseInt(n.iy());if(E!=v||z!=w)if(K=v,L=w,v=E,w=z,0<=v&&v<p&&0<=w&&w<h){C=0;x=d[v+w*c.w];d[v+w*c.w]=!0;for(var I=1;8>I;I++)J=K+Math.round((v-K)*I/8),F=L+Math.round((w-L)*I/8),0<=J&&J<p&&0<=F&&F<h&&(d[J+F*c.w]=!0);a.rangeOK&&(H.moveTo(K,L),H.lineTo(v,
w));if(x)break}else D=!0,A++;else 4<++C&&(D=!0,A++)}}H.stroke()}};a.Equation.prototype.X=function(a,b,c){c||(b=this.space.w/2+this.space.Ox+this.space.scale*b);b<-a&&(b=-a);b>this.space.w+a&&(b=this.space.w+a);return b};a.Equation.prototype.Y=function(a,b,c){c||(b=this.space.h/2+this.space.Oy-this.space.scale*b);b<-a&&(b=-a);b>this.space.h+a&&(b=this.space.h+a);return b};a.Equation.prototype.XX=function(a,b,c){return Math.round(this.X(a,b,c))};a.Equation.prototype.YY=function(a,b,c){return Math.round(this.Y(a,
b,c))};a.Equation.prototype.extrapolate=function(b,c,g,d,f,k){for(var h=this.evaluator.getVariable(c),e=k/2,p=0;1E-12<Math.abs(e);){var m=this.evaluator.getVariable(c),n=this.evaluator.getVariable(c)+e;this.evaluator.setVariable(c,n);var q=!0,r=f;f=this.evaluator.evalExpression(this.funExpr);this.evaluator.setVariable(g,f);if(0<this.evaluator.evalExpression(b)){var l=new a.R2(Math.min(r,f),Math.max(r,f)),s=0,s=0<k?this.Singularity(Math.abs(e),c,d,m,r,n,f,l):this.Singularity(Math.abs(e),c,d,n,f,m,
r,l);0<s&&(q=!1)}else q=!1;q?p+=e:this.evaluator.setVariable(c,m);e/=2}this.evaluator.setVariable(c,h);return new a.R2(p/Math.abs(k),f)};a.Equation.prototype.extrapolateOnSingularity=function(b,c,g,d,f,k){d=this.evaluator.getVariable(c);for(var e=k/2,h=0,p=f;1E-12<Math.abs(e);){this.evaluator.setVariable(this.evaluator.getVariable(c)+e);var m=!0;0<this.evaluator.evalExpression(b)?(p=this.evaluator.evalExpression(this.funExpr),this.evaluator.setVariable(g,p),0>=this.evaluator.evalExpression(b)&&(m=
!1)):m=!1;m?h+=e:this.evaluator.setVariable(this.evaluator.getVariable(c)-e);e/=2}if(0==h)for(e=k/2,h=k,p=f;1E-12<Math.abs(e);)this.evaluator.setVariable(this.evaluator.getVariable(c)-e),m=!0,0<this.evaluator.evalExpression(b)?p=this.evaluator.evalExpression(this.funExpr):m=!1,m?h+=-e:this.evaluator.setVariable(this.evaluator.getVariable(c)+e),e/=2;this.evaluator.setVariable(d);return new a.R2(h/Math.abs(k),p)};a.Equation.prototype.Singularity=function(a,b,c,g,d,f,k,e){if(g>=f)return 2;var h=this.evaluator.getVariable(b),
p=0;if(1E-12>Math.abs(f-g)||1E-8>Math.abs(f-g)&&Math.abs(k-d)>Math.abs(a))return this.evaluator.setVariable(b,h),1;var m=(g+f)/2;this.evaluator.setVariable(b,m);var n=this.evaluator.evalExpression(this.funExpr);if(Math.abs(k-d)>a){this.evaluator.setVariable(b,g-1E-6);var q=this.evaluator.evalExpression(this.funExpr),q=(d-q)/1E-6;this.evaluator.setVariable(b,f+1E-6);var r=(this.evaluator.evalExpression(this.funExpr)-k)/1E-6,l=(k-d)/(f-g);if((10>Math.abs(r)||10>Math.abs(q))&&(0<=r&&0<=q||0>=r&&0>=q)&&
8*Math.abs(r)<Math.abs(l))return this.evaluator.setVariable(b,h),2}e.x<=n&&n<=e.y||(this.evaluator.setVariable(b,m),e.x=Math.min(d,n),e.y=Math.max(d,n),g=this.Singularity(a/2,b,c,g,d,m,n,e),this.evaluator.setVariable(b,f),e.x=Math.min(k,n),e.y=Math.max(k,n),a=this.Singularity(a/2,b,c,m,n,f,k,e),p=Math.max(g,a));this.evaluator.setVariable(b,h);return p};a.Equation.prototype.drawAuxFun=function(b,c,d){k=this.evaluator.parser.getVariable("x");g=this.evaluator.parser.getVariable("y");a.rangeOK=1;c="x";
d="y";this.of_y&&(c="y",d="x");var f=this.drawif,e=this.evaluator.evalExpression(this.width),h=!1,p=new a.R2(this.space.w/2+this.space.Ox,this.space.h/2+this.space.Oy),p=this.of_y?p.ix():p.iy(),m=0,n=0,q=0,r=1/this.space.scale,l=r*(this.of_y?-this.space.h+(this.space.h/2+this.space.Oy):-(this.space.w/2+this.space.Ox)),m=0;this.abs_coord&&(l=0,r=1);for(var s=this.of_y?this.space.h:this.space.w;n<s;){var u=!0,v=0;this.evaluator.setVariable(c,l);var t=this.evaluator.evalExpression(this.funExpr);if(isNaN(t))u=
!1;else{this.evaluator.setVariable(d,t);if(0<this.evaluator.evalExpression(this.drawif)&&a.rangeOK){if(h){var v=Math.min(m,t),w=Math.max(m,t),w=new a.R2(v,w),v=this.Singularity(r,c,0,l-r,m,l,t,w);0===v?(m<=t?(m=w.x,t=w.y):(t=w.x,m=w.y),v=this.of_y?this.XX(e,m,this.abs_coord):this.YY(e,m,this.abs_coord),m=this.abs_coord?Math.round(t):this.of_y?this.XX(e,t,this.abs_coord):this.YY(e,t,this.abs_coord),this.fillM&&m>p&&(b.lineWidth=1,b.strokeStyle=this.fillM.getColor(),b.beginPath(),this.of_y?(b.moveTo(p+
1,this.space.h-n+0.5),b.lineTo(m,this.space.h-n+0.5)):(b.moveTo(n+0.5,p+1),b.lineTo(n+0.5,m)),b.stroke()),this.fillP&&m<p&&(b.lineWidth=1,b.strokeStyle=this.fillP.getColor(),b.beginPath(),this.of_y?(b.moveTo(p-1,this.space.h-n+0.5),b.lineTo(m,this.space.h-n+0.5)):(b.moveTo(n+0.5,p-1),b.lineTo(n+0.5,m)),b.stroke()),b.lineWidth=e,b.strokeStyle=this.color.getColor(),b.beginPath(),this.of_y?(b.moveTo(v+0.5,this.space.h-q),b.lineTo(m+0.5,this.space.h-n)):(b.moveTo(q+0.5,v),b.lineTo(n+0.5,m)),b.stroke()):
(1===v&&(this.evaluator.setVariable(c,l-r),q=this.extrapolate(f,c,d,0,m,r),this.YY(e,q.y,this.abs_coord),this.evaluator.setVariable(c,l),q=this.extrapolate(f,c,d,0,t,-r),this.YY(e,q.y,this.abs_coord)),this.YY(e,t,this.abs_coord))}else q=this.extrapolateOnSingularity(f,c,d,0,t,-r),this.YY(e,q.y,this.abs_coord),this.YY(e,t,this.abs_coord);m=t}else u=!1;h&&!u&&(this.evaluator.setVariable(c,l-r),this.evaluator.setVariable(d,m),q=this.extrapolate(f,c,d,0,m,r),this.YY(e,q.y,this.abs_coord),this.evaluator.setVariable(c,
l))}h=u;l+=r;q=n++}this.evaluator.parser.setVariable("x",k);this.evaluator.parser.setVariable("y",g)};a.Equation.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var b=this;a.onkeydown=function(a){13==a.keyCode&&(b.expresion=b.evaluator.parser.parse(this.value),b.parseExpression(),b.parent.update())};this.parent.editableRegion.textFields.push(a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d=Math.round;a.Curve=function(b,c){this.parameter="t";this.parameter_interval=b.evaluator.parser.parse("[0,1]");this.parameter_steps=b.evaluator.parser.parse("8");this.width=b.evaluator.parser.parse("1");this.fill="";a.Graphic.call(this,b,c);(this.visible=2==this.parent.version&&void 0==this.visible?!0:!1)&&this.registerTextField()};a.extend(a.Curve,a.Graphic);var e,f,c,b,k,g,p,h,q,m,l;a.Curve.prototype.update=function(){e=this.evaluator;f=e.evalExpression(this.parameter_interval);this.paraInf=
f[0][0];this.paraSup=f[0][1];this.pSteps=e.evalExpression(this.parameter_steps);this.paraSep=0<this.pSteps?Math.abs(this.paraSup-this.paraInf)/this.pSteps:0};a.Curve.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Curve.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Curve.prototype.drawAux=function(f,t,n){e=this.evaluator;c=this.space;b=d(e.evalExpression(this.width));f.lineWidth=0<b?b:1E-6;f.lineCap="round";f.lineJoin="round";f.strokeStyle=
n.getColor();k=e.getVariable(this.parameter);f.beginPath();e.setVariable(this.parameter,this.paraInf);g=e.evalExpression(this.expresion);this.exprX=this.abs_coord?d(g[0][0]):d(c.getAbsoluteX(g[0][0]));this.exprY=this.abs_coord?d(g[0][1]):d(c.getAbsoluteY(g[0][1]));this.rotateExp&&(p=a.degToRad(e.evalExpression(this.rotateExp)),h=Math.cos(p),q=Math.sin(p),m=this.exprX*h-this.exprY*q,l=this.exprX*q+this.exprY*h,this.exprX=m,this.exprY=l);f.moveTo(this.exprX+0.5,this.exprY+0.5);for(n=1;n<=this.pSteps;n++)e.setVariable(this.parameter,
this.paraInf+n*this.paraSep),g=e.evalExpression(this.expresion),this.exprX=this.abs_coord?d(g[0][0]):d(c.getAbsoluteX(g[0][0])),this.exprY=this.abs_coord?d(g[0][1]):d(c.getAbsoluteY(g[0][1])),this.rotateExp&&(m=this.exprX*h-this.exprY*q,l=this.exprX*q+this.exprY*h,this.exprX=m,this.exprY=l),f.lineTo(this.exprX+0.5,this.exprY+0.5);this.fill&&(f.fillStyle=t.getColor(),f.fill());f.stroke();e.setVariable(this.parameter,k)};a.Curve.prototype.registerTextField=function(){var a=document.createElement("input");
a.value=this.expresionString;a.disabled=!this.editable;var b=this;a.onkeydown=function(a){13==a.keyCode&&(b.expresion=b.evaluator.parser.parse(this.value),b.parent.update())};this.parent.editableRegion.textFields.push(a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=2*Math.PI,e=Math.round,f,c,b,k,g,p,h,q,m,l,s,t,n,u;a.Sequence=function(b,c){this.size=b.evaluator.parser.parse("2");this.range=b.evaluator.parser.parse("[1, 100]");a.Graphic.call(this,b,c)};a.extend(a.Sequence,
a.Graphic);a.Sequence.prototype.update=function(){f=this.evaluator;b=f.evalExpression(this.expresion);this.exprX=b[0][0];this.exprY=b[0][1];this.rotateExp&&(k=a.degToRad(f.evalExpression(this.rotateExp)),g=Math.cos(k),p=Math.sin(k),h=this.exprX*g-this.exprY*p,q=this.exprX*p+this.exprY*g,this.exprX=h,this.exprY=q);s=f.evalExpression(this.range);this.rangeInf=s[0][0];this.rangeMax=s[0][1]};a.Sequence.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Sequence.prototype.drawTrace=
function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Sequence.prototype.drawAux=function(a,g){f=this.evaluator;c=this.space;n=t=Math.ceil(f.evalExpression(this.size)-0.4);a.fillStyle=g.getColor();a.beginPath();this.rangeInf>this.rangeMax&&(u=this.rangeInf,this.rangeInf=this.rangeMax,this.rangeMax=u);for(var k=f.getVariable("n"),h=this.rangeInf,p=this.rangeMax;h<=p;h++)f.setVariable("n",h),b=f.evalExpression(this.expresion),this.exprX=b[0][0],this.exprY=b[0][1],m=this.abs_coord?e(this.exprX):
e(c.getAbsoluteX(this.exprX)),l=this.abs_coord?e(this.exprY):e(c.getAbsoluteY(this.exprY)),a.beginPath(),a.arc(m,l,t,0,d,!0),a.fill();a.fill();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,m+n,l-n,this.color,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed,!0);f.setVariable("n",k)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=2*Math.PI,e=Math.round,f,c,b,k,g,p,h,q,m,l,s,t;a.Point=function(b,c){this.size=b.evaluator.parser.parse("2");
a.Graphic.call(this,b,c)};a.extend(a.Point,a.Graphic);a.Point.prototype.update=function(){f=this.evaluator;b=f.evalExpression(this.expresion);this.exprX=b[0][0];this.exprY=b[0][1];this.rotateExp&&(k=a.degToRad(f.evalExpression(this.rotateExp)),g=Math.cos(k),p=Math.sin(k),h=this.exprX*g-this.exprY*p,q=this.exprX*p+this.exprY*g,this.exprX=h,this.exprY=q)};a.Point.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Point.prototype.drawTrace=function(){this.uber.drawTrace.call(this,
this.trace,this.trace)};a.Point.prototype.drawAux=function(a,b){f=this.evaluator;c=this.space;s=e(f.evalExpression(this.size));t=s+1;a.fillStyle=b.getColor();m=this.abs_coord?e(this.exprX):e(c.getAbsoluteX(this.exprX));l=this.abs_coord?e(this.exprY):e(c.getAbsoluteY(this.exprY));a.beginPath();a.arc(m,l,s,0,d,!0);a.fill();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,m+t+1,l-t,this.color,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round,e=2*Math.PI,f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v,w,y;a.Segment=function(b,c){this.width=b.evaluator.parser.parse("1");this.size=b.evaluator.parser.parse("2");a.Graphic.call(this,b,c)};a.extend(a.Segment,a.Graphic);a.Segment.prototype.update=function(){f=this.evaluator;b=f.evalExpression(this.expresion);this.endPoints=[];for(var c=0,d=b.length;c<d;c++)this.endPoints[c]={x:b[c][0],y:b[c][1]};if(this.rotateExp)for(k=a.degToRad(f.evalExpression(this.rotateExp)),
g=Math.cos(k),p=Math.sin(k),c=0,d=this.endPoints.length;c<d;c++)h=this.endPoints[c].x*g-this.endPoints[c].y*p,q=this.endPoints[c].x*p+this.endPoints[c].y*g,this.endPoints[c].x=h,this.endPoints[c].y=q};a.Segment.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Segment.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Segment.prototype.drawAux=function(a,b,g){f=this.evaluator;c=this.space;m=d(f.evalExpression(this.width));a.lineWidth=
0<m?m:1E-6;n=f.evalExpression(this.size);0>n&&(n=0);a.fillStyle=b.getColor();a.strokeStyle=g.getColor();a.lineCap="round";l=10+a.lineWidth;u=0==a.lineWidth%2?0:0.5;this.abs_coord?(r=d(this.endPoints[0].x),v=d(this.endPoints[0].y),w=d(this.endPoints[1].x),y=d(this.endPoints[1].y)):(r=d(c.getAbsoluteX(this.endPoints[0].x)),v=d(c.getAbsoluteY(this.endPoints[0].y)),w=d(c.getAbsoluteX(this.endPoints[1].x)),y=d(c.getAbsoluteY(this.endPoints[1].y)));a.beginPath();a.moveTo(r+u,v+u);a.lineTo(w+u,y+u);a.stroke();
a.beginPath();a.arc(r,v,n,0,e,!0);a.arc(w,y,n,0,e,!0);a.fill();this.text!=[""]&&(s=parseInt((r+w)/2)-3,t=parseInt((v+y)/2)+3,this.uber.drawText.call(this,a,this.text,s+l,t-l,this.color,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed,!0))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e=Math.round,f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v,w,y;a.Arrow=function(b,c){this.width=b.evaluator.parser.parse("5");this.size=b.evaluator.parser.parse("2");
this.spear=b.evaluator.parser.parse("8");this.arrow=new a.Color("ee0022");a.Graphic.call(this,b,c)};a.extend(a.Arrow,a.Graphic);a.Arrow.prototype.update=function(){f=this.evaluator;c=f.evalExpression(this.expresion);this.endPoints=[];for(var d=0,e=c.length;d<e;d++)this.endPoints[d]={x:c[d][0],y:c[d][1]};if(this.rotateExp)for(b=a.degToRad(f.evalExpression(this.rotateExp)),k=Math.cos(b),g=Math.sin(b),d=0,e=this.endPoints.length;d<e;d++)p=this.endPoints[d].x*k-this.endPoints[d].y*g,h=this.endPoints[d].x*
g+this.endPoints[d].y*k,this.endPoints[d].x=p,this.endPoints[d].y=h};a.Arrow.prototype.draw=function(){this.uber.draw.call(this,this.arrow,this.color)};a.Arrow.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.arrow,this.trace)};a.Arrow.prototype.drawAux=function(b,c,g){f=this.evaluator;q=this.space;f.evalExpression(this.size);s=f.evalExpression(this.width);0>s&&(s=0);t=Math.ceil(s/2);n=q.scale;this.vect=new a.Vector2D(this.endPoints[1].x-this.endPoints[0].x,this.endPoints[1].y-this.endPoints[0].y);
u=this.vect.vectorLength();this.angle=this.vect.angleBetweenVectors(a.Vector2D.AXIS_X);b.fillStyle=c.getColor();b.strokeStyle=g.getColor();b.lineWidth=2;this.abs_coord?(r=e(this.endPoints[0].x),v=e(this.endPoints[0].y),w=e(this.endPoints[1].x),y=e(this.endPoints[1].y)):(r=e(q.getAbsoluteX(this.endPoints[0].x)),v=e(q.getAbsoluteY(this.endPoints[0].y)),w=e(q.getAbsoluteX(this.endPoints[1].x)),y=e(q.getAbsoluteY(this.endPoints[1].y)));c=f.evalExpression(this.spear);0>c&&(c=0);b.save();b.translate(r,
v,u);this.abs_coord?0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?b.rotate(this.angle):b.rotate(-this.angle):(u*=n,0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?b.rotate(-this.angle):b.rotate(this.angle));b.beginPath();b.moveTo(-t,d(-t));b.lineTo(d(u-c-s),d(-t));b.lineTo(d(u-2*c),d(-c-t));b.lineTo(d(u),0);b.lineTo(d(u-2*c),d(c+t));b.lineTo(d(u-c-s),d(t));b.lineTo(-t,d(t));b.closePath();b.stroke();b.fill();b.restore();this.text!=[""]&&(m=parseInt((r+w)/2)-3,l=parseInt((v+
y)/2)+3,this.uber.drawText.call(this,b,this.text,m,l,g,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed,!0))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round,e,f,c,b,k,g,p,h,q,m,l,s;a.Polygon=function(b,c){this.width=b.evaluator.parser.parse("1");this.fill="";a.Graphic.call(this,b,c);this.endPoints=[]};a.extend(a.Polygon,a.Graphic);a.Polygon.prototype.update=function(){e=this.evaluator;c=e.evalExpression(this.expresion);for(var d=
0,f=c.length;d<f;d++)this.endPoints[d]={x:c[d][0],y:c[d][1]};if(this.rotateExp)for(b=a.degToRad(e.evalExpression(this.rotateExp)),k=Math.cos(b),g=Math.sin(b),d=0,f=this.endPoints.length;d<f;d++)p=this.endPoints[d].x*k-this.endPoints[d].y*g,h=this.endPoints[d].x*g+this.endPoints[d].y*k,this.endPoints[d].x=p,this.endPoints[d].y=h};a.Polygon.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Polygon.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};
a.Polygon.prototype.drawAux=function(a,b,c){e=this.evaluator;f=this.space;q=d(e.evalExpression(this.width));a.lineWidth=0<q?q:1E-6;a.strokeStyle=c.getColor();a.lineCap="round";a.lineJoin="round";m=0<q?0.5:0;l=this.abs_coord?d(this.endPoints[0].x):d(f.getAbsoluteX(this.endPoints[0].x));s=this.abs_coord?d(this.endPoints[0].y):d(f.getAbsoluteY(this.endPoints[0].y));a.beginPath();a.moveTo(l+m,s+m);c=1;for(var g=this.endPoints.length;c<g;c++)l=this.abs_coord?d(this.endPoints[c].x):d(f.getAbsoluteX(this.endPoints[c].x)),
s=this.abs_coord?d(this.endPoints[c].y):d(f.getAbsoluteY(this.endPoints[c].y)),a.lineTo(l+m,s+m);this.fill&&(a.fillStyle=b.getColor(),a.fill());a.stroke()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round,e,f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v,w,y,C,A;a.Arc=function(b,c){this.width=b.evaluator.parser.parse("1");this.fill="";this.center=b.evaluator.parser.parse("(0,0)");this.radius=b.evaluator.parser.parse("1");this.init="0";this.end="90";a.Graphic.call(this,b,c);
this.init.match(/^_\(/)&&(this.initFlag=!0,this.init=this.init.substring(1));this.end.match(/^_\(/)&&(this.endFlag=!0,this.end=this.end.substring(1));this.initExpr=b.evaluator.parser.parse(this.init);this.endExpr=b.evaluator.parser.parse(this.end)};a.extend(a.Arc,a.Graphic);a.Arc.prototype.update=function(){e=this.evaluator;f=e.evalExpression(this.center);this.exprX=f[0][0];this.exprY=f[0][1];c=0;this.rotateExp&&(c=a.degToRad(e.evalExpression(this.rotateExp)),b=Math.cos(c),k=Math.sin(c),g=this.exprX*
b-this.exprY*k,p=this.exprX*k+this.exprY*b,this.exprX=g,this.exprY=p);var d=e.evalExpression(this.initExpr),r=e.evalExpression(this.endExpr);"(expr)"==this.initExpr.type&&"(expr)"==this.endExpr.type||"[expr]"==this.initExpr.type&&"[expr]"==this.endExpr.type||"(expr)"==this.initExpr.type&&"[expr]"==this.endExpr.type||"[expr]"==this.initExpr.type&&"(expr)"==this.endExpr.type?(h=d[0][0],q=d[0][1],m=r[0][0],l=r[0][1],this.vectors?this.abs_coord&&(q=-q,l=-l):this.abs_coord?(h-=this.exprX,q=-q+this.exprY,
m-=this.exprX,l=-l+this.exprY):(h-=this.exprX,q-=this.exprY,m-=this.exprX,l-=this.exprY),s=0==h?0>q?-Math.PI/2:Math.PI/2:Math.acos(1*h/Math.sqrt(h*h+q*q)),t=0==m?0>l?-Math.PI/2:Math.PI/2:Math.acos(1*m/Math.sqrt(m*m+l*l)),s+=c,t+=c,0<h&&0<q&&this.abs_coord&&(s=2*Math.PI-s),0<h&&0>q&&!this.abs_coord&&(s=2*Math.PI-s),0>h&&0>q&&!this.abs_coord&&(s=2*Math.PI-s),0>h&&0<q&&this.abs_coord&&(s=2*Math.PI-s),0<m&&0<l&&this.abs_coord&&(t=2*Math.PI-t),0<m&&0>l&&!this.abs_coord&&(t=2*Math.PI-t),0>m&&0>l&&!this.abs_coord&&
(t=2*Math.PI-t),0>m&&0<l&&this.abs_coord&&(t=2*Math.PI-t),n=Math.min(s,t),u=Math.max(s,t),s=n,t=u,t-s>Math.PI&&this.abs_coord&&(s=u,t=n),t-s<=Math.PI&&!this.abs_coord&&(s=u,t=n),this.iniAng=s,this.endAng=t,this.drawPoints=!0):(this.iniAng=a.degToRad(d)+c,this.endAng=a.degToRad(r)+c,this.drawAngle=!0)};a.Arc.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Arc.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Arc.prototype.drawAux=function(a,
b,c){e=this.evaluator;r=this.space;y=e.evalExpression(this.radius);0>y&&(y=0);A=d(e.evalExpression(this.width));a.lineWidth=0<A?A:1E-6;a.lineCap="round";a.strokeStyle=c.getColor();this.drawAngle?(this.abs_coord?(v=d(this.exprX),w=d(this.exprY)):(v=d(r.getAbsoluteX(this.exprX)),w=d(r.getAbsoluteY(this.exprY)),y*=r.scale,this.iniAng=-this.iniAng,this.endAng=-this.endAng),this.iniAng>this.endAng&&(C=this.iniAng,this.iniAng=this.endAng,this.endAng=C)):this.drawPoints&&(this.abs_coord?(v=d(this.exprX),
w=d(this.exprY)):(v=d(r.getAbsoluteX(this.exprX)),w=d(r.getAbsoluteY(this.exprY)),y*=r.scale,this.iniAng=-this.iniAng,this.endAng=-this.endAng));this.fill&&(a.fillStyle=b.getColor(),a.beginPath(),a.moveTo(v,w),a.arc(v,w,y,this.iniAng,this.endAng,void 0),a.fill());a.beginPath();a.arc(v,w,y,this.iniAng,this.endAng,void 0);a.stroke();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,v+4,w-2,this.color,this.font,"start","alphabetic",e.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v;a.Text=function(b,c){this.width=b.evaluator.parser.parse("0");a.Graphic.call(this,b,c);this.align||(this.align="start");this.ascent=this.fontSize-Math.ceil(this.fontSize/7)-(this.font.match("Courier")?3:0);this.abs_coord=!0};a.extend(a.Text,a.Graphic);a.Text.prototype.update=function(){d=this.evaluator;e=d.evalExpression(this.expresion);this.exprX=e[0][0];this.exprY=e[0][1];this.rotateExp&&(f=a.degToRad(d.evalExpression(this.rotateExp)),
c=Math.cos(f),b=Math.sin(f),k=this.exprX*c-this.exprY*b,g=this.exprX*b+this.exprY*c,this.exprX=k,this.exprY=g)};a.Text.prototype.draw=function(){this.uber.draw.call(this,this.color)};a.Text.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.color)};a.Text.prototype.drawAux=function(a,b){v=this.evaluator.evalExpression(this.decimals);"rtfNode"===this.text.type?(m=this.text,this.ascent=0):m=this.splitText(this.text.toString(v,this.fixed).split("\\n"));this.text!=[""]&&this.uber.drawText.call(this,
a,m,parseInt(this.exprX)+5,parseInt(this.exprY)+this.ascent,b,this.font,this.align,"alphabetic",v,this.fixed)};a.Text.prototype.splitText=function(a){d=this.evaluator;p=d.evalExpression(this.width);m=[];this.ctx.font=this.font;if(20<=p&&"undefined"!=a.type){for(var b=0,c=a.length;b<c;b++)h=a[b],q=this.ctx.measureText(h).width,q>p?m=m.concat(this.splitWords(h,p)):m.push(h);l=Math.floor(1.2*this.fontSize)*m.length;d.setVariable("_Text_H_",l);return m}d.setVariable("_Text_H_",0);d.setVariable("_Text_W_",
1E3);return a};a.Text.prototype.splitWords=function(a,b){s=a;t=[];n="";r=0;for(var c,g=0,d=a.length;g<d;g++)u=s.charAt(g)," "===u&&(lastIndexOfWhite=g),n+=u,Math.round(this.ctx.measureText(n).width)>b&&(c=a.substring(r,g+1)," "!==u&&(-1===c.indexOf(" ")?(lastIndexOfWhite=g,g--):g=lastIndexOfWhite),t.push(a.substring(r,lastIndexOfWhite)),n="",r=g+1);t.push(a.substring(r));return t};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.round,e,f,c,b,k,g,p,h,q,m,l,s,t,n;
a.Image=function(b,c){this.file="";this.inirot=b.evaluator.parser.parse("0");a.Graphic.call(this,b,c);this.img=new Image;this.scaleY=this.scaleX=1;this.update()};a.extend(a.Image,a.Graphic);a.Image.prototype.update=function(){e=this.evaluator;f=e.evalExpression(this.expresion);this.exprX=f[0][0];this.exprY=f[0][1];this.rotateExp&&(c=a.degToRad(e.evalExpression(this.rotateExp)),b=Math.cos(c),k=Math.sin(c),g=this.exprX*b-this.exprY*k,p=this.exprX*k+this.exprY*b,this.exprX=g,this.exprY=p);4==f[0].length&&
(this.centered=!0,this.scaleX=f[0][2],0==this.scaleX&&(this.scaleX=1E-5),this.scaleY=f[0][3],0==this.scaleY&&(this.scaleY=1E-5));f[1]&&2==f[1].length&&(this.centered=!0,this.scaleX=f[1][0],0==this.scaleX&&(this.scaleX=1E-5),this.scaleY=f[1][1],0==this.scaleY&&(this.scaleY=1E-5));if((h=e.evalExpression(this.file))||""==h)this.img=this.parent.getImage(h)};a.Image.prototype.draw=function(){this.uber.draw.call(this)};a.Image.prototype.drawTrace=function(){this.uber.drawTrace.call(this)};a.Image.prototype.drawAux=
function(b){e=this.evaluator;q=this.space;this.img&&this.img.ready&&this.img.complete&&(m=this.centered?0:this.img.width/2,l=this.centered?0:this.img.height/2,s=this.abs_coord?d(this.exprX):d(q.getAbsoluteX(this.exprX)),t=this.abs_coord?d(this.exprY):d(q.getAbsoluteY(this.exprY)),n=a.degToRad(-e.evalExpression(this.inirot)),b.translate(s+m,t+l),b.rotate(n),b.scale(this.scaleX,this.scaleY),this.opacity&&(b.globalAlpha=e.evalExpression(this.opacity)),b.drawImage(this.img,-this.img.width/2,-this.img.height/
2),b.setTransform(1,0,0,1,0,0),b.globalAlpha=1)};return a}(descartesJS||{}),descartesJS=function(a){function d(a,b,c){p=4*(b+c*a.width);return{r:a.data[p],g:a.data[p+1],b:a.data[p+2],a:a.data[p+3]}}if(a.loadLib)return a;var e,f,c,b,k,g,p;a.Fill=function(b,c){a.Graphic.call(this,b,c)};a.extend(a.Fill,a.Graphic);a.Fill.prototype.update=function(){e=this.evaluator.evalExpression(this.expresion);this.exprX=e[0][0];this.exprY=e[0][1]};a.Fill.prototype.draw=function(){this.uber.draw.call(this,this.color,
this.color)};a.Fill.prototype.drawTrace=function(){};a.Fill.prototype.drawAux=function(a,e){e.getColor();imageData=this.ctx.getImageData(0,0,this.space.w,this.space.h);this.abs_coord?(f=parseInt(this.exprX),c=parseInt(this.exprY)):(f=parseInt(this.space.getAbsoluteX(this.exprX)),c=parseInt(this.space.getAbsoluteY(this.exprY)));if(!(0>f||0>c||f>=this.space.w||c>=this.space.h)){b=[{x:f,y:c}];for(g=d(imageData,f,c);0<b.length;){k=b.pop();f=k.x;c=k.y;var m=d(imageData,f,c);if(g.r===m.r&&g.g===m.g&&g.b===
m.b&&g.a===m.a){var m=imageData,l=e;p=4*(f+c*m.width);m.data[p+0]=l.r;m.data[p+1]=l.g;m.data[p+2]=l.b;m.data[p+3]=255-l.a;0<f&&b.push({x:f-1,y:c});f<imageData.width-1&&b.push({x:f+1,y:c});b.push({x:f,y:c-1});b.push({x:f,y:c+1})}}this.ctx.putImageData(imageData,0,0)}};return a}(descartesJS||{}),descartesJS=function(a,d){if(a.loadLib)return a;var e=/[\w\.\-//]*(\.png|\.jpg|\.gif|\.svg)/gi,f;a.Macro=function(c,b){this.hasExpresion=!1;this.inirot=c.evaluator.parser.parse("0");this.inipos=c.evaluator.parser.parse("(0,0)");
a.Graphic.call(this,c,b);for(var f in b)"expresion"==f&&(this.hasExpresion=!0),b.hasOwnProperty(f)&&(this[f]=b[f]);this.graphics=[];f=c.lessonParser;var g=new a.Tokenizer;if(this.hasExpresion){"'"!==this.expresion.charAt(0)&&(this.expresion="'"+this.expresion+"'");this.expresion=this.evaluator.parser.parse(this.expresion);var p=this.evaluator.evalExpression(this.expresion),h;p&&((h=document.getElementById(p))&&"descartes/macro"==h.type?h=h.text:(h=a.openExternalFile(p))&&!h.match(/tipo_de_macro/g)&&
(h=null));var q,m;if(h){m=h.replace(/&aacute;/g,"\u00e1").replace(/&eacute;/g,"\u00e9").replace(/&iacute;/g,"\u00ed").replace(/&oacute;/g,"\u00f3").replace(/&uacute;/g,"\u00fa").replace(/&Aacute;/g,"\u00c1").replace(/&Eacute;/g,"\u00c9").replace(/&Iacute;/g,"\u00cd").replace(/&Oacute;/g,"\u00d3").replace(/&Uacute;/g,"\u00da").replace(/&ntilde;/g,"\u00f1").replace(/&Ntilde;/g,"\u00d1").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&amp;/g,"&").replace(/\r/g,"").split("\n");h=[];for(var p=0,
l=m.length;p<l;p++)if(q=m[p].indexOf("="),-1!==q){q=f.split(m[p]);for(var s=0,t=q.length;s<t;s++)q[s]&&1<q.length&&("id"!==d[q[s][0]]&&"type"!==d[q[s][0]]||h.push(q))}for(var n,u,p=0,l=h.length;p<l;p++)for(t=(s=h[p]||[])&&s[0]&&"id"===s[0][0],m=0,q=s.length;m<q;m++)if(n=s[m][0].indexOf("."),-1===n||t?n=d[s[m][0]]:(n=d[s[m][0].substring(n+1)],s[m][0]=this.name+"."+s[m][0]),!("font"===n||("fill"===n||"color"===n||"arrow"===n)&&"("!==s[m][1].charAt(0)||"file"===n&&s[m][1].match(e)||"id"!==n&&void 0!==
d[s[m][1]]))if("text"==n)if(s[m][1].match(/\{\\rtf1/)){n=s[m][1];var r=this;u=function(a,b){for(var c=g.tokenize(b.replace(/\&squot;/g,"'")),d=0,f=c.length;d<f;d++)"identifier"!=c[d].type||"-rnd-pi-e-sqr-ra\u00edz-sqrt-exp-log-log10-abs-ent-sgn-ind-sen-sin-cos-tan-cot-sec-csc-senh-sinh-cosh-tanh-coth-sech-csch-asen-asin-acos-atan-min-max-_Num_-_Trace_-_Stop_Audios_-esCorrecto-escorrecto-_GetValues_-_GetMatrix_-_Save_-_Open_-_SaveState_-_OpenState_-_AnchoDeCadena_-_Rojo_-_Verde_-_Azul_-".match("-"+
c[d].value+"-")||(c[d].value=r.name+"."+c[d].value);return(a.match(/^\\expr/)?"\\expr ":"\\decimals ")+g.flatTokens(c)};n=n.replace(/\\expr ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.'\+\-]*)/gi,u);n=n.replace(/\\decimals ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.'\+\-]*)/gi,u);s[m][1]=n}else{u=f.parseText(s[m][1]).textElementsMacros;for(var v=0,w=u.length;v<w;v++){n=g.tokenize(u[v].replace(/\&squot;/g,"'"));for(var y=0,C=n.length;y<C;y++)"identifier"!==n[y].type||"-rnd-pi-e-sqr-ra\u00edz-sqrt-exp-log-log10-abs-ent-sgn-ind-sen-sin-cos-tan-cot-sec-csc-senh-sinh-cosh-tanh-coth-sech-csch-asen-asin-acos-atan-min-max-_Num_-_Trace_-_Stop_Audios_-esCorrecto-escorrecto-_GetValues_-_GetMatrix_-_Save_-_Open_-_SaveState_-_OpenState_-_AnchoDeCadena_-_Rojo_-_Verde_-_Azul_-".match("-"+
n[y].value+"-")||(n[y].value=this.name+"."+n[y].value);n=g.flatTokens(n).replace(/&squot;/g,"'").replace(/'\+\(/g,"[").replace(/\)\+'/g,"]");u[v]=n.substring(1,n.length-1)}s[m][1]=u.join("")}else{u=s[m][1].replace(/\&squot;/g,"'").split(";");v=0;for(w=u.length;v<w;v++){n=g.tokenize(u[v]);y=0;for(C=n.length;y<C;y++)"identifier"!==n[y].type||"-rnd-pi-e-sqr-ra\u00edz-sqrt-exp-log-log10-abs-ent-sgn-ind-sen-sin-cos-tan-cot-sec-csc-senh-sinh-cosh-tanh-coth-sech-csch-asen-asin-acos-atan-min-max-_Num_-_Trace_-_Stop_Audios_-esCorrecto-escorrecto-_GetValues_-_GetMatrix_-_Save_-_Open_-_SaveState_-_OpenState_-_AnchoDeCadena_-_Rojo_-_Verde_-_Azul_-".match("-"+
n[y].value+"-")||(n[y].value=this.name+"."+n[y].value);u[v]=g.flatTokens(n)}s[m][1]=u.join(";")}p=0;for(l=h.length;p<l;p++)if(h[p][0]){s="";t=!1;m=0;for(q=h[p].length;m<q;m++)"type"===d[h[p][m][0]]&&(s="espacio='"+this.spaceID+"' ",t=!0),s=s+h[p][m][0]+"='"+h[p][m][1]+"' ";h[p]=s;t?this.graphics.push(f.parseGraphic(h[p],this.abs_coord,this.background,this.inirot)):f.parseAuxiliar(h[p])}}}};a.extend(a.Macro,a.Graphic);a.Macro.prototype.update=function(){f=this.evaluator.evalExpression(this.inipos);
this.iniPosX=f[0][0];this.iniPosY=f[0][1]};a.Macro.prototype.drawAux=function(a){for(var b=0,d=this.graphics.length;b<d;b++)this.graphics[b]&&(this.graphics[b].abs_coord?a.translate(this.iniPosX,this.iniPosY):a.translate(this.iniPosX*this.space.scale,-this.iniPosY*this.space.scale),this.graphics[b].draw(),a.setTransform(1,0,0,1,0,0))};return a}(descartesJS||{},babel),descartesJS=function(a){if(a.loadLib)return a;a.Generic=function(d,e){this.width=d.evaluator.parser.parse("1");a.Graphic.call(this,
d,e)};a.extend(a.Generic,a.Graphic);a.Generic.prototype.update=function(){};a.Generic.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Generic.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Generic.prototype.drawAux=function(a,e,f){var c=this.evaluator.getDefinition(this.expresionString);c&&c.draw(a,e,f,this)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.sqrt,e=Math.sin,f=Math.cos,c,b,k,g,p,h,
q,m,l,s,t,n,u,r,v;a.norm3D=function(a){return d(a.x*a.x+a.y*a.y+a.z*a.z)};a.normalize3D=function(b){c=a.norm3D(b);if(0===c)return{x:0,y:0,z:0};if(1===c)return{x:b.x,y:b.y,z:b.z};c=1/c;return{x:b.x*c,y:b.y*c,z:b.z*c}};a.dotProduct3D=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};a.crossProduct3D=function(a,b){return{x:a.y*b.z-a.z*b.y,y:a.z*b.x-a.x*b.z,z:a.x*b.y-a.y*b.x}};a.scalarProduct3D=function(a,b){return{x:a.x*b,y:a.y*b,z:a.z*b}};a.subtract3D=function(a,b){return{x:a.x-b.x,y:a.y-b.y,z:a.z-b.z}};
a.add3D=function(a,b){return{x:a.x+b.x,y:a.y+b.y,z:a.z+b.z}};a.equals3DEpsilon=function(a,b,c){return Math.abs(a.x-b.x)<=c&&Math.abs(a.y-b.y)<=c&&Math.abs(a.z-b.z)<=c};a.Vector4D=function(a,b,c,g){this.x=a||0;this.y=b||0;this.z=c||0;this.w=g||0};a.Matrix4x4=function(a,b,c,g,d,f,e,k,h,p,m,n,q,r,l,s){this.a00=a||0;this.a01=b||0;this.a02=c||0;this.a03=g||0;this.a10=d||0;this.a11=f||0;this.a12=e||0;this.a13=k||0;this.a20=h||0;this.a21=p||0;this.a22=m||0;this.a23=n||0;this.a30=q||0;this.a31=r||0;this.a32=
l||0;this.a33=s||0};a.Matrix4x4.prototype.setIdentity=function(){this.a00=1;this.a10=this.a03=this.a02=this.a01=0;this.a11=1;this.a21=this.a20=this.a13=this.a12=0;this.a22=1;this.a32=this.a31=this.a30=this.a23=0;this.a33=1;return this};a.Matrix4x4.prototype.multiplyVector4=function(b){return new a.Vector4D(b.x*this.a00+b.y*this.a10+b.z*this.a20+b.w*this.a30,b.x*this.a01+b.y*this.a11+b.z*this.a21+b.w*this.a31,b.x*this.a02+b.y*this.a12+b.z*this.a22+b.w*this.a32,b.x*this.a03+b.y*this.a13+b.z*this.a23+
b.w*this.a33)};a.Matrix4x4.prototype.translate=function(b){return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a00*b.x+this.a10*b.y+this.a20*b.z+this.a30,this.a01*b.x+this.a11*b.y+this.a21*b.z+this.a31,this.a02*b.x+this.a12*b.y+this.a22*b.z+this.a32,this.a03*b.x+this.a13*b.y+this.a23*b.z+this.a33)};a.Matrix4x4.prototype.rotateX=function(c){b=e(c);k=f(c);m=this.a10;l=this.a11;s=this.a12;t=this.a13;n=this.a20;u=this.a21;
r=this.a22;v=this.a23;return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,m*k+n*b,l*k+u*b,s*k+r*b,t*k+v*b,m*-b+n*k,l*-b+u*k,s*-b+r*k,t*-b+v*k,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateY=function(c){b=e(c);k=f(c);g=this.a00;p=this.a01;h=this.a02;q=this.a03;n=this.a20;u=this.a21;r=this.a22;v=this.a23;return new a.Matrix4x4(g*k+n*-b,p*k+u*-b,h*k+r*-b,q*k+v*-b,this.a10,this.a11,this.a12,this.a13,g*b+n*k,p*b+u*k,h*b+r*k,q*b+v*k,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateZ=
function(c){b=e(c);k=f(c);g=this.a00;p=this.a01;h=this.a02;q=this.a03;m=this.a10;l=this.a11;s=this.a12;t=this.a13;return new a.Matrix4x4(g*k+m*b,p*k+l*b,h*k+s*b,q*k+t*b,g*-b+m*k,p*-b+l*k,h*-b+s*k,q*-b+t*k,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33)};return a}(descartesJS||{}),descartesJS=function(a){function d(a){0!==parseInt(this.size)&&(a.lineWidth=1,a.fillStyle=this.backColor,a.strokeStyle=this.frontColor,a.beginPath(),a.arc(this.newV[0].x,this.newV[0].y,this.size+
0.5,0,k),a.fill(),a.stroke())}function e(a,b){a.lineCap=g;a.lineJoin=p;a.lineWidth=1;a.beginPath();a.moveTo(this.newV[0].x,this.newV[0].y);for(var c=1,d=this.newV.length;c<d;c++)a.lineTo(this.newV[c].x,this.newV[c].y);a.closePath();"color"===this.model?(a.fillStyle=0<=this.direction?this.backColor:this.frontColor,a.strokeStyle=a.fillStyle,a.stroke(),a.fill()):"light"===this.model||"metal"===this.model?(a.fillStyle=0<=this.direction?b.computeColor(this.backColor,this,"metal"===this.model):b.computeColor(this.frontColor,
this,"metal"===this.model),a.strokeStyle=a.fillStyle,a.stroke(),a.fill()):"wire"===this.model&&(a.lineWidth=1.5,a.strokeStyle=this.frontColor,a.stroke());this.edges&&"wire"!==this.model&&(a.strokeStyle="#808080",a.stroke())}function f(a){t=this.evaluator.getVariable(this.family);this.evaluator.setVariable(this.family,this.familyValue);this.drawText(a,this.text,this.newV[0].x,this.newV[0].y+this.displace,this.frontColor,this.font,"left","alphabetic",this.decimals,this.fixed,!0);this.evaluator.setVariable(this.family,
t)}function c(a){a.lineCap=g;a.lineJoin=p;a.lineWidth=this.lineWidth;a.strokeStyle=this.frontColor;a.beginPath();a.moveTo(this.newV[0].x,this.newV[0].y);a.lineTo(this.newV[1].x,this.newV[1].y);a.stroke()}function b(b,c,g){h=a.subtract3D(b,c);q=a.subtract3D(b,g);return a.normalize3D(a.crossProduct3D(h,q))}if(a.loadLib)return a;var k=2*Math.PI,g="round",p="round",h,q,m,l,s,t;a.Primitive3D=function(a,g){this.space=g;for(var k in a)a.hasOwnProperty(k)&&(this[k]=a[k]);this.newV=[];this.spaceVertices=[];
"vertex"===this.type?this.draw=d:"face"===this.type?(this.normal=b(this.vertices[0],this.vertices[1],this.vertices[2]),this.draw=e):"text"===this.type?(this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?parseInt(this.fontSize[1]):10,this.draw=f):"edge"===this.type&&(this.draw=c);this.isText&&(this.computeDepth=function(){this.newV=this.vertices;this.depth=this.vertices[0].z;this.average=this.vertices[0]})};a.Primitive3D.prototype.computeDepth=function(c){this.average={x:0,y:0,z:0};this.removeDoubles();
this.normal={x:0,y:1,z:0};this.direction={x:1,y:0,z:0};for(var g=0,d=this.vertices.length;g<d;g++)this.newV[g]=c.rotateVertex(this.vertices[g]),this.spaceVertices[g]=c.rotateVertex(this.vertices[g]),this.average.x+=this.newV[g].x,this.average.y+=this.newV[g].y,this.average.z+=this.newV[g].z;this.average=a.scalarProduct3D(this.average,1/d);this.averageP=c.project(this.average);this.depth=this.averageP.z;2<this.vertices.length&&(this.normal=b(this.newV[0],this.newV[1],this.newV[2]),this.direction=a.dotProduct3D(this.normal,
a.normalize3D(c.eye)));g=0;for(d=this.vertices.length;g<d;g++)this.newV[g]=c.project(this.newV[g])};var n;a.Primitive3D.prototype.removeDoubles=function(){if("edge"!==this.type){n=[];for(var a=0,b=this.vertices.length;a<b;a++)this.vertices[a].x===this.vertices[(a+1)%b].x&&this.vertices[a].y===this.vertices[(a+1)%b].y&&this.vertices[a].z===this.vertices[(a+1)%b].z&&this.vertices[a].w===this.vertices[(a+1)%b].w||n.push(this.vertices[a]);0===n.length&&n.push(this.vertices[0]);this.vertices=n}};a.Primitive3D.prototype.drawText=
function(b,c,g,d,f,k,e,h,p,n,q){if("rtfNode"==c.type)b.fillStyle=f,b.strokeStyle=f,b.textBaseline="alphabetic",c.draw(b,g,d,p,n,e,q);else for("simpleText"===c.type&&(c=c.toString(p,n).split("\\n")),g+=k.match("Arial")?-2:k.match("Times")?-2:0,m=this.evaluator,b.fillStyle=a.getColor(m,f),b.font=k,b.textAlign=e,b.textBaseline=h,l=1.2*this.fontSize||0,f=0,k=c.length;f<k;f++)s=c[f],this.border&&b.strokeText(s,g,d+l*f),b.fillText(s,g,d+l*f)};a.Primitive3D.prototype.splitFace=function(b){if(this.intersects(b)){for(var c=
null,g=null,d=0,f=0,k=0,e=b.vertices.length;k<e;k++){var h=this.intersection(b.vertices[k],b.vertices[(k+1)%e]);if(null!==h)if(null===c){if(c=h,d=k,2===b.vertices.length){g=c;break}}else if(!a.equals3DEpsilon(h,c,1E-8)){g=h;f=k;break}}if(null!==c&&null!==g){var k=this.isInterior(c)||this.isInterior(g),p=null,m=null;if(!k&&3<=b.vertices.length)for(var e=0,n=this.vertices.length;e<n;e++)if(h=b.intersection(this.vertices[e],this.vertices[(e+1)%n]),null!==h)if(null===p)p=h;else if(!a.equals3DEpsilon(h,
p,1E-8)){m=h;break}if(k||null!==p&&null!==m&&b.isInterior(p)&&b.isInterior(m)){m=!0;n=b.vertices;p=h=null;if(2===n.length)a.equals(c,n[0],1E-8)||a.equals(c,n[1],1E-8)?m=!1:(h=[],h[0]=n[0],h[1]=c,p=[],p[0]=c,p[1]=n[1]);else for(var h=[],p=[],q=0,k=e=0;k<n.length;k++)k<d?h[q++]=n[k]:k==d?(h[q++]=n[k],h[q++]=c,p[e++]=c):k<f?p[e++]=n[k]:k==f?(p[e++]=n[k],p[e++]=g,h[q++]=g):h[q++]=n[k];if(m)return c=[],c[0]=new a.Primitive3D({vertices:h,type:"face",frontColor:b.frontColor,backColor:b.backColor,edges:b.edges,
model:b.model},this.space),c[0].normal=b.normal,c[1]=new a.Primitive3D({vertices:p,type:"face",frontColor:b.frontColor,backColor:b.backColor,edges:b.edges,model:b.model},this.space),c[1].normal=b.normal,c}}}return[b]};a.Primitive3D.prototype.intersects=function(a){return this.intersectsPlane(a)&&a.intersectsPlane(this)};a.Primitive3D.prototype.intersectsPlane=function(b){var c=a.dotProduct3D(b.vertices[0],b.normal),g=a.dotProduct3D(this.vertices[0],b.normal);if(1E-8>Math.abs(c-g))return!0;for(var d=
1,f=this.vertices.length;d<f;d++){var k=a.dotProduct3D(this.vertices[d],b.normal);if(1E-8>Math.abs(c-k)||k>c&&g<c||k<c&&g>c)return!0}return!1};a.Primitive3D.prototype.intersection=function(b,c){if(0<this.vertices.length){var g=a.subtract3D(c,b),d=a.dotProduct3D(g,this.normal);if(0!==d&&(d=a.dotProduct3D(a.subtract3D(this.vertices[0],b),this.normal)/d,-1E-8<d&&1.00000001>d))return a.add3D(b,a.scalarProduct3D(g,d))}return null};a.Primitive3D.prototype.isInterior=function(b){if(0<this.vertices.length)for(var c=
0,g=a.subtract3D(this.vertices[0],b),d=0,f=this.vertices.length;d<f;d++){var k=a.subtract3D(this.vertices[(d+1)%f],b),e=a.dotProduct3D(a.crossProduct3D(g,k),this.normal);if(1E-8>Math.abs(e)){if(0>a.dotProduct3D(g,k))break}else{if(0>c&&0<e||0<c&&0>e)return!1;g=k;c=e}}return!0};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d={x:0,y:0,z:0},e,f,c,b,k,g,p,h;a.Graphic3D=function(b,c){this.parent=b;this.evaluator=b.evaluator;var g=b.evaluator.parser;this.spaceID="E0";this.background=
!1;this.type="";this.color=new a.Color("eeffaa");this.backcolor=new a.Color("6090a0");this.Nu=this.evaluator.parser.parse("7");this.Nv=this.evaluator.parser.parse("7");this.drawif=g.parse("1");this.abs_coord=!1;this.family="";this.family_interval=g.parse("[0,1]");this.family_steps=g.parse("8");this.font="Monospaced,PLAIN,12";this.fixed=!0;this.text="";this.decimals=g.parse("2");this.inirot="(0,0,0)";this.inirotEuler=!1;this.inipos=g.parse("(0,0,0)");this.endrot="(0,0,0)";this.endrotEuler=!1;this.endpos=
g.parse("(0,0,0)");this.model="color";for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);void 0==this.expresion&&"macro"!=this.type&&(this.expresion=g.parse("(0,0)"));this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.font=a.convertFont(this.font);this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?parseInt(this.fontSize[1]):10;this.inirot.match("Euler")&&(this.inirot=this.inirot.replace("Euler",""),
this.inirotEuler=!0);this.endrot.match("Euler")&&(this.endrot=this.endrot.replace("Euler",""),this.endrotEuler=!0);this.inirot=g.parse(this.inirot);this.endrot=g.parse(this.endrot);this.inirotM=new a.Matrix4x4;this.inirotM_X=new a.Matrix4x4;this.inirotM_Y=new a.Matrix4x4;this.inirotM_Z=new a.Matrix4x4;this.iniposM=new a.Matrix4x4;this.endrotM=new a.Matrix4x4;this.endrotM_X=new a.Matrix4x4;this.endrotM_Y=new a.Matrix4x4;this.endrotM_Z=new a.Matrix4x4;this.endposM=new a.Matrix4x4};a.Graphic3D.prototype.getSpace=
function(){for(var a=this.parent.spaces,b,c=0,g=a.length;c<g;c++)if(b=a[c],b.id==this.spaceID)return b;return a[0]};a.Graphic3D.prototype.getFamilyValues=function(){e=this.evaluator;f=e.evalExpression(this.family_interval);this.familyInf=f[0][0];this.familySup=f[0][1];this.fSteps=Math.round(e.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic3D.prototype.buildFamilyPrimitives=function(){e=this.evaluator;this.getFamilyValues();
c=e.getVariable(this.family);if(0<=this.fSteps)for(var a=0,b=this.fSteps;a<=b;a++)e.setVariable(this.family,this.familyInf+a*this.family_sep),this.familyValue=this.familyInf+a*this.family_sep,e.evalExpression(this.drawif)&&this.buildPrimitives();e.setVariable(this.family,c)};a.Graphic3D.prototype.update=function(){this.primitives=[];this.evaluator.evalExpression(this.drawif)&&(this.family||this.buildPrimitives());this.family&&this.buildFamilyPrimitives()};a.Graphic3D.prototype.updateMVMatrix=function(){k=
this.evaluator.evalExpression(this.inirot);this.inirotEuler?(this.inirotM=this.inirotM.setIdentity(),this.inirotM=this.inirotM.rotateZ(a.degToRad(k[0][0])),this.inirotM=this.inirotM.rotateX(a.degToRad(k[0][1])),this.inirotM=this.inirotM.rotateZ(a.degToRad(k[0][2]))):(this.inirotM_X=this.inirotM_X.setIdentity().rotateX(a.degToRad(k[0][0])),this.inirotM_Y=this.inirotM_Y.setIdentity().rotateY(a.degToRad(k[0][1])),this.inirotM_Z=this.inirotM_Z.setIdentity().rotateZ(a.degToRad(k[0][2])));k=this.evaluator.evalExpression(this.inipos);
d={x:k[0][0],y:k[0][1],z:k[0][2]};this.iniposM=this.iniposM.setIdentity().translate(d);k=this.evaluator.evalExpression(this.endrot);this.endrotEuler?(this.endrotM=this.endrotM.setIdentity(),this.endrotM=this.endrotM.rotateZ(a.degToRad(k[0][0])),this.endrotM=this.endrotM.rotateX(a.degToRad(k[0][1])),this.endrotM=this.endrotM.rotateZ(a.degToRad(k[0][2]))):(this.endrotM_X=this.endrotM_X.setIdentity().rotateX(a.degToRad(k[0][0])),this.endrotM_Y=this.endrotM_Y.setIdentity().rotateY(a.degToRad(k[0][1])),
this.endrotM_Z=this.endrotM_Z.setIdentity().rotateZ(a.degToRad(k[0][2])));k=this.evaluator.evalExpression(this.endpos);d={x:k[0][0],y:k[0][1],z:k[0][2]};this.endposM=this.endposM.setIdentity().translate(d)};a.Graphic3D.prototype.transformVertex=function(a){this.macroChildren&&(a=this.applyMacroTransform(a));this.inirotEuler?b=this.inirotM.multiplyVector4(a):(b=this.inirotM_X.multiplyVector4(a),b=this.inirotM_Y.multiplyVector4(b),b=this.inirotM_Z.multiplyVector4(b));b=this.iniposM.multiplyVector4(b);
this.endrotEuler?b=this.endrotM.multiplyVector4(b):(b=this.endrotM_X.multiplyVector4(b),b=this.endrotM_Y.multiplyVector4(b),b=this.endrotM_Z.multiplyVector4(b));return b=this.endposM.multiplyVector4(b)};a.Graphic3D.prototype.applyMacroTransform=function(a){this.macro_inirotEuler?b=this.macro_inirotM.multiplyVector4(a):(b=this.macro_inirotM_X.multiplyVector4(a),b=this.macro_inirotM_Y.multiplyVector4(b),b=this.macro_inirotM_Z.multiplyVector4(b));b=this.macro_iniposM.multiplyVector4(b);this.macro_endrotEuler?
b=this.macro_endrotM.multiplyVector4(b):(b=this.macro_endrotM_X.multiplyVector4(b),b=this.macro_endrotM_Y.multiplyVector4(b),b=this.macro_endrotM_Z.multiplyVector4(b));return b=this.macro_endposM.multiplyVector4(b)};a.Graphic3D.prototype.parseExpression=function(){k=this.expresion.replace(/\n/g," ").replace(/ ( )+/g," ").split("=");g=k[0];p=[];for(var a=[],b,c=0,d=k.length;c<d;c++)h=k[c].lastIndexOf(" "),-1!==h?(a.push(k[c].substring(0,h)),a.push(k[c].substring(h+1))):a.push(k[c]);for(var f=[],c=
0,d=a.length;c<d;c++)"x"==a[c]||"y"==a[c]||"z"==a[c]?(f.push(a[c]),f.push("")):(b=f.length-1,f[b]=f[b]+(""==f[b]?"":"=")+a[c]);for(c=0;3>c;c++)g=f[2*c]+"="+f[2*c+1],p.push(this.evaluator.parser.parse(g,!0));return p};var q;a.Graphic3D.prototype.splitFace=function(a){for(var b=0,c=this.primitives.length;b<c;b++)if(q=[],"face"===this.primitives[b].type){for(var g=0,d=a.primitives.length;g<d;g++)"face"===a.primitives[g].type?q=q.concat(this.primitives[b].splitFace(a.primitives[g])):q.push(a.primitives[g]);
a.primitives=q}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b;a.Point3D=function(b,c){a.Graphic3D.call(this,b,c)};a.extend(a.Point3D,a.Graphic3D);a.Point3D.prototype.buildPrimitives=function(){d=this.evaluator;this.updateMVMatrix();e=d.evalExpression(this.expresion);f=e[0][0];c=e[0][1];b=e[0][2];this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(f,c,b,1))],type:"vertex",backColor:this.backcolor.getColor(),frontColor:this.color.getColor(),
size:d.evalExpression(this.width)}));""!==this.text&&this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(f,c,b,1))],type:"text",frontColor:this.color.getColor(),font:this.font,decimals:d.evalExpression(this.decimals),fixed:this.fixed,displace:this.fontSize,evaluator:d,text:this.text,family:this.family,familyValue:this.familyValue},this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g;a.Segment3D=function(b,c){this.width=
b.evaluator.parser.parse("1");a.Graphic3D.call(this,b,c)};a.extend(a.Segment3D,a.Graphic3D);a.Segment3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();g=evaluator.getVariable("u");evaluator.setVariable("u",this.Nu);expr=evaluator.evalExpression(this.expresion);d=expr[0][0];e=expr[0][1];f=expr[0][2];c=expr[1][0];b=expr[1][1];k=expr[1][2];this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(d,e,f,1)),this.transformVertex(new a.Vector4D(c,
b,k,1))],type:"edge",frontColor:this.color.getColor(),lineWidth:evaluator.evalExpression(this.width)},this.space));evaluator.setVariable("u",g)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g;a.Surface3D=function(b,c){this.parameter="t";this.parameter_interval=b.evaluator.parser.parse("[0,1]");this.parameter_steps=b.evaluator.parser.parse("8");a.Graphic3D.call(this,b,c);this.expresion=this.parseExpression()};a.extend(a.Surface3D,a.Graphic3D);a.Surface3D.prototype.buildPrimitives=
function(){d=this.evaluator;this.updateMVMatrix();f=d.getVariable("x");f=d.getVariable("y");f=d.getVariable("z");e=d.getVariable("u");f=d.getVariable("v");d.setVariable("u",0);d.setVariable("v",0);c=d.evalExpression(this.Nu);b=d.evalExpression(this.Nv);k=[];for(var p=0;p<=c;p++){d.setVariable("u",p/c);for(var h=0;h<=b;h++){d.setVariable("v",h/b);for(var q=0,m=this.expresion.length;q<m;q++)d.evalExpression(this.expresion[q]);k.push(this.transformVertex(new a.Vector4D(d.getVariable("x"),d.getVariable("y"),
d.getVariable("z"),1)))}}for(p=0;p<c;p++)for(h=0;h<b;h++)g=[],g.push(k[h+p*b+p]),g.push(k[h+1+p*b+p]),g.push(k[h+2+(p+1)*b+p]),g.push(k[h+1+(p+1)*b+p]),this.primitives.push(new a.Primitive3D({vertices:g,type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space));d.setVariable("x",void 0);d.setVariable("y",void 0);d.setVariable("z",void 0);d.setVariable("u",e);d.setVariable("v",f)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d,e,f,c,b,k;a.Polygon3D=function(b,c){this.width=b.evaluator.parser.parse("1");a.Graphic3D.call(this,b,c)};a.extend(a.Polygon3D,a.Graphic3D);a.Polygon3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);for(var g=0,p=expr.length-1;g<p;g++)d=expr[g][0],e=expr[g][1],f=expr[g][2],c=expr[g+1][0],b=expr[g+1][1],k=expr[g+1][2],this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(d,e,f,1)),
this.transformVertex(new a.Vector4D(c,b,k,1))],type:"edge",frontColor:this.color.getColor(),lineWidth:evaluator.evalExpression(this.width)},this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k;a.Curve3D=function(b,c){this.width=b.evaluator.parser.parse("1");a.Graphic3D.call(this,b,c);this.expresion=this.parseExpression()};a.extend(a.Curve3D,a.Graphic3D);a.Curve3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();c=
evaluator.getVariable("x");b=evaluator.getVariable("y");k=evaluator.getVariable("z");f=evaluator.getVariable("u");evaluator.setVariable("u",0);e=evaluator.evalExpression(this.Nu);d=[];for(var g=0;g<=e;g++){evaluator.setVariable("u",g/e);for(var p=0,h=this.expresion.length;p<h;p++)evaluator.evalExpression(this.expresion[p]);d.push(this.transformVertex(new a.Vector4D(evaluator.getVariable("x"),evaluator.getVariable("y"),evaluator.getVariable("z"),1)))}g=0;for(p=d.length-1;g<p;g++)this.primitives.push(new a.Primitive3D({vertices:[d[g],
d[g+1]],type:"edge",frontColor:this.color.getColor(),lineWidth:evaluator.evalExpression(this.width)},this.space));evaluator.setVariable("x",c);evaluator.setVariable("y",k);evaluator.setVariable("z",b);evaluator.setVariable("u",f)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g,p,h;a.Triangle3D=function(b,c){a.Graphic3D.call(this,b,c)};a.extend(a.Triangle3D,a.Graphic3D);a.Triangle3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();
expr=evaluator.evalExpression(this.expresion);d=expr[0][0];e=expr[0][1];f=expr[0][2];c=expr[1][0];b=expr[1][1];k=expr[1][2];g=expr[2][0];p=expr[2][1];h=expr[2][2];this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(d,e,f,1)),this.transformVertex(new a.Vector4D(g,p,h,1)),this.transformVertex(new a.Vector4D(c,b,k,1))],type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space))};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var d;a.Face3D=function(d,f){a.Graphic3D.call(this,d,f)};a.extend(a.Face3D,a.Graphic3D);a.Face3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);d=[];for(var e=expr.length-1;0<=e;e--)d.push(this.transformVertex(new a.Vector4D(expr[e][0],expr[e][1],expr[e][2],1)));this.primitives.push(new a.Primitive3D({vertices:d,type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),
edges:this.edges,model:this.model},this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b;a.Polireg3D=function(b,c){this.width=b.evaluator.parser.parse("2");this.length=b.evaluator.parser.parse("2");a.Graphic3D.call(this,b,c)};a.extend(a.Polireg3D,a.Graphic3D);a.Polireg3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();d=evaluator.evalExpression(this.Nu);e=[this.transformVertex(new a.Vector4D(0,0,0,1))];f=evaluator.evalExpression(this.width)/
2;c=evaluator.evalExpression(this.length)/2;b=2*Math.PI/d;for(var k=0;k<d;k++)e.push(this.transformVertex(new a.Vector4D(f*Math.cos(b*k),c*Math.sin(b*k),0,1)));for(k=0;k<d;k++)this.primitives.push(new a.Primitive3D({vertices:[e[0],k+2<=d?e[k+2]:e[1],e[k+1]],type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c;a.Text3D=function(b,c){a.Graphic3D.call(this,
b,c)};a.extend(a.Text3D,a.Graphic3D);a.Text3D.prototype.buildPrimitives=function(){d=this.evaluator;e=d.evalExpression(this.expresion);f=e[0][0];c=e[0][1];this.primitives.push(new a.Primitive3D({vertices:[new a.Vector4D(f,c,0,1)],type:"text",frontColor:this.color.getColor(),font:this.font,decimals:d.evalExpression(this.decimals),fixed:this.fixed,displace:0,isText:!0,evaluator:d,text:this.text,family:this.family,familyValue:this.familyValue,joel:"hola"},this.space))};return a}(descartesJS||{}),descartesJS=
function(a,d){if(a.loadLib)return a;var e=/[\w\.\-//]*(\.png|\.jpg|\.gif|\.svg)/gi,f,c;a.Macro3D=function(b,c){this.expresion=void 0;this.inirot="(0,0,0)";this.inirotEuler=!1;this.inipos=b.evaluator.parser.parse("(0,0,0)");this.endrot="(0,0,0)";this.endrotEuler=!1;this.endpos=b.evaluator.parser.parse("(0,0,0)");a.Graphic.call(this,b,c);for(var g in c)c.hasOwnProperty(g)&&(this[g]=c[g]);this.inirot.match("Euler")&&(this.inirot=this.inirot.replace("Euler",""),this.inirotEuler=!0);this.endrot.match("Euler")&&
(this.endrot=this.endrot.replace("Euler",""),this.endrotEuler=!0);this.inirot=this.evaluator.parser.parse(this.inirot);this.endrot=this.evaluator.parser.parse(this.endrot);this.inirotM=new a.Matrix4x4;this.inirotM_X=new a.Matrix4x4;this.inirotM_Y=new a.Matrix4x4;this.inirotM_Z=new a.Matrix4x4;this.iniposM=new a.Matrix4x4;this.endrotM=new a.Matrix4x4;this.endrotM_X=new a.Matrix4x4;this.endrotM_Y=new a.Matrix4x4;this.endrotM_Z=new a.Matrix4x4;this.endposM=new a.Matrix4x4;this.graphics=[];g=b.lessonParser;
var f=new a.Tokenizer;if(void 0!=this.expresion){"'"!==this.expresion.charAt(0)&&(this.expresion="'"+this.expresion+"'");this.expresion=this.evaluator.parser.parse(this.expresion);var h=this.evaluator.evalExpression(this.expresion),q;h&&((q=document.getElementById(h))&&"descartes/macro"==q.type?q=q.text:(q=a.openExternalFile(h))&&!q.match(/tipo_de_macro/g)&&(q=null));var m,l;if(q){l=q.replace(/&aacute;/g,"\u00e1").replace(/&eacute;/g,"\u00e9").replace(/&iacute;/g,"\u00ed").replace(/&oacute;/g,"\u00f3").replace(/&uacute;/g,
"\u00fa").replace(/&Aacute;/g,"\u00c1").replace(/&Eacute;/g,"\u00c9").replace(/&Iacute;/g,"\u00cd").replace(/&Oacute;/g,"\u00d3").replace(/&Uacute;/g,"\u00da").replace(/&ntilde;/g,"\u00f1").replace(/&Ntilde;/g,"\u00d1").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&amp;/g,"&").replace(/\r/g,"").split("\n");q=[];for(var h=0,s=l.length;h<s;h++)m=l[h].indexOf("="),-1!==m&&(m=l[h].substring(0,m),"id"!==d[m]&&"type"!==d[m]||q.push(g.split(l[h])));for(var t,n,u,r,h=0,s=q.length;h<s;h++)for(r=(t=
q[h]||[])&&t[0]&&"id"===t[0][0],l=0,m=t.length;l<m;l++)if(n=t[l][0].indexOf("."),-1===n||r?n=d[t[l][0]]:(n=d[t[l][0].substring(n+1)],t[l][0]=this.name+"."+t[l][0]),!("font"===n||("fill"===n||"color"===n||"backcolor"===n||"arrow"===n)&&"("!==t[l][1].charAt(0)||"file"===n&&t[l][1].match(e)||"id"!==n&&void 0!==d[t[l][1]])||"width"===n||"height"===n||"length"===n)if("text"==n)if(t[l][1].match(/\{\\rtf1/)){n=t[l][1];var v=this;u=function(a,b){for(var c=f.tokenize(b.replace(/\&squot;/g,"'")),g=0,d=c.length;g<
d;g++)"identifier"!=c[g].type||"-rnd-pi-e-sqr-sqrt-ra\u00edz-exp-log-log10-abs-ent-sgn-ind-sin-sen-cos-tan-cot-sec-csc-sinh-senh-cosh-tanh-coth-sech-csch-asin-asen-acos-atan-min-max-".match("-"+c[g].value+"-")||(c[g].value=v.name+"."+c[g].value);return(a.match(/^\\expr/)?"\\expr ":"\\decimals ")+f.flatTokens(c)};n=n.replace(/\\expr ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,u);n=n.replace(/\\decimals ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,u);t[l][1]=n}else{u=g.parseText(t[l][1]).textElementsMacro3Ds;
for(var w=0,y=u.length;w<y;w++){n=f.tokenize(u[w].replace(/\&squot;/g,"'"));for(var C=0,A=n.length;C<A;C++)"identifier"!==n[C].type||"-rnd-pi-e-sqr-sqrt-ra\u00edz-exp-log-log10-abs-ent-sgn-ind-sin-sen-cos-tan-cot-sec-csc-sinh-senh-cosh-tanh-coth-sech-csch-asin-asen-acos-atan-min-max-".match("-"+n[C].value+"-")||(n[C].value=this.name+"."+n[C].value);n=f.flatTokens(n).replace(/&squot;/g,"'").replace(/'\+\(/g,"[").replace(/\)\+'/g,"]");u[w]=n.substring(1,n.length-1)}t[l][1]=u.join("")}else{n=f.tokenize(t[l][1]);
u=0;for(w=n.length;u<w;u++)"identifier"!==n[u].type||"-rnd-pi-e-sqr-sqrt-ra\u00edz-exp-log-log10-abs-ent-sgn-ind-sin-sen-cos-tan-cot-sec-csc-sinh-senh-cosh-tanh-coth-sech-csch-asin-asen-acos-atan-min-max-".match("-"+n[u].value+"-")||(n[u].value=this.name+"."+n[u].value);t[l][1]=f.flatTokens(n)}h=0;for(s=q.length;h<s;h++)if(q[h][0]){t="";r=!1;l=0;for(m=q[h].length;l<m;l++)"type"===d[q[h][l][0]]&&(t="espacio='"+this.spaceID+"' ",r=!0),t=t+q[h][l][0]+"='"+q[h][l][1]+"' ";q[h]=t;r?this.graphics.push(g.parse3DGraphic(q[h],
this.abs_coord,this.background,this.inirot)):g.parseAuxiliar(q[h])}}h=0;for(s=this.graphics.length;h<s;h++)this.graphics[h].macroChildren=!0}};a.extend(a.Macro3D,a.Graphic);a.Macro3D.prototype.update=function(){this.updateTransformation();if(this.inipos){var a=this.evaluator.evalExpression(this.inipos);this.iniPosX=a[0][0];this.iniPosY=a[0][1]}this.primitives=[];for(var a=0,d=this.graphics.length;a<d;a++)f=this.graphics[a],f.macro_inirotEuler=this.inirotEuler,f.macro_inirotM=this.inirotM,f.macro_inirotM_X=
this.inirotM_X,f.macro_inirotM_Y=this.inirotM_Y,f.macro_inirotM_Z=this.inirotM_Z,f.macro_iniposM=this.iniposM,f.macro_endrotEuler=this.endrotEuler,f.macro_endrotM=this.endrotM,f.macro_endrotM_X=this.endrotM_X,f.macro_endrotM_Y=this.endrotM_Y,f.macro_endrotM_Z=this.endrotM_Z,f.macro_endposM=this.endposM,f.update();a=0;for(d=this.graphics.length;a<d;a++){f=this.graphics[a];if(f.split||this.split)for(var g=a+1;g<d;g++)c=this.graphics[g],(c.split||this.split)&&f.splitFace(c);this.primitives=this.primitives.concat(f.primitives||
[])}};a.Macro3D.prototype.updateTransformation=function(){tmpExpr=this.evaluator.evalExpression(this.inirot);this.inirotEuler?(this.inirotM=this.inirotM.setIdentity(),this.inirotM=this.inirotM.rotateZ(a.degToRad(tmpExpr[0][0])),this.inirotM=this.inirotM.rotateX(a.degToRad(tmpExpr[0][1])),this.inirotM=this.inirotM.rotateZ(a.degToRad(tmpExpr[0][2]))):(this.inirotM_X=this.inirotM_X.setIdentity().rotateX(a.degToRad(tmpExpr[0][0])),this.inirotM_Y=this.inirotM_Y.setIdentity().rotateY(a.degToRad(tmpExpr[0][1])),
this.inirotM_Z=this.inirotM_Z.setIdentity().rotateZ(a.degToRad(tmpExpr[0][2])));tmpExpr=this.evaluator.evalExpression(this.inipos);translate={x:tmpExpr[0][0],y:tmpExpr[0][1],z:tmpExpr[0][2]};this.iniposM=this.iniposM.setIdentity().translate(translate);tmpExpr=this.evaluator.evalExpression(this.endrot);this.endrotEuler?(this.endrotM=this.endrotM.setIdentity(),this.endrotM=this.endrotM.rotateZ(a.degToRad(tmpExpr[0][0])),this.endrotM=this.endrotM.rotateX(a.degToRad(tmpExpr[0][1])),this.endrotM=this.endrotM.rotateZ(a.degToRad(tmpExpr[0][2]))):
(this.endrotM_X=this.endrotM_X.setIdentity().rotateX(a.degToRad(tmpExpr[0][0])),this.endrotM_Y=this.endrotM_Y.setIdentity().rotateY(a.degToRad(tmpExpr[0][1])),this.endrotM_Z=this.endrotM_Z.setIdentity().rotateZ(a.degToRad(tmpExpr[0][2])));tmpExpr=this.evaluator.evalExpression(this.endpos);translate={x:tmpExpr[0][0],y:tmpExpr[0][1],z:tmpExpr[0][2]};this.endposM=this.endposM.setIdentity().translate(translate)};a.Macro3D.prototype.drawAux=function(a){};return a}(descartesJS||{},babel),descartesJS=function(a){function d(a,
b,c,g,d){e.call(this,a/1.8,a/1.8,a/1.8,g,d)}function e(a,b,c,g,d){a/=2;b/=2;c/=2;this.changeGeometry(a,b,c,g,d)||(this.vertices=[new n(a,c,b,1),new n(a,-c,b,1),new n(a,c,-b,1),new n(a,-c,-b,1),new n(-a,c,b,1),new n(-a,-c,b,1),new n(-a,c,-b,1),new n(-a,-c,-b,1)],this.faces=[[2,3,1,0],[1,5,4,0],[5,7,6,4],[6,7,3,2],[4,6,2,0],[3,7,5,1]],this.updateValues(a,b,c,g,d))}function f(a,b,c,g,d){a/=2;this.changeGeometry(a,b,c,g,d)||(this.vertices=[new n(0,0,a,1),new n(-0.49*a,-0.86*a,-0.32*a,1),new n(-0.49*a,
0.86*a,-0.32*a,1),new n(1*a,0,-0.32*a,1)],this.faces=[[3,2,1],[1,2,0],[2,3,0],[3,1,0]],this.updateValues(a,b,c,g,d))}function c(a,b,c,g,d){a/=2;this.changeGeometry(a,b,c,g,d)||(this.vertices=[new n(0,0,a,1),new n(a,0,0,1),new n(-a,0,0,1),new n(0,a,0,1),new n(0,-a,0,1),new n(0,0,-a,1)],this.faces=[[3,1,0],[2,3,0],[1,4,0],[4,2,0],[1,3,5],[3,2,5],[4,1,5],[2,4,5]],this.updateValues(a,b,c,g,d))}function b(b,c,g,d,f){b/=3.4;if(!this.changeGeometry(b,c,g,d,f)){E=b/D;z=b*D;this.vertices=[new n(b,b,b,1),new n(b,
b,-b,1),new n(b,-b,b,1),new n(b,-b,-b,1),new n(-b,b,b,1),new n(-b,b,-b,1),new n(-b,-b,b,1),new n(-b,-b,-b,1),new n(0,E,z,1),new n(0,E,-z,1),new n(0,-E,z,1),new n(0,-E,-z,1),new n(E,z,0,1),new n(E,-z,0,1),new n(-E,z,0,1),new n(-E,-z,0,1),new n(z,0,E,1),new n(z,0,-E,1),new n(-z,0,E,1),new n(-z,0,-E,1)];B=(new a.Matrix4x4).setIdentity().rotateY(-s/6);for(var e=0,k=this.vertices.length;e<k;e++)this.vertices[e]=B.multiplyVector4(this.vertices[e]);this.faces=[[0,16,2,10,8],[12,1,17,16,0],[8,4,14,12,0],
[2,16,17,3,13],[13,15,6,10,2],[6,18,4,8,10],[3,17,1,9,11],[13,3,11,7,15],[1,12,14,5,9],[11,9,5,19,7],[5,14,4,18,19],[6,15,7,19,18]];this.updateValues(b,c,g,d,f)}}function k(b,c,g,d,f){b/=4;if(!this.changeGeometry(b,c,g,d,f)){z=b*D;this.vertices=[new n(0,b,z,1),new n(0,b,-z,1),new n(0,-b,z,1),new n(0,-b,-z,1),new n(b,z,0,1),new n(b,-z,0,1),new n(-b,z,0,1),new n(-b,-z,0,1),new n(z,0,b,1),new n(z,0,-b,1),new n(-z,0,b,1),new n(-z,0,-b,1)];this.faces=[[10,0,2],[0,8,2],[8,5,2],[5,7,2],[7,10,2],[6,0,10],
[11,6,10],[7,11,10],[7,3,11],[5,3,7],[9,3,5],[8,9,5],[4,9,8],[0,4,8],[6,4,0],[11,3,1],[6,11,1],[4,6,1],[9,4,1],[3,9,1]];B=(new a.Matrix4x4).setIdentity().rotateY(-1.029);for(var e=0,k=this.vertices.length;e<k;e++)this.vertices[e]=B.multiplyVector4(this.vertices[e]);this.updateValues(b,c,g,d,f)}}function g(a,b,c,g,d){a/=2;this.isSphere?c=b=a:(b/=2,c/=2);if(!this.changeGeometry(a,b,c,g,d)){this.vertices=[new n(0,0,b,1)];for(var f=1;f<g;f++){A=f*s/g;for(var e=0;e<d;e++)C=e*t/d,v=a*m(A)*l(C),w=c*m(A)*
m(C),y=b*l(A),this.vertices.push(new n(v,w,y,1))}this.vertices.push(new n(0,0,-b,1));this.faces=[];for(f=0;f<d;f++)this.faces.push([0,(f+1)%d+1,f%d+1]);for(f=1;f<g-1;f++)for(e=0;e<d;e++)this.faces.push([e+1+(f-1)*d,(e+1)%d+1+(f-1)*d,(e+1)%d+1+f*d,e+1+f*d]);for(f=0;f<d;f++)this.faces.push([this.vertices.length-1,this.vertices.length-1-d+f,this.vertices.length-1-d+(f+1)%d]);this.updateValues(a,b,c,g,d)}}function p(a,b,c,g,d){a/=2;b/=2;c/=2;if(!this.changeGeometry(a,b,c,g,d)){this.vertices=[];for(var f=
0;f<d;f++)for(var e=0;e<g;e++)v=a*(d-f)/d*l(e*t/g),w=c*(d-f)/d*m(e*t/g),y=b-2*f*b/d,this.vertices.push(new n(v,w,y,1));this.vertices.push(new n(0,0,-b,1));this.faces=[];for(f=0;f<d-1;f++)for(e=0;e<g;e++)this.faces.push([e+f*g,(e+1)%g+f*g,(e+1)%g+(f+1)*g,e+(f+1)*g]);for(f=0;f<g;f++)this.faces.push([this.vertices.length-1,this.vertices.length-1-g+f,this.vertices.length-1-g+(f+1)%g]);this.updateValues(a,b,c,g,d)}}function h(a,b,c,g,d){a/=2;b/=2;c/=2;if(!this.changeGeometry(a,b,c,g,d)){this.vertices=
[];for(var f=0;f<d+1;f++)for(var e=0;e<g;e++)v=a*l(e*t/g),w=c*m(e*t/g),y=b-2*f*b/d,this.vertices.push(new n(v,w,y,1));this.faces=[];for(f=0;f<d;f++)for(e=0;e<g;e++)this.faces.push([e+f*g,(e+1)%g+f*g,(e+1)%g+(f+1)*g,e+(f+1)*g]);this.updateValues(a,b,c,g,d)}}function q(){function a(b){return parseInt(b)}function b(a){return parseFloat(a)}this.vertices=[];this.faces=[];for(var c=0,g=this.fileData.length;c<g;c++)G=this.fileData[c],G.match(/^V\(/)?(H=G.substring(2,G.length-1).split(",").map(b),this.vertices.push(new n(H[0]||
0,H[1]||0,H[2]||0,1))):G.match(/^F\(/)&&(H=G.substring(2,G.length-1).split(",").map(a),this.faces.push(H.reverse()))}if(a.loadLib)return a;var m=Math.sin,l=Math.cos,s=Math.PI,t=2*s,n,u,r,v,w,y,C,A,D=1.6180339887,E,z,B,G,H;a.OtherGeometry=function(m,l){this.width=m.evaluator.parser.parse("2");this.height=m.evaluator.parser.parse("2");this.length=m.evaluator.parser.parse("2");n=a.Vector4D;a.Graphic3D.call(this,m,l);switch(this.type){case "cube":this.buildGeometry=d;break;case "box":this.buildGeometry=
e;break;case "tetrahedron":this.buildGeometry=f;break;case "octahedron":this.buildGeometry=c;break;case "sphere":this.isSphere=!0;case "ellipsoid":this.buildGeometry=g;break;case "dodecahedron":this.buildGeometry=b;break;case "icosahedron":this.buildGeometry=k;break;case "cone":this.buildGeometry=p;break;case "cylinder":this.buildGeometry=h;break;case "mesh":this.fileData=a.openExternalFile(this.evaluator.evalExpression(this.file)).split(/\r/),this.buildGeometry=q}};a.extend(a.OtherGeometry,a.Graphic3D);
a.OtherGeometry.prototype.buildPrimitives=function(){u=this.evaluator;this.updateMVMatrix();this.buildGeometry(u.evalExpression(this.width),u.evalExpression(this.height),u.evalExpression(this.length),u.evalExpression(this.Nu),u.evalExpression(this.Nv));for(var b=0,c=this.faces.length;b<c;b++){r=[];for(var g=0,d=this.faces[b].length;g<d;g++)r.push(this.transformVertex(this.vertices[this.faces[b][g]]));this.primitives.push(new a.Primitive3D({vertices:r,type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),
edges:this.edges,model:this.model},this.space))}};a.OtherGeometry.prototype.changeGeometry=function(a,b,c,g,d){return this.oldWidth===a&&this.oldHeight===b&&this.oldLength===c&&this.oldNu===g&&this.oldNv===d};a.OtherGeometry.prototype.updateValues=function(a,b,c,g,d){this.oldWidth=a;this.oldHeight=b;this.oldLength=c;this.oldNv=d;this.oldNu=g};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.max,e=Math.min,f=Math.PI,c=Math.cos,b=Math.sin,k=Math.abs,g=Math.round,p,
h,q,m,l,s,t,n,u,r,v,w,y,C,A,D,E,z;a.R2=function(a,b){this.x=a||0;this.y=b||0};a.R2.prototype.set=function(a,b){this.x=a||0;this.y=b||0;return this};a.R2.prototype.copy=function(){return new a.R2(this.x,this.y)};a.R2.prototype.ix=function(){return g(d(e(this.x,32E3),-32E3))};a.R2.prototype.iy=function(){return g(d(e(this.y,32E3),-32E3))};a.R2.prototype.equals=function(a){return this.x==a.x&&this.y==a.y};a.R2.prototype.norm2=function(){return this.x*this.x+this.y*this.y};a.R2.prototype.norm=function(){return Math.sqrt(this.norm2())};
a.R2.prototype.distance=function(a){h=this.copy();h.sub(a);return h.norm()};a.R2.prototype.dot=function(a){return this.x*a.x+this.y*a.y};a.R2.prototype.det=function(a){return this.x*a.y-this.y*a.x};a.R2.prototype.mul=function(a){this.x*=a;this.y*=a};a.R2.prototype.div=function(a){this.x/=a;this.y/=a};a.R2.prototype.add=function(a){this.x+=a.x;this.y+=a.y};a.R2.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};a.R2.prototype.normalize=function(){p=this.norm();0!=p&&this.div(p)};a.R2.prototype.rotR90=
function(){p=this.x;this.x=this.y;this.y=-p};a.R2.prototype.rotL90=function(){p=this.x;this.x=-this.y;this.y=p};a.R2.prototype.rot=function(a){q=this.copy();s=c(a);t=b(a);this.x=q.x*s-q.y*t;this.y=q.x*t+q.y*s};a.R2.prototype.rot=function(a){this.rot(a*f/180)};a.R2.prototype.intersection=function(b,c,g,f){n=c.x-b.x;u=g.x-f.x;r=g.x-b.x;v=c.y-b.y;w=g.y-f.y;y=g.y-b.y;z=n*w-u*v;return 1E-6<k(z)?(m=(r*w-y*u)/z,l=(-r*v+y*n)/z,0<=m&&1>=m&&0<=l&&1>=l?new a.R2(b.x+n*m,b.y+v*m):null):(c.x-g.x)*y!=(c.y-g.y)*
r?null:b.x!=c.x?(C=e(b.x,c.x),A=d(b.x,c.x),C<=g.x&&g.x<=A?g:C<=f.x&&f.x<=A?f:null):g.x!=f.x?(D=e(g.x,f.x),E=d(g.x,f.x),D<=b.x&&b.x<=E?b:D<=c.x&&c.x<=E?c:null):b.y!=c.y?(C=e(b.y,c.y),A=d(b.y,c.y),C<=g.y&&g.y<=A?g:C<=f.y&&f.y<=A?f:null):g.y!=f.y?(D=e(g.y,f.y),E=d(g.y,f.y),D<=b.y&&b.y<=E?b:D<=c.y&&c.y<=E?c:null):b.x==g.x&&b.y==g.y?b:null};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g,p,h;a.R2Newton=function(c,g){this.evaluator=c;this.constraint=g;if("=="==
this.constraint.value||"<"==this.constraint.value||"<="==this.constraint.value||">"==this.constraint.value||">="==this.constraint.value)this.sign="<"==this.constraint.value||"<="==this.constraint.value?"menor":">"==this.constraint.value||">="==this.constraint.value?"mayor":"igual",this.constraint=this.constraint.equalToMinus(),this.constraint=this.constraint.childs[0];k=new a.R2(0,0);b=new a.R2(0,0);h=new a.R2(0,0)};a.R2Newton.prototype.getUnitNormal=function(){this.normal.normalize();return h.set(this.normal.x,
this.normal.y)};a.R2Newton.prototype.gradient=function(a){d=this.evaluator;k.x=0;k.y=0;g=d.getVariable("x");p=d.getVariable("y");d.setVariable("x",a.x);d.setVariable("y",a.y);this.f0=d.evalExpression(this.constraint);d.setVariable("x",d.getVariable("x")+1E-6);e=d.evalExpression(this.constraint);k.x=(e-this.f0)/1E-6;k.x=isNaN(k.x)?Infinity:k.x;d.setVariable("x",d.getVariable("x")-1E-6);d.setVariable("y",d.getVariable("y")+1E-6);e=d.evalExpression(this.constraint);k.y=(e-this.f0)/1E-6;k.y=isNaN(k.y)?
Infinity:k.y;d.setVariable("x",g);d.setVariable("y",p);return k};a.R2Newton.prototype.findZero=function(a,e,k){d=this.evaluator;b.x=a.x;b.y=a.y;g=d.getVariable("x");p=d.getVariable("y");d.setVariable("x",a.x);d.setVariable("y",a.y);this.f0=d.evalExpression(this.constraint);if("menor"===this.sign&&0>=this.f0||"mayor"===this.sign&&0<=this.f0)return b;d.setVariable("x",g);d.setVariable("y",p);for(var h=0;16>h;h++)if(f=b.x,c=b.y,this.normal=this.gradient(b),0!=this.normal.norm2()&&this.normal.mul(-this.f0/
this.normal.norm2()),b.x=f+this.normal.x,b.y=c+this.normal.y,this.normal.norm()<e)return 0===this.normal.x&&0===this.normal.y&&(this.normal.x=b.x-a.x,this.normal.y=b.y-a.y),b;return k?b:null};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector2D=function(a,e){this.x=a;this.y=e};a.Vector2D.AXIS_X=new a.Vector2D(1,0);a.Vector2D.AXIS_Y=new a.Vector2D(0,1);a.Vector2D.prototype.vectorLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.Vector2D.prototype.dotProduct=
function(a){return this.x*a.x+this.y*a.y};a.Vector2D.prototype.angleBetweenVectors=function(a){return Math.acos(this.dotProduct(a)/(this.vectorLength()*a.vectorLength()))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e=Math.round,f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v,w,y,C,A;a.Control=function(b,c){this.parent=b;this.evaluator=b.evaluator;var g=this.parser=b.evaluator.parser;this.id="graphic"!==c.type?"C":"G";this.gui=this.type="";this.region="south";this.y=
this.x=0;this.w="video"!==c.type?100:350;this.h="video"!==c.type?23:120;"graphic"!==c.type&&"audio"!==c.type&&"video"!==c.type?"text"!==c.type?this.expresion=g.parse("(0,0,100,23)"):(this.expresion=g.parse("(0,0,300,200)"),this.w=300,this.h=200):this.expresion=g.parse("(0,0)");this.fixed=2!=this.parent.version?!1:!0;this.visible=!0;this.color=4>this.parent.version?new a.Color("000000"):new a.Color("222222");this.colorInt="graphic"!==c.type?new a.Color("f0f8ff"):new a.Color("cc0022");this.underlined=
this.italics=this.bold="";this.font_size=4>this.parent.version?-1:g.parse("12");this.parameter=this.action="";this.parameterFont="Monospace 12px";this.drawif=g.parse("1");this.activeif=g.parse("1");this.tooltip="";this.tooltipFont="Monospace 12px";this.Explanation="";this.ExplanationFont="Monospace 12px";this.cID=this.msg_pos="";this.valueExpr=g.parse("0");this.decimals=g.parse("2");this.min=g.parse("-Infinity");this.max=g.parse("Infinity");this.incr=g.parse("0.1");this.exponentialif=this.discrete=
!1;this.zIndex=-1;for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);"video"!==this.type&&"audio"!==this.type||"interior"===this.region||(this.region="interior");void 0==this.name&&(this.name=2==this.parent.version?this.id:"_nada_");this.name="_._"==this.name||"_nada_"==this.name||"_void_"==this.name?"":this.name;g=this.evaluator.evalExpression(this.expresion);this.x=e(g[0][0]);this.y=e(g[0][1]);4==g[0].length&&(this.w=e(g[0][2]),this.h=e(g[0][3]));this.actionExec=b.lessonParser.parseAction(this)};
a.Control.prototype.init=function(){};a.Control.prototype.update=function(){};a.Control.prototype.draw=function(){};a.Control.prototype.getContainer=function(){var a=this.parent.spaces,b;if("interior"===this.region)for(var c=0,g=a.length;c<g;c++){if(b=a[c],b.id===this.spaceID)return b.addCtr(this),this.zIndex=b.zIndex,b.numericalControlContainer}else{if("external"===this.region)return this.parent.externalSpace.addCtr(this),this.parent.externalSpace.container;if("scenario"===this.region)return this.cID?
(this.expresion=this.evaluator.parser.parse("(0,-1000,"+this.w+","+this.h+")"),this.parent.scenarioRegion.scenarioSpace.addCtr(this),this.zIndex=this.parent.scenarioRegion.scenarioSpace.zIndex,this.parent.scenarioRegion.scenarioSpace.numericalControlContainer):this.parent.externalSpace.container;if("north"===this.region)return this.parent.northSpace.controls.push(this),this.parent.northSpace.container;if("south"===this.region)return this.parent.southSpace.controls.push(this),this.parent.southSpace.container;
if("east"===this.region)return this.parent.eastSpace.controls.push(this),this.parent.eastSpace.container;if("west"===this.region)return this.parent.westSpace.controls.push(this),this.parent.westSpace.container;if("special"===this.region)return this.parent.specialSpace.controls.push(this),this.parent.specialSpace.container}a[0].addCtr(this);this.zIndex=a[0].zIndex;return a[0].numericalControlContainer};a.Control.prototype.addControlContainer=function(a){var b=this.getContainer();b.childNodes[0]?b.insertBefore(a,
b.childNodes[0]):b.appendChild(a);b.childNodes[0]?b.insertBefore(a,b.childNodes[0]):b.appendChild(a)};a.Control.prototype.updatePositionAndSize=function(){b=k=g=p=!1;h=this.evaluator.evalExpression(this.expresion);q=e(h[0][0]);b=e(this.x)!==q;this.x=q;q=e(h[0][1]);k=e(this.y)!==q;this.y=q;4===h[0].length&&(q=e(h[0][2]),g=e(this.w)!==q,this.w=q,q=e(h[0][3]),p=e(this.h)!==q,this.h=q);if(g||p||b||k)this.init(!0),this.draw()};a.Control.prototype.formatOutputValue=function(a){n=this.parent;m=a+"";l=this.evaluator.evalExpression(this.decimals);
s=m.indexOf(".");-1!=s&&(t=m.substring(s+1),t.length>l&&(m=parseFloat(m).toFixed(l)));this.fixed&&(2!==n.version||2===n.version&&!this.exponentialif)&&(m=parseFloat(a).toFixed(l));this.exponentialif&&0!=parseFloat(m)&&(m=this.fixed&&2!==n.version?parseFloat(m).toExponential(l):parseFloat(m).toExponential(),m=m.toUpperCase(),m=m.replace("+",""));return m=m.replace(".",n.decimal_symbol)};a.Control.prototype.updateAndExecAction=function(){this.parent.updateControls();"init"===this.action&&(this.click=
!1);this.actionExec.execute();"animate"!==this.action&&this.parent.update()};a.Control.prototype.createGradient=function(a,b){this.linearGradient=this.ctx.createLinearGradient(0,0,0,b);f=b*b;for(var g=0;g<b;g++)c=d(g-35*b/100),this.linearGradient.addColorStop(g/b,"rgba(0,0,0,"+c*c*192/f/255+")")};a.Control.prototype.getScreenshot=function(){v=this;u=document.createElement("canvas");u.setAttribute("width",v.w);u.setAttribute("height",v.h);r=u.getContext("2d");r.font=v.fieldFontSize+"px Arial, Helvetica, 'Droid Sans', Sans-serif";
v.canvas&&(w=v.canvas.offsetLeft,y=v.canvas.offsetTop,r.drawImage(v.canvas,w,y));v.label&&(w=v.label.offsetLeft,y=v.label.offsetTop,C=v.label.offsetWidth,A=v.label.offsetHeight,r.fillStyle="#e0e4e8",r.fillRect(w,y,C,A),r.fillStyle="black",r.textAlign="center",r.textBaseline="middle",r.fillText(v.name,w+C/2,y+A/2));v.field&&(w=v.field.offsetLeft,y=v.field.offsetTop,C=v.field.offsetWidth,A=v.field.offsetHeight,r.fillStyle="white",r.strokeStyle="#666666",r.lineWidth=1,r.fillRect(w,0,C,A),r.strokeRect(w+
0.5,0.5,C-1,A-1),r.fillStyle="black",r.textAlign="center",r.textAlign="left",r.fillText(v.field.value,w+2,A/2));v.select&&(w=v.select.offsetLeft,y=v.select.offsetTop,C=v.select.offsetWidth,A=v.select.offsetHeight,r.fillStyle="#e0e4e8",r.strokeStyle="#666666",r.lineWidth=1,r.fillRect(w,0,C,A),r.strokeRect(w+0.5,0.5,C,A-1),r.fillStyle="black",r.textAlign="center",r.textAlign="left",r.fillText(v.select.value,w+2,A/2),r.fillStyle="#c0c0c0",r.fillRect(w+C-15+0.5,0.5,15,A-1),r.strokeRect(w+C-15+0.5,0.5,
15,A-1),r.fillStyle="black",r.beginPath(),r.moveTo(w+C-15+4.5,A/2-2.5),r.lineTo(w+C-15+8,A/2+2.5),r.lineTo(w+C-15+11.5,A/2-2.5),r.closePath(),r.fill());return u};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e,f,c,b,k,g,p,h,q,m,l,s,t=2E3,n,u,r,v,w,y,C,A=/[\w\.\-//]*(\.gif)/gi;a.Button=function(b,c){this.imageSrc="";this.image=new Image;this.imageOver=new Image;this.imageDown=new Image;a.Control.call(this,b,c);-1===this.font_size&&(this.fontSizeNotSet=!0);
"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");var g;this.imageSrc.match("_COLORES_")&&(g=this.imageSrc.split("_"),this.colorInt=new a.Color(g[2]),this.color=new a.Color(g[3]),this.font_size=this.parser.parse(g[5]),this.imageSrc="");"["==this.imageSrc.charAt(0)?this.imageSrc=this.parser.parse(this.imageSrc):this.imageSrc=this.parser.parse("'"+this.imageSrc+"'");
g=this.evaluator.evalExpression(this.imageSrc).trim();if(""!=g){var d=g.substr(0,g.lastIndexOf(".")),f=g.substr(g.lastIndexOf("."));g.toLowerCase().match(/vacio.gif$/)?(this.imageSrc=this.parser.parse("'vacio.gif'"),this.image.ready=1,3===this.parent.version&&(this.name=this.parser.parse("")),this.emptyImage={ready:!0},this.parser.parse("'vacio.gif'")):(this.image=this.parent.getImage(g),this.imageOver=this.parent.getImage(d+"_over"+f),this.imageDown=this.parent.getImage(d+"_down"+f))}this.canvas=
document.createElement("canvas");this.canvas.setAttribute("class","DescartesButton");this.canvas.setAttribute("id",this.id);this.canvas.setAttribute("width",this.w+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.ctx=this.canvas.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.mozImageSmoothingEnabled=!1;this.ctx.webkitImageSmoothingEnabled=!1;this.addControlContainer(this.canvas);
this.registerMouseAndTouchEvents();this.init()};a.extend(a.Button,a.Control);a.Button.prototype.init=function(){e=this.evaluator;f=this.canvas;b=e.evalExpression(this.expresion);this.x=b[0][0];this.y=b[0][1];4==b[0].length&&(this.w=parseInt(b[0][2]),this.h=parseInt(b[0][3]));f.setAttribute("width",this.w+"px");f.setAttribute("height",this.h+"px");f.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+"; display: block; background-repeat: no-repeat;");this.fontSizeNotSet&&
(this.font_size=e.parser.parse(a.getFieldFontSize(this.h)+""));this.createGradient(this.w,this.h);f.style.display=0<e.evalExpression(this.drawif)?"block":"none"};a.Button.prototype.update=function(){e=this.evaluator;f=this.canvas;this.activeIfValue=0<e.evalExpression(this.activeif);(this.drawIfValue=0<e.evalExpression(this.drawif))?(f.style.display="block",this.draw()):f.style.display="none";f.style.cursor=this.activeIfValue?"pointer":"not-allowed";this.updatePositionAndSize()};a.Button.prototype.draw=
function(){e=this.evaluator;c=this.ctx;k=e.evalExpression(this.font_size);g=e.evalExpression(this.name);p=e.evalExpression(this.imageSrc);h="vacio.gif"===p?this.emptyImage:this.parent.getImage(p);c.clearRect(0,0,this.w,this.h);m=q=0;this.buttonClick&&(m=q=1);r=d(this.w/2+q)-0.5;v=d(this.h/2+m)-0.5;h&&(w=h.height||1E8,y=a.getFontMetrics(this.italics+" "+this.bold+" "+k+"px Arial").h,C=""!=g?0<=this.h-w-y-2?!0:!1:!1,n=parseInt((this.w-h.width)/2)+q,u=C?parseInt((this.h-y-h.height+2)/2):parseInt((this.h-
h.height)/2)+m,C&&(v=parseInt(this.h-y/2-2),c.fillStyle=this.colorInt.getColor(),c.fillRect(0,0,this.w,this.h)));h&&h.ready?h!==this.emptyImage&&h.complete&&(this.image.src.match(A)?(this.canvas.style.backgroundImage="url("+this.image.src+")",this.canvas.style.backgroundPosition=n+"px "+u+"px"):c.drawImage(h,n,u)):(c.fillStyle=this.colorInt.getColor(),c.fillRect(0,0,this.w,this.h),this.buttonClick||(a.drawLine(c,this.w-1,0,this.w-1,this.h,"rgba(0,0,0,"+128/255+")"),a.drawLine(c,0,0,0,this.h,"rgba(0,0,0,"+
24/255+")"),a.drawLine(c,1,0,1,this.h,"rgba(0,0,0,"+8/255+")")),c.fillStyle=this.linearGradient,c.fillRect(0,0,this.w,this.h));this.activeIfValue&&""!=this.imageOver.src&&this.imageOver.ready&&this.over&&(this.image.src.match(A)?(this.canvas.style.backgroundImage="url("+this.imageOver.src+")",this.canvas.style.backgroundPosition=n+"px "+u+"px"):c.drawImage(this.imageOver,n,u));this.activeIfValue&&""!=this.imageDown.src&&this.imageDown.ready&&this.buttonClick?this.image.src.match(A)?(this.canvas.style.backgroundImage=
"url("+this.imageDown.src+")",this.canvas.style.backgroundPosition=n+"px "+u+"px"):c.drawImage(this.imageDown,n,u):this.buttonClick&&!h&&(a.drawLine(c,0,0,0,this.h-2,"gray"),a.drawLine(c,0,0,this.w-1,0,"gray"),c.fillStyle="rgba(0, 0, 0,"+24/255+")",c.fillRect(0,0,this.w,this.h));c.fillStyle=this.color.getColor();c.font=this.italics+" "+this.bold+" "+k+"px Arial";c.textAlign="center";c.textBaseline="middle";this.colorInt.getColor()!=this.color.getColor()&&(c.lineJoin="round",c.lineWidth=parseInt(k/
6),c.strokeStyle=this.colorInt.getColor(),c.strokeText(g,r,v));c.fillText(g,r,v);this.underlined&&(l=c.measureText(g).width,c.strokeStyle=this.color.getColor(),c.lineWidth=d(k/10)||2,c.lineCap="round",c.beginPath(),c.moveTo(parseInt((this.w-l)/2)+q,v+d(k/2)+d(k/5)-1.5),c.lineTo(parseInt((this.w+l)/2)+q,v+d(k/2)+d(k/5)-1.5),c.stroke());this.activeIfValue||(c.fillStyle="rgba(240,240,240,"+160/255+")",c.fillRect(0,0,this.w,this.h))};a.Button.prototype.buttonPressed=function(){this.updateAndExecAction()};
a.Button.prototype.registerMouseAndTouchEvents=function(){function b(a,c,g){clearInterval(k);e.buttonClick&&e.drawIfValue&&e.activeIfValue&&(c.call(e),a=g?a:100,k=setTimeout(function(){b(a,c)},a))}function c(d){document.body.focus();d.preventDefault();d.stopPropagation();document.activeElement!=document.body&&document.activeElement.blur();e.whichButton=a.whichButton(d);"L"==e.whichButton&&e.activeIfValue&&(e.buttonClick=!0,e.draw(),e.evaluator.setVariable(e.id,e.evaluator.evalExpression(e.valueExpr)),
"calculate"==e.action&&b(t,e.buttonPressed,!0),s?(e.canvas.removeEventListener("touchend",g),e.canvas.addEventListener("touchend",g)):(e.canvas.removeEventListener("mouseup",g),e.canvas.addEventListener("mouseup",g)))}function g(a){document.body.focus();if(e.activeIfValue||e.buttonClick)e.buttonClick=!1,e.draw(),"calculate"!=e.action&&e.buttonPressed(),a.preventDefault(),a.stopPropagation(),s?e.canvas.removeEventListener("touchend",g):e.canvas.removeEventListener("mouseup",g)}function d(a){e.over=
!0;e.draw()}function f(a){e.over=!1;e.buttonClick=!1;e.draw()}s=a.hasTouchSupport;var e=this,k;e.canvas.oncontextmenu=function(){return!1};this.over=this.buttonClick=!1;s?this.canvas.addEventListener("touchstart",c):(this.canvas.addEventListener("mousedown",c),this.canvas.addEventListener("mouseover",d),this.canvas.addEventListener("mouseout",f))};a.Button.prototype.getScreenshot=function(){return this.canvas};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,
k,g,p,h,q,m,l,s,t,n,u,r,v;a.Spinner=function(b,c){a.Control.call(this,b,c);this.tabindex=++this.parent.tabindex;"_._"==this.name&&(this.name="");"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");
this.field=document.createElement("input");this.label=document.createElement("label");this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.canvas);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.addControlContainer(this.containerControl);v=this.evaluator.parser.parse("1");this.originalIncr=this.incr;if(0>=this.evaluator.evalExpression(this.decimals)||0==this.evaluator.evalExpression(this.incr)){var g=
this.evaluator.evalExpression(this.incr);0<g?this.originalIncr=this.incr=this.evaluator.parser.parse(parseInt(g).toString()):this.incr=v}this.registerMouseAndTouchEvents();this.init()};a.extend(a.Spinner,a.Control);a.Spinner.prototype.init=function(){d=this.evaluator;var b=d.evalExpression(this.name).toString();this.label.innerHTML=b;this.value=this.validateValue(d.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value);this.fieldFontSize=2!==this.parent.version?a.getFieldFontSize(this.h):
10;var g=2!==this.parent.version?"":"_____",f=a.getTextWidth(c+"_",this.fieldFontSize+"px Arial"),e=2+parseInt(this.h/2),k=parseInt(this.w/2-e/2),g=a.getTextWidth(b+g,this.fieldFontSize+"px Arial");this.visible||(k=this.w-e,f=0);k<g&&(k=g);""==b&&(k=0);this.w-k-e<f&&(k=this.w-e-f);0>k&&(k=0);b=this.w-(k+e);this.containerControl.setAttribute("class","DescartesSpinnerContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+
"px; z-index: "+this.zIndex+";");this.containerControl.setAttribute("id",this.id);this.canvas.setAttribute("width",e+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","position: absolute; left: "+k+"px; top: 0px;");this.ctx=this.canvas.getContext("2d");this.divUp.setAttribute("class","up");this.divUp.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+e+"px; height : "+this.h/2+"px; left: "+k+"px; top: 0px;");
this.divDown.setAttribute("class","down");this.divDown.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+e+"px; height : "+this.h/2+"px; left: "+k+"px; top: "+this.h/2+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"_spinner");this.field.setAttribute("class","DescartesSpinnerField");this.field.setAttribute("style","font-family: Arial; font-size: "+this.fieldFontSize+"px; width : "+b+"px; height : "+this.h+
"px; left: "+(e+k)+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.value=c;this.visible||(this.field.style.display="none");this.label.setAttribute("class","DescartesSpinnerLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+k+"px; height: "+this.h+"px; line-height: "+this.h+"px;");d.setVariable(this.id,this.value);this.createGradient(this.h/2,this.h)};a.Spinner.prototype.update=function(){d=this.evaluator;this.label.innerHTML=d.evalExpression(this.name).toString();
0>=d.evalExpression(this.decimals)?(e=d.evalExpression(this.incr),0<e?this.originalIncr=this.incr=d.parser.parse(parseInt(e).toString()):this.incr=v):this.incr=0!=d.evalExpression(this.originalIncr)?this.originalIncr:v;this.activeIfValue=0<d.evalExpression(this.activeif);this.drawIfValue=0<d.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):(this.click=!1,this.containerControl.style.display="none");this.updatePositionAndSize();
this.parent.animation.playing&&document.activeElement==this.field||(f=this.field.value,c=this.value,this.value=this.validateValue(d.getVariable(this.id)),this.field.value=this.formatOutputValue(this.value),this.value==c&&this.field.value!=f&&(this.value=this.validateValue(f),this.field.value=this.formatOutputValue(this.value)),d.setVariable(this.id,this.value))};a.Spinner.prototype.draw=function(){b=this.ctx;k=this.canvas.width;g=this.canvas.height;b.fillStyle="#f0f8ff";b.fillRect(0,0,k,g);b.fillStyle=
this.linearGradient;b.fillRect(0,0,k,g);this.up?(p="gray",h="#f0f8ff"):(p="#f0f8ff",h="gray");a.drawLine(b,0,0,k,0,p);a.drawLine(b,0,0,0,g/2,p);a.drawLine(b,0,g/2,k,g/2,h);this.down?(p="gray",h="#f0f8ff"):(p="#f0f8ff",h="gray");a.drawLine(b,0,g/2+1,k,g/2+1,p);a.drawLine(b,0,g/2+1,0,g,p);a.drawLine(b,0,g-1,k,g-1,h);q=[parseInt(k/2+1),parseInt(k/5+1),parseInt(k-k/5+1)];m=[parseInt(g/8+1),parseInt(g/8+1+g/4),parseInt(g/8+1+g/4)];b.fillStyle=this.activeIfValue?"#2244cc":"#8888aa";b.beginPath();b.moveTo(q[0],
m[0]);b.lineTo(q[1],m[1]);b.lineTo(q[2],m[2]);b.fill();m=[parseInt(g-g/8),parseInt(g-g/8-g/4),parseInt(g-g/8-g/4)];b.fillStyle=this.activeIfValue?"#d00018":"#aa8888";b.beginPath();b.moveTo(q[0],m[0]);b.lineTo(q[1],m[1]);b.lineTo(q[2],m[2]);b.fill();b.fillStyle="rgba(0,0,0,"+24/255+")";this.up&&b.fillRect(0,0,k,g/2);this.down&&b.fillRect(0,g/2,k,g)};a.Spinner.prototype.validateValue=function(a){d=this.evaluator;isNaN(parseFloat(a))||a.toString().match("e")&&(a=parseFloat(a).toFixed(20));a=a.toString();
a=a.replace(this.parent.decimal_symbol,".");l=a==parseFloat(a)?parseFloat(a):parseFloat(d.evalExpression(d.parser.parse(a)));isNaN(l)&&(l=0);n=d.evalExpression(this.min);u=d.evalExpression(this.max);""===n&&(n=-Infinity);""===u&&(u=Infinity);l<n&&(l=n);l>u&&(l=u);this.discrete&&(s=d.evalExpression(this.incr),l=0==s?0:s*Math.round(l/s));t=d.evalExpression(this.decimals);0>=t&&(t=0);return l=parseFloat(parseFloat(l).toFixed(t))};a.Spinner.prototype.increase=function(){this.changeValue(parseFloat(this.value)+
this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.changeValue=function(a){this.activeIfValue&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction())};a.Spinner.prototype.registerMouseAndTouchEvents=function(){function b(a,c,g){clearInterval(m);if(h.up||h.down)c.call(h),
a=g?a:30,m=setTimeout(function(){b(a,c)},a)}function c(g){g.preventDefault();h.whichButton=a.whichButton(g);"L"==h.whichButton&&h.activeIfValue&&(h.up=!0,b(p,h.increase,!0),h.draw())}function g(c){c.preventDefault();h.whichButton=a.whichButton(c);"L"==h.whichButton&&h.activeIfValue&&(h.down=!0,b(p,h.decrease,!0),h.draw())}function d(a){h.up=!1;clearInterval(m);h.draw();a.preventDefault()}function f(a){h.down=!1;clearInterval(m);h.draw();a.preventDefault()}function e(a){h.up=!1;clearInterval(m);h.draw();
a.preventDefault()}function k(a){h.down=!1;clearInterval(m);h.draw();a.preventDefault()}r=a.hasTouchSupport;var h=this,p=r?500:200,m;h.divUp.oncontextmenu=h.divDown.oncontextmenu=h.field.oncontextmenu=h.label.oncontextmenu=function(){return!1};r?this.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):this.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("keydown",function(a){13==a.keyCode&&h.changeValue(h.field.value)});
r?this.divUp.addEventListener("touchstart",c):this.divUp.addEventListener("mousedown",c);r?this.divDown.addEventListener("touchstart",g):this.divDown.addEventListener("mousedown",g);r||this.divUp.addEventListener("mouseout",d);r||this.divDown.addEventListener("mouseout",f);r?(this.divUp.addEventListener("touchend",e),window.addEventListener("touchend",e)):(this.divUp.addEventListener("mouseup",e),window.addEventListener("mouseup",e));r?(this.divDown.addEventListener("touchend",k),window.addEventListener("touchend",
k)):(this.divDown.addEventListener("mouseup",k),window.addEventListener("mouseup",k));h.field.addEventListener("click",function(a){this.select();this.focus()})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g;a.TextField=function(b,c){a.Control.call(this,b,c);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");void 0===this.valueExprString&&
(this.valueExprString=this.onlyText?"0":"");this.emptyString=!1;this.ok=0;this.tabindex=++this.parent.tabindex;if(this.answer)if(this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7))),this.answerPattern=this.answer,this.answer=a.buildRegularExpresionsPatterns(this.answer,this.evaluator),this.onlyText){var g=this.answerPattern.indexOf("|");this.firstAnswer=-1==g?this.answerPattern:this.answerPattern.substring(0,g)}else this.firstAnswer=this.parser.parse(this.answerPattern.substring(1,
this.answerPattern.indexOf(",")));this.onlyText&&(this.valueExprString.match(/^'/)&&this.valueExprString.match(/'$/)||(this.valueExpr=this.evaluator.parser.parse("'"+this.valueExprString+"'")),this.validateValue=function(a){a=a.toString();return"''"==a||"'"==a?"":a&&a.match(/^'/)&&a.match(/'$/)?a.substring(1,a.length-1):a},this.formatOutputValue=function(a){return a.toString()});""==name.trim()&&(name="");this.containerControl=document.createElement("div");this.field=document.createElement("input");
this.label=document.createElement("label");this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextField,a.Control);a.TextField.prototype.init=function(){d=this.evaluator;var b=d.evalExpression(this.name).toString();this.label.innerHTML=b;this.value=this.validateValue(d.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value);this.fieldFontSize=
a.getFieldFontSize(this.h);var g=a.getTextWidth(c+"_",this.fieldFontSize+"px Arial"),f=parseInt(this.w/2),e=a.getTextWidth(b,this.fieldFontSize+"px Arial");this.visible||(f=this.w,g=0);f<e&&(f=e);""==b&&(f=0);this.w-f<g&&(f=this.w-g);0>f&&(f=0);b=this.w-f;this.containerControl.setAttribute("class","DescartesTextFieldContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.field.setAttribute("type",
"text");this.field.setAttribute("id",this.id+"TextField");this.field.setAttribute("class","DescartesTextFieldField");this.field.setAttribute("style","font-size: "+this.fieldFontSize+"px; width : "+b+"px; height : "+this.h+"px; left: "+f+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.value=c;this.label.setAttribute("class","DescartesTextFieldLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+f+"px; height: "+this.h+"px; line-height: "+this.h+
"px;");this.evaluate&&(this.ok=this.evaluateAnswer());this.evaluator.setVariable(this.id,this.value);this.evaluator.setVariable(this.id+".ok",this.ok);this.oldValue=this.value;this.update()};a.TextField.prototype.update=function(){d=this.evaluator;this.label.innerHTML=d.evalExpression(this.name).toString();this.activeIfValue=0<d.evalExpression(this.activeif);this.drawIfValue=0<d.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.containerControl.style.display=this.drawIfValue?
"block":"none";this.updatePositionAndSize();this.parent.animation.playing&&document.activeElement==this.field||(e=this.field.value,f=this.value,this.value=this.validateValue(d.getVariable(this.id)),this.field.value=this.formatOutputValue(this.value),this.value===f&&this.field.value!=e&&(this.value=this.validateValue(e),this.field.value=this.formatOutputValue(this.value)),d.setVariable(this.id,this.value))};a.TextField.prototype.validateValue=function(a){if(""===a||"''"==a)return"";d=this.evaluator;
a=a.toString().replace(this.parent.decimal_symbol,".");c=a==parseFloat(a)?parseFloat(a):parseFloat(d.evalExpression(d.parser.parse(a)));isNaN(c)&&(c=0);b=d.evalExpression(this.min);""==b&&(b=-Infinity);k=d.evalExpression(this.max);""==k&&(k=Infinity);this.discrete&&(a=d.evalExpression(this.incr),c=0==a?0:a*Math.round(c/a));return c=parseFloat(parseFloat(c).toFixed(d.evalExpression(this.decimals)))};a.TextField.prototype.formatOutputValue=function(a){return""===a?"":this.uber.formatOutputValue.call(this,
a)};a.TextField.prototype.changeValue=function(a,b){this.activeIfValue&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluate&&(this.ok=this.evaluateAnswer()),this.evaluator.setVariable(this.id,this.value),this.evaluator.setVariable(this.id+".ok",this.ok),this.updateAndExecAction())};a.TextField.prototype.evaluateAnswer=function(){return a.esCorrecto(this.answer,this.value,this.evaluator,this.answer)};a.TextField.prototype.getFirstAnswer=function(){return this.answer?
this.onlyText?this.firstAnswer:this.evaluator.evalExpression(this.firstAnswer):""};a.TextField.prototype.registerMouseAndTouchEvents=function(){g=a.hasTouchSupport;var b=this;b.field.oncontextmenu=b.label.oncontextmenu=function(){return!1};g?b.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):b.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("blur",function(a){b.changeValue(b.field.value,!0)});this.field.addEventListener("keydown",
function(a){b.activeIfValue&&13==a.keyCode&&b.changeValue(b.field.value,!0)});b.field.addEventListener("click",function(a){this.select();this.focus()})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.abs,e,f,c,b,k,g,p,h,q,m,l;a.Menu=function(b,c){this.options="";a.Control.call(this,b,c);e=this.parser;f=this.evaluator;this.ok=0;this.tabindex=++this.parent.tabindex;this.answer&&(this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7))),
this.answer=parseInt(this.answer.split(",")[0].replace("[",""))||0);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");this.options=this.options.split(",");this.menuOptions=[];this.strValue=[];for(var g,d=0,k=this.options.length;d<k;d++)g=this.customSplit(this.options[d]),1==g.length?(this.menuOptions.push(g[0]),this.strValue.push(d.toString())):2==g.length&&(this.menuOptions.push(g[0]),
""==g[1]?this.strValue.push(d.toString()):this.strValue.push(g[1]));d=0;for(k=this.menuOptions.length;d<k;d++)this.menuOptions[d].match(/^\[/)&&this.menuOptions[d].match(/\]$/)?this.menuOptions[d]=e.parse(this.menuOptions[d].substring(1,this.menuOptions[d].length-1)):this.menuOptions[d]=e.parse("'"+this.menuOptions[d]+"'");d=0;for(k=this.strValue.length;d<k;d++)this.strValue[d].match(/^\[/)&&this.strValue[d].match(/\]$/)?this.strValue[d]=e.parse(this.strValue[d].substring(1,this.strValue[d].length-
1)):this.strValue[d]=e.parse(this.strValue[d]);this.containerControl=document.createElement("div");this.label=document.createElement("label");this.select=document.createElement("select");d=0;for(k=this.menuOptions.length;d<k;d++)g=document.createElement("option"),g.innerHTML=f.evalExpression(this.menuOptions[d]),this.select.appendChild(g);this.field=document.createElement("input");this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.select);this.visible&&this.containerControl.appendChild(this.field);
this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Menu,a.Control);a.Menu.prototype.init=function(b){f=this.evaluator;var c=f.evalExpression(this.name).toString();this.label.innerHTML=c;this.fieldFontSize=2!=this.parent.version?a.getFieldFontSize(this.h):10;var g=0,d=0,e=0;this.value=b?this.value:f.evalExpression(this.valueExpr);this.indexValue=this.getIndex(this.value);b=0;for(var k=this.menuOptions.length;b<k;b++)e=a.getTextWidth(f.evalExpression(this.menuOptions[b]).toString(),
this.fieldFontSize+"px Arial"),e>g&&(g=e,d=b);g+=25;e=a.getTextWidth(this.formatOutputValue(f.evalExpression(this.strValue[d])),this.fieldFontSize+"px Arial")+7;d=a.getTextWidth(c,this.fieldFontSize+"px Arial")+10;""==c&&(d=0);this.visible||(e=0);for(c=this.w-e-d;c<g&&0<d;)d--,c++;for(;c<g&&0<e;)e--,c++;for(;d+c+e+1<this.w;)c++,e++;g=d;b=g+c;e=this.w-b;k=this.formatOutputValue(f.evalExpression(this.strValue[this.indexValue]));this.containerControl.setAttribute("class","DescartesMenuContainer");this.containerControl.setAttribute("style",
"width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.label.setAttribute("class","DescartesMenuLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+d+"px; height: "+this.h+"px; line-height: "+this.h+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"_menuField");this.field.value=k;this.field.setAttribute("class","DescartesMenuField");this.field.setAttribute("style","font-size: "+
this.fieldFontSize+"px; width : "+e+"px; height : "+this.h+"px; left: "+b+"px;");this.field.setAttribute("tabindex",this.tabindex);this.select.setAttribute("id",this.id+"_menuSelect");this.select.setAttribute("class","DescartesMenuSelect");this.select.setAttribute("style","text-align: left; font-size: "+this.fieldFontSize+"px; line-height: "+this.h+"px; width : "+c+"px; height : "+this.h+"px; left: "+g+"px; border-color: #7a8a99; border-width: 1.5px; border-style: solid; background-color: #eeeeee;");
this.select.setAttribute("tabindex",this.tabindex);this.select.selectedIndex=this.indexValue;f.setVariable(this.id,parseFloat(k.replace(this.parent.decimal_symbol,".")));this.update()};a.Menu.prototype.update=function(){f=this.evaluator;this.activeIfValue=0<f.evalExpression(this.activeif);this.drawIfValue=0<f.evalExpression(this.drawif);this.field.disabled=this.activeIfValue?!1:!0;this.select.disabled=this.activeIfValue?!1:!0;this.drawIfValue?this.containerControl.style.display="block":(this.click=
!1,this.containerControl.style.display="none");this.updatePositionAndSize();if(!this.parent.animation.playing||document.activeElement!=this.select){this.label.innerHTML=f.evalExpression(this.name).toString();for(var a=0,b=this.menuOptions.length;a<b;a++)this.select.options[a].innerHTML=f.evalExpression(this.menuOptions[a]);this.value=f.getVariable(this.id);isNaN(this.value)&&(this.value=0);this.field.value=this.formatOutputValue(this.value);f.setVariable(this.id,parseFloat(this.value));this.select.selectedIndex=
parseFloat(this.getIndex(this.value))}this.ok=this.value==this.answer?1:0;this.evaluator.setVariable(this.id+".ok",this.ok)};a.Menu.prototype.customSplit=function(a){p=!1;h="";q=0;for(m=-1;q<a.length;){l=a.charAt(q);a.charAt(q-1);if("["===l&&-1===m){if(p||""!=h)h+="\u00a6";m++}else"["===l?m++:"]"===l&&0===m?(p=!0,m--):"]"==a.charAt(q)&&(m=0>m?m:m-1);h+=a.charAt(q);q++}return h.split("\u00a6")};a.Menu.prototype.getIndex=function(a){a=parseFloat(a.toString().replace(this.parent.decimal_symbol,"."));
c=-1;b=Infinity;for(var g=0,f=this.strValue.length;g<f;g++)k=d(a-parseFloat(this.evaluator.evalExpression(this.strValue[g]))),k<=b&&(b=k,c=g);return c};a.Menu.prototype.changeValue=function(){this.activeIfValue&&(this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction())};a.Menu.prototype.registerMouseAndTouchEvents=function(){g=a.hasTouchSupport;var b=this;b.select.oncontextmenu=b.label.oncontextmenu=b.field.oncontextmenu=function(){return!1};g?b.label.addEventListener("touchstart",
function(a){a.preventDefault();return!1}):b.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.select.addEventListener("change",function(a){b.value=b.evaluator.evalExpression(b.strValue[this.selectedIndex]);b.field.value=b.formatOutputValue(b.value);b.evaluator.setVariable(b.id,b.field.value);b.changeValue();a.preventDefault()});this.field.addEventListener("keydown",function(a){13==a.keyCode&&(b.indexValue=b.getIndex(b.field.value),b.value=b.evaluator.evalExpression(b.strValue[b.indexValue]),
b.field.value=b.formatOutputValue(b.indexValue),b.select.selectedIndex=b.indexValue,b.changeValue())});b.field.addEventListener("click",function(a){this.select();this.focus()});b.select.addEventListener("mouse",function(a){this.focus()})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor,e="h",f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v,w,y,C,A,D;a.Scrollbar=function(b,c){a.Control.call(this,b,c);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=
this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");this.orientation=this.w>=this.h?e:"v";this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.scrollManipulator=document.createElement("div");this.label=document.createElement("label");this.containerControl.appendChild(this.canvas);
this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.scrollManipulator);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Scrollbar,a.Control);a.Scrollbar.prototype.init=function(){f=this.evaluator;this.findOffset();0==f.evalExpression(this.decimals)?this.incr=1:this.incr=
(f.evalExpression(this.max)-f.evalExpression(this.min))/100;this.value=this.validateValue(f.evalExpression(this.valueExpr));b=this.formatOutputValue(this.value);k=this.evaluator.evalExpression(this.expresion);this.x=k[0][0];this.y=k[0][1];4==k[0].length&&(this.w=k[0][2],this.h=k[0][3]);this.orientation=this.w>=this.h?e:"v";this.initScroll(b);this.changeScrollPositionFromValue();this.prePos=this.pos;f.setVariable(this.id,this.value)};a.Scrollbar.prototype.initScroll=function(b){c=this;f=c.evaluator;
var g=f.evalExpression(c.name).toString();c.label.innerHTML=g;var d="v"===c.orientation?parseInt(19+5*(c.h-100)/100):c.h;c.fieldFontSize="v"===c.orientation?d-parseInt(c.h/20)-1:2!==c.parent.version?a.getFieldFontSize(d):10;var e=a.getTextWidth(b+"_",c.fieldFontSize+"px Arial"),k=c.parent.getSpaceById(c.spaceID).h;c.labelHeight=""==g?0:d;c.fieldHeight=""==c.visible?0:d;if("v"===c.orientation)c.canvasWidth=c.w,c.canvasHeight=c.h-c.labelHeight-c.fieldHeight,18<=c.canvasHeight+c.y-k&&(c.canvasHeight=
k),g=0,g=c.fieldHeight,e=g+c.canvasHeight,c.canvasX=0,c.canvasY=c.fieldHeight,c.labelWidth=c.w,c.labelY=e,c.upWidth=c.downW=c.w,c.upHeight=c.downH=15,c.upX=0,c.upY=c.fieldHeight,c.downX=0,c.downY=e-c.downH,c.fieldWidth=c.w,c.fieldX=0,c.scrollManipulatorW=c.w,c.scrollManipulatorH=parseInt((c.canvasHeight-c.upHeight-c.downH-c.labelHeight-c.fieldHeight)/10),c.scrollManipulatorH=15>c.scrollManipulatorH?15:c.scrollManipulatorH,c.scrollManipulatorLimInf=e-c.downH-c.scrollManipulatorH,c.scrollManipulatorLimSup=
g+c.downH;else{d=a.getTextWidth(g,c.fieldFontSize+"px Arial")+10;c.labelWidth=d;c.fieldWidth=e;""==g&&(c.labelWidth=0);c.visible||(c.fieldWidth=0);for(e=c.w-c.fieldWidth-c.labelWidth;58>e&&0<c.labelWidth;)c.labelWidth--,e++;for(;58>e&&0<c.fieldWidth;)c.fieldWidth--,e++;g=c.labelWidth;d=g+e;c.fieldWidth=c.w-d;c.canvasWidth=e;c.canvasHeight=c.h;c.canvasX=c.labelWidth;c.canvasY=0;c.fieldX=c.canvasWidth+c.labelWidth;c.labelHeight=c.h;c.labelY=0;c.upWidth=c.downW=15;c.upHeight=c.downH=c.h;c.upX=d-c.downW;
c.upY=0;c.downX=c.labelWidth;c.downY=0;c.scrollManipulatorW=parseInt((c.canvasWidth-c.upWidth-c.downW)/10);c.scrollManipulatorW=15>c.scrollManipulatorW?15:c.scrollManipulatorW;c.scrollManipulatorH=c.h;c.scrollManipulatorLimInf=g+c.downW;c.scrollManipulatorLimSup=g+c.canvasWidth-c.downW-c.scrollManipulatorW}c.containerControl.setAttribute("class","DescartesScrollbarContainer");c.containerControl.setAttribute("id",c.id);c.containerControl.setAttribute("style","width: "+c.w+"px; height: "+c.h+"px; left: "+
c.x+"px; top: "+c.y+"px; z-index: "+c.zIndex+";");c.canvas.setAttribute("width",c.w+"px");c.canvas.setAttribute("height",c.h+"px");c.canvas.setAttribute("style","position: absolute; left: 0px; top: 0px;");c.ctx=c.canvas.getContext("2d");c.divUp.setAttribute("class","DescartesCatcher up");c.divUp.setAttribute("style","width : "+c.upWidth+"px; height : "+c.upHeight+"px; left: "+c.upX+"px; top: "+c.upY+"px;");c.divDown.setAttribute("class","DescartesCatcher down");c.divDown.setAttribute("style","width : "+
c.downW+"px; height : "+c.downH+"px; left: "+c.downX+"px; top: "+c.downY+"px;");c.scrollManipulator.setAttribute("class","DescartesCatcher manipulator");c.scrollManipulator.setAttribute("style","width : "+c.scrollManipulatorW+"px; height : "+c.scrollManipulatorH+"px;");c.scrollManipulator.style.top=("v"===c.orientation?c.scrollManipulatorLimInf:0)+"px";c.scrollManipulator.style.left=("v"===c.orientation?0:c.scrollManipulatorLimInf)+"px";c.field.setAttribute("type","text");c.field.setAttribute("id",
c.id+"scrollbar");c.field.setAttribute("class","DescartesScrollbarField");c.field.setAttribute("style","font-size: "+c.fieldFontSize+"px; width : "+c.fieldWidth+"px; height : "+c.fieldHeight+"px; left: "+c.fieldX+"px; top: 0px;");c.field.value=b;0===c.fieldHeight&&(c.field.style.display="none");c.label.setAttribute("class","DescartesScrollbarLabel");c.label.setAttribute("style","font-size:"+c.fieldFontSize+"px; width: "+c.labelWidth+"px; height: "+c.labelHeight+"px; line-height: "+c.labelHeight+"px; left: 0px; top:"+
c.labelY+"px;")};a.Scrollbar.prototype.update=function(){f=this.evaluator;this.label.innerHTML=f.evalExpression(this.name).toString();0==f.evalExpression(this.decimals)?this.incr=1:this.incr=(f.evalExpression(this.max)-f.evalExpression(this.min))/100;this.activeIfValue=0<f.evalExpression(this.activeif);this.drawIfValue=0<f.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):this.containerControl.style.display=
"none";this.updatePositionAndSize();var a=this.validateValue(f.getVariable(this.id));a==this.value||0<Math.abs(a-this.value)&&1E-9>Math.abs(a-this.value)||(this.value=a,this.changeScrollPositionFromValue(),this.prePos=this.pos);this.value=a;this.field.value=this.formatOutputValue(this.value);f.setVariable(this.id,this.value)};a.Scrollbar.prototype.draw=function(){c=this;g=c.ctx;h=d(this.w);p=d(this.h);g.fillStyle="#e0e4e8";g.fillRect(0,0,h,p);g.strokeStyle="#7a8a99";c.down&&(g.fillStyle="#ccdcec",
g.fillRect(c.downX+0.5,c.downY+0.5,c.downW,c.downH-1));g.strokeRect(c.downX+0.5,c.downY+0.5,c.downW,c.downH-1);c.up&&(g.fillStyle="#ccdcec",g.fillRect(c.upX+0.5,c.upY-0.5,c.upWidth,c.upHeight+1));g.strokeRect(c.upX+0.5,c.upY-0.5,c.upWidth,c.upHeight+1);q=4;g.fillStyle="black";g.beginPath();c.orientation===e?(g.moveTo(c.downX+q,c.downH/2),g.lineTo(c.downX+c.downW-q,q),g.lineTo(c.downX+c.downW-q,c.downH-q),g.moveTo(c.upX+c.upWidth-q,c.downH/2),g.lineTo(c.upX+q,q),g.lineTo(c.upX+q,c.downH-q),g.fill(),
c.activeIfValue&&(m=d(c.pos),g.fillStyle="#ccdcec",g.fillRect(m+0.5,0,d(c.scrollManipulatorW),p),g.strokeStyle="#6382bf",g.strokeRect(m+0.5,0,d(c.scrollManipulatorW),p),l=d(c.scrollManipulatorW/2),g.beginPath(),g.moveTo(m+l+0.5-2,3),g.lineTo(m+l+0.5-2,p-3),g.moveTo(m+l+0.5,3),g.lineTo(m+l+0.5,p-3),g.moveTo(m+l+0.5+2,3),g.lineTo(m+l+0.5+2,p-3),g.stroke())):(g.moveTo(c.downX+c.downW/2,c.downY+c.downH-q),g.lineTo(c.downX+q,c.downY+q),g.lineTo(c.downX+c.downW-q,c.downY+q),g.moveTo(c.upX+c.upWidth/2,c.upY+
q),g.lineTo(c.upX+q,c.upY+c.upHeight-q),g.lineTo(c.upX+c.upWidth-q,c.upY+c.upHeight-q),g.fill(),c.activeIfValue&&(m=d(c.pos),g.fillStyle="#ccdcec",g.fillRect(0,m+0.5,h,d(c.scrollManipulatorH)),g.strokeStyle="#6382bf",g.strokeRect(0,m+0.5,h,d(c.scrollManipulatorH)),l=d(c.scrollManipulatorH/2),g.beginPath(),g.moveTo(3,m+l+0.5-2),g.lineTo(h-3,m+l+0.5-2),g.moveTo(3,m+l+0.5),g.lineTo(h-3,m+l+0.5),g.moveTo(3,m+l+0.5+2),g.lineTo(h-3,m+l+0.5+2),g.stroke()));g.strokeRect(0.5,0.5,h-1,p-1);c.activeIfValue||
(g.fillStyle="rgba(240,240,240,"+160/255+")",g.fillRect(0,0,h,p.h))};a.Scrollbar.prototype.validateValue=function(a){f=this.evaluator;s=a.toString();s=parseFloat(s.replace(this.parent.decimal_symbol,"."));isNaN(s)&&(s=0);this.minimo=f.evalExpression(this.min);s<this.minimo&&(this.value=null,s=this.minimo);this.maximo=f.evalExpression(this.max);s>this.maximo&&(this.value=null,s=this.maximo);t=this.incr;s=0!=t?s*t/t:0;this.fixed&&(s=parseFloat(parseFloat(s).toFixed(f.evalExpression(this.decimals))));
return s};a.Scrollbar.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.incr)};a.Scrollbar.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-this.incr)};a.Scrollbar.prototype.increase10=function(){q=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;this.orientation==e?this.clickPos.x>this.prePos&&this.changeValue(parseFloat(this.value)+q):this.clickPos.y<this.prePos&&this.changeValue(parseFloat(this.value)+q)};a.Scrollbar.prototype.decrease10=
function(){q=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;this.orientation==e?this.clickPos.x<this.prePos&&this.changeValue(parseFloat(this.value)-q):this.clickPos.y>this.prePos&&this.changeValue(parseFloat(this.value)-q)};a.Scrollbar.prototype.changeValue=function(a){this.activeIfValue&&(n=this.validateValue(a),n!=this.value&&(this.value=n,this.field.value=this.formatOutputValue(n),this.changeScrollPositionFromValue(),this.prePos=this.pos,this.evaluator.setVariable(this.id,
this.value),this.updateAndExecAction()))};a.Scrollbar.prototype.changeValueForScrollMovement=function(){f=this.evaluator;u=this.scrollManipulatorLimInf;r=this.scrollManipulatorLimSup;v=f.evalExpression(this.min);w=f.evalExpression(this.max);t=this.incr;n=d((this.pos-u)*(w-v)/(r-u)/t)*t+v;n!=this.value&&(this.value=n,this.field.value=this.formatOutputValue(n),f.setVariable(this.id,this.value),this.parent.updateControls(),this.actionExec.execute(),this.parent.update())};a.Scrollbar.prototype.changeScrollPositionFromValue=
function(){f=this.evaluator;u=this.scrollManipulatorLimInf;r=this.scrollManipulatorLimSup;v=f.evalExpression(this.min);w=f.evalExpression(this.max);t=this.incr;this.pos=(this.value-v)*(r-u)/(w-v)+u;this.orientation==e?this.scrollManipulator.style.left=this.pos+"px":this.scrollManipulator.style.top=this.pos+"px"};a.Scrollbar.prototype.registerMouseAndTouchEvents=function(){function b(a,c,g,d){clearInterval(w);(t.up||t.down||t.canvasClick)&&1E-7<Math.abs(t.value-d)&&(c.call(t),a=g?a:30,w=setTimeout(function(){b(a,
c,!1,d)},a))}function c(g){g.preventDefault();t.whichButton=a.whichButton(g);"L"==t.whichButton&&t.activeIfValue&&(t.clickPos=t.getCursorPosition(g),t.canvasClick=!0,t.orientation==e?t.clickPos.x<t.prePos?b(u,t.decrease10,!0,t.minimo):b(u,t.increase10,!0,t.maximo):t.clickPos.y<t.prePos?b(u,t.increase10,!0,t.maximo):b(u,t.decrease10,!0,t.minimo))}function g(a){t.canvasClick=!1;clearInterval(w);a.preventDefault()}function d(a){!0==t.canvasClick&&(t.clickPos=t.getCursorPosition(a),a.preventDefault())}
function f(a){t.activeIfValue&&(t.scrollClick=!0,t.initPos=t.getCursorPosition(a),window.addEventListener("mouseup",h),window.addEventListener("mousemove",m),a.preventDefault())}function k(a){t.activeIfValue&&(t.scrollClick=!0,t.initPos=t.getCursorPosition(a),window.addEventListener("touchend",p),window.addEventListener("touchmove",onToucheMove_scrollManipulator),a.preventDefault())}function h(a){t.scrollClick=!1;t.prePos=t.pos;window.removeEventListener("mouseup",h,!1);window.removeEventListener("mousemove",
m,!1);a.preventDefault()}function p(a){t.scrollClick=!1;t.prePos=t.pos;window.removeEventListener("touchend",p,!1);window.removeEventListener("touchmove",m,!1);a.preventDefault()}function m(a){var b=t.getCursorPosition(a);t.orientation==e?(t.pos=t.prePos-(t.initPos.x-b.x),t.pos<t.scrollManipulatorLimInf&&(t.pos=t.scrollManipulatorLimInf),t.pos>t.scrollManipulatorLimSup&&(t.pos=t.scrollManipulatorLimSup),t.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+
t.scrollManipulatorW+"px; height : "+t.h+"px; left: "+t.pos+"px; top: 0px;")):(t.pos=t.prePos-(t.initPos.y-b.y),t.pos>t.scrollManipulatorLimInf&&(t.pos=t.scrollManipulatorLimInf),t.pos<t.scrollManipulatorLimSup&&(t.pos=t.scrollManipulatorLimSup),t.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+t.w+"px; height : "+t.scrollManipulatorH+"px; left: 0px; top: "+t.pos+"px;"));t.changeValueForScrollMovement();a.preventDefault()}
function n(c){c.preventDefault();t.whichButton=a.whichButton(c);"L"==t.whichButton&&t.activeIfValue&&(t.up=!0,b(u,t.increase,!0,t.maximo))}function q(c){c.preventDefault();t.whichButton=a.whichButton(c);"L"==t.whichButton&&t.activeIfValue&&(t.down=!0,b(u,t.decrease,!0,t.minimo))}function l(a){t.up=!1;clearInterval(w);a.preventDefault()}function r(a){t.down=!1;clearInterval(w);a.preventDefault()}function s(a){t.up=!1;clearInterval(w);a.preventDefault();t.draw()}function v(a){t.down=!1;clearInterval(w);
a.preventDefault();t.draw()}y=a.hasTouchSupport;var t=this,u=y?500:200,w;t.canvas.oncontextmenu=t.divUp.oncontextmenu=t.divDown.oncontextmenu=t.label.oncontextmenu=t.field.oncontextmenu=t.scrollManipulator.oncontextmenu=function(){return!1};this.field.addEventListener("keydown",function(a){13==a.keyCode&&t.changeValue(t.field.value)});y?this.canvas.addEventListener("touchstart",c):this.canvas.addEventListener("mousedown",c);y||this.divDown.addEventListener("mouseout",r);y?window.addEventListener("touchend",
g):window.addEventListener("mouseup",g);y?this.canvas.addEventListener("touchmove",d):this.canvas.addEventListener("mousemove",d);y?this.scrollManipulator.addEventListener("touchstart",k):this.scrollManipulator.addEventListener("mousedown",f);y?this.divUp.addEventListener("touchstart",n):this.divUp.addEventListener("mousedown",n);y?this.divDown.addEventListener("touchstart",q):this.divDown.addEventListener("mousedown",q);y||this.divUp.addEventListener("mouseout",l);y||this.divDown.addEventListener("mouseout",
r);y?window.addEventListener("touchend",s):window.addEventListener("mouseup",s);y?window.addEventListener("touchend",v):window.addEventListener("mouseup",v)};a.Scrollbar.prototype.findOffset=function(){C=this.containerControl;this.offsetTop=this.offsetLeft=0;A=this.containerControl.style.display;for(this.containerControl.style.display="block";C;)this.offsetLeft+=C.offsetLeft||0,this.offsetTop+=C.offsetTop||0,C=C.parentNode;this.containerControl.style.display=A};a.Scrollbar.prototype.getCursorPosition=
function(b){D=a.getCursorPosition(b);return{x:D.x-this.offsetLeft,y:D.y-this.offsetTop}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d;a.Audio=function(d,c){this.controls=!0;this.file="";this.oldDrawIf=0;a.Control.call(this,d,c);var b=this,e=b.evaluator.evalExpression(b.expresion);4==e[0].length?(b.w=e[0][2],b.h=e[0][3]):(b.w=200,b.h=28);b.audio=b.parent.getAudio(b.file);b.autoplay&&(b.audio.setAttribute("autoplay","autoplay"),b.audio.play());b.loop&&b.audio.setAttribute("loop",
"loop");b.controls&&b.audio.setAttribute("controls","controls");b.audio.setAttribute("style","position: absolute; width: "+b.w+"px; left: "+b.x+"px; top: "+b.y+"px; z-index: "+b.zIndex+";");b.addControlContainer(b.audio);b.evaluator.setFunction(b.id+".play",function(){b.audio.play();return 0});b.evaluator.setFunction(b.id+".pause",function(){b.audio.pause();return 0});b.evaluator.setFunction(b.id+".stop",function(){b.audio.pause();return b.audio.currentTime=0});b.audio.addEventListener("timeupdate",
function(a){b.evaluator.setVariable(b.id+".currentTime",b.audio.currentTime)})};a.extend(a.Audio,a.Control);a.Audio.prototype.init=function(){this.audio.style.left=this.x+"px";this.audio.style.top=this.y+"px";this.update()};var e;a.Audio.prototype.update=function(){d=this.evaluator;(e=0<d.evalExpression(this.drawif))?this.audio.style.display="block":(this.audio.style.display="none",e!==this.oldDrawIf&&this.audio.pause());this.oldDrawIf=e;this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var d;a.Video=function(f,c){this.controls=!0;this.file="";this.oldDrawIf=0;a.Control.call(this,f,c);var b=this;d=b.evaluator;var e=b.evaluator.evalExpression(b.expresion);4==e[0].length?(b.w=e[0][2],b.h=e[0][3]):(b.w=null,b.h=null);b.video=document.createElement("video");b.autoplay&&b.video.setAttribute("autoplay","autoplay");b.loop&&b.video.setAttribute("loop","loop");b.controls&&b.video.setAttribute("controls","controls");b.poster&&b.video.setAttribute("poster",
b.poster);b.w&&(b.video.setAttribute("width",b.w),b.video.setAttribute("height",b.h));b.video.setAttribute("style","position: absolute; overflow: hidden; left: "+b.x+"px; top: "+b.y+"px;");var e=b.file,g=e.lastIndexOf(".");-1!=g&&(e=b.file.substring(0,g));b.video.canPlayType("video/mp4")&&(g=document.createElement("source"),g.setAttribute("src",e+".mp4"),g.setAttribute("type","video/mp4"),b.video.appendChild(g));b.video.canPlayType("video/ogg")&&(g=document.createElement("source"),g.setAttribute("src",
e+".ogg"),g.setAttribute("type","video/ogg"),b.video.appendChild(g),g=document.createElement("source"),g.setAttribute("src",e+".ogv"),g.setAttribute("type","video/ogg"),b.video.appendChild(g));b.video.canPlayType("video/webm")&&(g=document.createElement("source"),g.setAttribute("src",e+".webm"),g.setAttribute("type","video/webm"),b.video.appendChild(g));b.addControlContainer(b.video);b.evaluator.setFunction(b.id+".play",function(){b.video.play();return 0});b.evaluator.setFunction(b.id+".pause",function(){b.video.pause();
return 0});b.evaluator.setFunction(b.id+".stop",function(){b.video.pause();return b.video.currentTime=0});b.video.addEventListener("timeupdate",function(a){b.evaluator.setVariable(b.id+".currentTime",b.video.currentTime)})};a.extend(a.Video,a.Control);a.Video.prototype.init=function(){this.video.style.left=this.x+"px";this.video.style.top=this.y+"px";this.update()};var e;a.Video.prototype.update=function(){d=this.evaluator;e=0<d.evalExpression(this.drawif);0<d.evalExpression(this.drawif)?this.video.style.display=
"block":(this.video.style.display="none",e!==this.oldDrawIf&&this.video.pause());this.oldDrawIf=e;this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e;a.TextArea=function(d,c){this.font="Monospaced,PLAIN,12";a.Control.call(this,d,c);this.region="interior";this.tabindex=++this.parent.tabindex;if(this.answer){this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7)));var b=this.parent.lessonParser.parseText(this.answer)}this.containerControl=
document.createElement("div");this.textArea=document.createElement("div");this.textAreaAnswer=document.createElement("div");this.showButton=document.createElement("div");this.activeCover=document.createElement("div");this.containerControl.appendChild(this.textArea);this.containerControl.appendChild(this.textAreaAnswer);this.containerControl.appendChild(this.showButton);this.containerControl.appendChild(this.activeCover);this.addControlContainer(this.containerControl);this.showAnswer=!1;this.text=
void 0==this.text||"simpleText"==this.text.type?this.rawText||"":this.text.hasFormula?this.rawText:this.text.toHTML();b&&"simpleText"!=b.type&&(this.answer=this.text.hasFormula?"":b.toHTML());this.evaluator.setVariable(this.id,this.text);this.drawButton();this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextArea,a.Control);a.TextArea.prototype.init=function(){e=this.answer?28:8;d=this.evaluator;var f;f=this.text.match(/<span/)?this.text:this.text.replace(/\\n/g,"<br/>");this.containerControl.setAttribute("class",
"DescartesTextAreaContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=0<d.evalExpression(this.drawif)?"block":"none";this.containerControl.setAttribute("spellcheck","false");this.textArea.setAttribute("class","DescartesTextAreaContainer");this.textArea.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-e)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+
a.convertFont(this.font)+";");this.textArea.setAttribute("contenteditable","true");this.textArea.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;' >"+f+"</span>";this.textAreaAnswer.setAttribute("class","DescartesTextAreaContainer");this.textAreaAnswer.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-e)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");this.textAreaAnswer.style.display=
this.showAnswer?"block":"none";this.textAreaAnswer.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;'>"+this.answer+"</span>";this.showButton.setAttribute("style","width: 20px; height: 16px; position: absolute; bottom: 4px; right: 4px; cursor: pointer;");this.showButton.style.backgroundImage="url("+this.imageUnPush+")";this.showButton.style.display=this.answer?"block":"none";this.showButton.innerHTML="<span style='position: relative; top: 2px; text-align: center; font: 9px Arial'> S </span>";
this.activeCover.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px;");this.update()};a.TextArea.prototype.drawButton=function(){var d=document.createElement("canvas");d.setAttribute("width",20);d.setAttribute("height",16);var c=d.getContext("2d");this.canvas=d;this.ctx=c;this.createGradient(20,16);c.lineWidth=1;c.fillStyle="white";c.fillRect(0,0,20,16);c.fillStyle=this.linearGradient;c.fillRect(0,0,20,16);a.drawLine(c,19,0,19,
16,"rgba(0,0,0,"+128/255+")");a.drawLine(c,0,0,0,16,"rgba(0,0,0,"+24/255+")");a.drawLine(c,1,0,1,16,"rgba(0,0,0,"+8/255+")");this.imageUnPush=d.toDataURL();c.fillStyle="white";c.fillRect(0,0,20,16);c.fillStyle=this.linearGradient;c.fillRect(0,0,20,16);a.drawLine(c,0,0,0,14,"gray");a.drawLine(c,0,0,19,0,"gray");c.fillStyle="rgba(0, 0, 0,"+24/255+")";c.fillRect(0,0,this.w,this.h);this.imagePush=d.toDataURL()};a.TextArea.prototype.update=function(){d=this.evaluator;this.activeIfValue=0<d.evalExpression(this.activeif);
this.drawIfValue=0<d.evalExpression(this.drawif);var a;a=this.text.match(/<span/)?this.rawText:this.text;d.setVariable(this.id,a);this.activeCover.style.display=this.activeIfValue?"none":"block";this.containerControl.style.display=this.drawIfValue?"block":"none";this.updatePositionAndSize()};a.TextArea.prototype.registerMouseAndTouchEvents=function(){function a(b){b.preventDefault();c.showButton.style.backgroundImage="url("+c.imageUnPush+")"}var c=this;this.showButton.addEventListener("mousedown",
function(a){a.preventDefault();c.showAnswer=!c.showAnswer;c.textAreaAnswer.style.display=c.showAnswer?"block":"none";c.showButton.childNodes[0].childNodes[0].textContent=c.showAnswer?"T":"S";c.showButton.style.backgroundImage="url("+c.imagePush+")"});this.showButton.addEventListener("mouseup",a);this.showButton.addEventListener("mouseout",a)};a.TextArea.prototype.getScreenshot=function(){var a=document.createElement("canvas");a.setAttribute("width",this.w);a.setAttribute("height",this.h);var c=a.getContext("2d");
c.fillStyle="white";c.strokeStyle="black";c.lineWidth=1;c.fillRect(0,0,this.w,this.h);c.strokeRect(0,0,this.w,this.h);return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=2*Math.PI,e,f,c,b,k,g,p,h,q;a.GraphicControl=function(b,c){f=b.evaluator.parser;this.text=this.spaceID="";this.size=f.parse("4");this.font="Monospaced,PLAIN,12";this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";a.Control.call(this,b,c);this.touchId=null;this.font=
a.convertFont(this.font);if(this.constraintExpr){this.constraint=f.parse(this.constraintExpr);"(expr)"==this.constraint.type&&(this.constraint=f.parse(this.constraintExpr.substring(1,this.constraintExpr.length-1)));if("compOperator"==this.constraint.type){var g=this.constraint.childs[0],d=this.constraint.childs[1];"identifier"!=g.type||"y"!=g.value||d.contains("y")?"identifier"!=g.type||"x"!=g.value||d.contains("x")?this.newt=new a.R2Newton(this.evaluator,this.constraint):(this.evalConstraint=this.evalConstraintY,
this.constraint=d):(this.evalConstraint=this.evalConstraintX,this.constraint=d)}else this.constraint=null;h=new a.R2(0,0)}this.container=this.getContainer();this.mouseCacher=document.createElement("div");this.mouseCacher.setAttribute("class","DescartesGraphicControl");this.mouseCacher.setAttribute("id",this.id);this.mouseCacher.setAttribute("dragged",!0);this.mouseCacher.setAttribute("tabindex","-1");this.ctx=this.space.ctx;this.container.appendChild(this.mouseCacher);this.registerMouseAndTouchEvents();
this.xString=this.id+".x";this.yString=this.id+".y";this.activoString=this.id+".activo";this.activeString=this.id+".active";""!==this.space.id&&2!==b.version?(this.mxString=this.space.id+".mouse_x",this.myString=this.space.id+".mouse_y",this.mclickedString=this.space.id+".mouse_clicked",this.mclicizquierdoString=this.space.id+".clic_izquierdo"):(this.mxString="mouse_x",this.myString="mouse_y",this.mclickedString="mouse_clicked",this.mclicizquierdoString="clic_izquierdo");this.init()};a.GraphicControl.prototype.init=
function(){e=this.evaluator;q=a.hasTouchSupport;var b=e.evalExpression(this.expresion);this.x=b[0][0];this.y=b[0][1];e.setVariable(this.xString,this.x);e.setVariable(this.yString,this.y);""==this.imageSrc||this.imageSrc.toLowerCase().match(/vacio.gif$/)?(this.width=2*e.evalExpression(this.size),this.height=2*e.evalExpression(this.size)):(this.image=this.parent.getImage(this.imageSrc),this.width=this.image.width,this.height=this.image.height);this._w=q&&70>this.width?70:this.width;this._h=q&&70>this.height?
70:this.height;this.mouseCacher.setAttribute("style","cursor: pointer; background-color: rgba(255, 255, 255, 0); width: "+this._w+"px; height: "+this._h+"px; z-index: "+this.zIndex+";");this.mouseCacher.style.left=parseInt(this.space.getAbsoluteX(this.x)-this._w/2)+"px";this.mouseCacher.style.top=parseInt(this.space.getAbsoluteY(this.y)-this._h/2)+"px";e.setVariable(this.activoString,0);e.setVariable(this.activeString,0);this.setImage=!1;this.update()};a.GraphicControl.prototype.update=function(){e=
this.evaluator;this.activeIfValue=0<e.evalExpression(this.activeif);this.drawIfValue=0<e.evalExpression(this.drawif);this.x=e.getVariable(this.xString);this.y=e.getVariable(this.yString);c=this.space.getAbsoluteX(this.x);b=this.space.getAbsoluteY(this.y);this.mouseCacher.style.display=this.activeIfValue?"block":"none";this.mouseCacher.style.left=parseInt(c-this._w/2)+"px";this.mouseCacher.style.top=parseInt(b-this._h/2)+"px";this.constraint&&this.evalConstraint();this.draw()};a.GraphicControl.prototype.draw=
function(){e=this.evaluator;this.drawIfValue&&(g=this.ctx,p=this.space.backgroundCtx,c=parseInt(this.space.getAbsoluteX(this.x))+0.5,b=parseInt(this.space.getAbsoluteY(this.y))+0.5,""!=this.text&&this.drawText(c,b),this.image.ready?(this.image.complete&&!this.setImage&&g.drawImage(this.image,parseInt(c-this.image.width/2),parseInt(b-this.image.height/2)),this.trace&&(p.save(),p.translate(c,b),p.scale(parseInt(this.image.width/2),parseInt(this.image.height/2)),p.beginPath(),p.arc(0,0,1,0,d,!1),p.restore(),
p.lineWidth=1,p.strokeStyle=this.trace.getColor(),p.stroke())):(g.beginPath(),g.arc(c,b,parseInt(this.width/2),0,d,!1),g.fillStyle=this.colorInt.getColor(),g.fill(),g.lineWidth=1,g.strokeStyle=this.color.getColor(),g.stroke(),this.active&&(g.beginPath(),g.arc(c,b,parseInt(this.width/2)-2,0,d,!1),g.strokeStyle=this.colorInt.borderColor(),g.stroke()),this.trace&&(p.lineWidth=1,p.strokeStyle=this.trace.getColor(),p.beginPath(),p.arc(c,b,parseInt(this.width/2),0,d,!1),p.stroke())))};a.GraphicControl.prototype.evalConstraint=
function(){h.set(this.x,this.y);k=this.newt.findZero(h,1/this.space.scale,!0);this.x=k.x;this.y=k.y;this.evaluator.setVariable(this.xString,this.x);this.evaluator.setVariable(this.yString,this.y)};a.GraphicControl.prototype.evalConstraintX=function(){var a=this.evaluator.getVariable("x");this.evaluator.setVariable("x",this.x);this.y=this.evaluator.evalExpression(this.constraint);this.evaluator.setVariable(this.xString,this.x);this.evaluator.setVariable(this.yString,this.y);this.evaluator.setVariable("x",
a)};a.GraphicControl.prototype.evalConstraintY=function(){var a=this.evaluator.getVariable("y");this.evaluator.setVariable("y",this.y);this.x=this.evaluator.evalExpression(this.constraint);this.evaluator.setVariable(this.xString,this.x);this.evaluator.setVariable(this.yString,this.y);this.evaluator.setVariable("y",a)};a.GraphicControl.prototype.drawText=function(a,b){g=this.ctx;e=this.evaluator;g.fillStyle=this.color.getColor();g.font=this.font;g.textBaseline="alphabetic";g.fillText(e.evalExpression(this.text[0],
e.evalExpression(this.decimals),this.fixed),parseInt(a+1+this.width/2),parseInt(b-1-this.height/2))};a.GraphicControl.prototype.getContainer=function(){for(var a=this.parent.spaces,b,c=0,g=a.length;c<g;c++)if(b=a[c],b.id==this.spaceID)return b.addCtr(this),this.zIndex=b.zIndex,this.space=b,b.graphicControlContainer;a[0].addCtr(this);this.zIndex=a[0].zIndex;this.space=a[0];return a[0].graphicControlContainer};a.GraphicControl.prototype.deactivate=function(){this.active=!1;this.evaluator.setVariable(this.activoString,
0);this.evaluator.setVariable(this.activeString,0)};a.GraphicControl.prototype.registerMouseAndTouchEvents=function(){function b(c){document.body.focus();c.preventDefault();h.whichButton=a.whichButton(c);"L"==h.whichButton&&h.activeIfValue&&h.over&&(h.parent.deactivateGraphiControls(),h.click=!0,h.active=!0,h.evaluator.setVariable(h.activoString,1),h.evaluator.setVariable(h.activeString,1),h.evaluator.setVariable(h.mclickedString,0),h.evaluator.setVariable(h.mclicizquierdoString,0),h.posAnte=h.getCursorPosition(c),
h.prePos={x:h.space.getAbsoluteX(h.x),y:h.space.getAbsoluteY(h.y)},h.evaluator.setVariable(h.mxString,h.space.getRelativeX(h.posAnte.x)),h.evaluator.setVariable(h.myString,h.space.getRelativeY(h.posAnte.y)),h.parent.update(),window.addEventListener("mouseup",g),window.addEventListener("mousemove",d))}function c(a){document.body.focus();a.preventDefault();h.activeIfValue&&(h.parent.deactivateGraphiControls(),h.click=!0,h.active=!0,h.evaluator.setVariable(h.activoString,1),h.evaluator.setVariable(h.activeString,
1),h.evaluator.setVariable(h.mclickedString,0),h.evaluator.setVariable(h.mclicizquierdoString,0),h.posAnte=h.getCursorPosition(a),h.prePos={x:h.space.getAbsoluteX(h.x),y:h.space.getAbsoluteY(h.y)},h.evaluator.setVariable(h.mxString,h.space.getRelativeX(h.posAnte.x)),h.evaluator.setVariable(h.myString,h.space.getRelativeY(h.posAnte.y)),h.parent.update(),window.addEventListener("touchmove",d),window.addEventListener("touchend",g))}function g(b){document.body.focus();b.preventDefault();h.touchId=null;
h.evaluator.setVariable(h.mclickedString,1);h.evaluator.setVariable(h.mclicizquierdoString,1);if(h.activeIfValue||h.active)h.click=!1,a.hasTouchSupport?(window.removeEventListener("touchmove",d,!1),window.removeEventListener("touchend",g,!1)):(window.removeEventListener("mouseup",g,!1),window.removeEventListener("mousemove",d,!1)),h.evaluator.setVariable(h.mxString,h.space.getRelativeX(h.posAnte.x)+h.x),h.evaluator.setVariable(h.myString,h.space.getRelativeY(h.posAnte.y)+h.y),h.parent.update(),h.mouseCacher.style.left=
h.space.getAbsoluteX(h.x)-h._w/2+"px",h.mouseCacher.style.top=h.space.getAbsoluteY(h.y)-h._h/2+"px"}function d(a){a.preventDefault();a.touchId=h.touchId;h.evaluator.setVariable(h.mclickedString,0);h.evaluator.setVariable(h.mclicizquierdoString,0);p=h.getCursorPosition(a);h.posX=h.prePos.x-(h.posAnte.x-p.x);h.posY=h.prePos.y-(h.posAnte.y-p.y);h.evaluator.setVariable(h.xString,h.space.getRelativeX(h.posX));h.evaluator.setVariable(h.yString,h.space.getRelativeY(h.posY));h.evaluator.setVariable(h.mxString,
h.space.getRelativeX(h.posAnte.x)+h.space.getRelativeX(h.posX));h.evaluator.setVariable(h.myString,h.space.getRelativeY(h.posAnte.y)+h.space.getRelativeY(h.posY));10<Date.now()-k&&(h.parent.updateControls(),h.parent.update(),k=Date.now())}function f(a){h.over=!0}function e(a){h.over=!1;h.click=!1}var k=0,h=this;this.active=this.over=this.click=!1;this.mouseCacher.oncontextmenu=function(){return!1};a.hasTouchSupport?this.mouseCacher.addEventListener("touchstart",c):(this.mouseCacher.addEventListener("mousedown",
b),this.mouseCacher.addEventListener("mouseover",f),this.mouseCacher.addEventListener("mouseout",e));var p};a.GraphicControl.prototype.getCursorPosition=function(a){if(a.touches){var b;if(a.touchId)for(c=0,g=a.touches.length;c<g;c++){if(a.touches[c].identifier==a.touchId){b=a.touches[c];break}}else for(var c=0,g=a.touches.length;c<g;c++)if(a.target==a.touches[c].target){b=a.touches[c];this.touchId=b.identifier;break}mouseX=b.pageX;mouseY=b.pageY}else void 0!=a.pageX&&void 0!=a.pageY?(mouseX=a.pageX,
mouseY=a.pageY):(mouseX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,mouseY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:mouseX-(this.space.container.offsetLeft+this.space.container.parentNode.offsetLeft),y:mouseY-(this.space.container.offsetTop+this.space.container.parentNode.offsetTop)}};return a}(descartesJS||{}),descartesJS=function(a,d){var e,f,c,b,k,g,p,h,q,m;if(a.loadLib)return a;var l,s,t,n,u,r,v,w,y=/[\w-//]*(\.png|\.jpg|\.gif|\.svg)/gi,
C,A,D,E,z,B,G,H,K,L,x,J,F,P,M,I,R,S,O,Q,N;a.LessonParser=function(b){this.parent=b;this.parser=b.evaluator.parser;this.RTFparser=new a.RTFParser(b.evaluator)};a.LessonParser.prototype.parseButtonsConfig=function(a){var b={rowsNorth:0,rowsSouth:0,widthEast:125,widthWest:125,height:23};a=this.split(a);for(var c=0,g=a.length;c<g;c++)switch(t=a[c][0],n=a[c][1],s=d[t],s){case "rowsNorth":case "rowsSouth":case "widthEast":case "widthWest":case "height":b[s]=parseInt(n);break;case "about":case "config":case "init":case "clear":b[s]=
"true"===d[n];break;default:console.log("----- attributo de space no identificado: <"+t+"> valor: <"+n+"> -----")}return b};a.LessonParser.prototype.parseSpace=function(b){u={};b=this.split(b);for(var c=0,g=b.length;c<g;c++)switch(t=b[c][0],n=b[c][1],s=d[t],s){case "type":case "id":case "cID":case "file":u[s]=n;break;case "fixed":case "numbers":case "sensitive_to_mouse_movements":case "R3":case "split":u[s]="true"===d[n];break;case "bg_display":case "render":u[s]=d[n];break;case "net":case "net10":case "axes":case "text":u[s]=
""!=n?"false"===d[n]?"":new a.Color(n,this.parent.evaluator):"";break;case "x_axis":case "y_axis":u[s]="false"===d[n]?"":n;break;case "O.x":u.OxExpr=n;break;case "O.y":u.OyExpr=n;break;case "image":u.imageSrc=n;break;case "x":l=n;l="%"===l[l.length-1]?(this.parent.container.width*parseFloat(l)/100).toString():n;u.xExpr=this.parser.parse(l);break;case "y":l=n;l="%"===l[l.length-1]?(this.parent.container.height*parseFloat(l)/100).toString():n;u.yExpr=this.parser.parse(l);break;case "width":l=n;"%"===
l[l.length-1]?(u.wExpr=l,l=this.parent.container.width*parseFloat(l)/100):(l=parseFloat(n),l!=n&&(l=this.parent.container.width));u.w=l;break;case "height":l=n;"%"===l[l.length-1]?(u.hExpr=l,l=this.parent.container.height*parseFloat(l)/100):(l=parseFloat(n),l!=n&&(l=this.parent.container.height));u.h=l;break;case "drawif":""!=n&&(u.drawif=this.parser.parse(n));break;case "scale":l=parseFloat(n);isNaN(l)&&(l=48);u.scale=l;break;case "background":u.background=new a.Color(n,this.parent.evaluator);break;
default:console.log("----- attributo de space no identificado: <"+t+"> valor: <"+n+"> -----")}switch(u.type){case "R2":return new a.Space2D(this.parent,u);case "R3":return new a.Space3D(this.parent,u);case "AP":return new a.SpaceAP(this.parent,u);case "HTMLIFrame":return new a.SpaceHTML_IFrame(this.parent,u);default:return new a.Space2D(this.parent,u)}};a.LessonParser.prototype.parseControl=function(b){r={type:"numeric"};b=this.split(b);for(var c=0,g=b.length;c<g;c++)switch(t=b[c][0],n=b[c][1],s=
d[t],s){case "id":case "name":case "parameter":case "tooltip":case "tooltipFont":case "Explanation":case "ExplanationFont":case "cID":case "options":case "font":case "file":case "answer":r[s]=n;break;case "gui":case "region":case "action":case "msg_pos":case "poster":r[s]=d[n];break;case "fixed":case "visible":case "discrete":case "onlyText":case "evaluate":case "autoplay":case "loop":case "controls":r[s]="true"===d[n];break;case "color":case "colorInt":case "trace":r[s]=new a.Color(n,this.parent.evaluator);
break;case "font_size":case "drawif":case "activeif":case "decimals":case "min":case "max":case "size":""!=n&&(r[s]=this.parser.parse(n));break;case "constraint":r.constraintExpr=n;break;case "image":r.imageSrc=n;break;case "space":r.spaceID=n;break;case "type":r.type=d[n.trim()];break;case "expresion":r.expresion=this.parser.parse(n.replace(")(",","));break;case "bold":"false"!=d[n]&&(r.bold="bold");break;case "italics":"false"!=d[n]&&(r.italics="italic");break;case "underlined":"false"!=d[n]&&(r.underlined=
!0);break;case "value":var f=n.replace(/&squot;/g,"'");f.match(/^\|/)&&(f="'"+f.substring(1),f.match(/\|$/)&&(f=f.substring(0,f.length-1)+"'"));r.valueExpr=this.parser.parse(f);r.valueExprString=f;break;case "incr":0!=n&&(r.incr=this.parser.parse(n));break;case "exponentialif":r.exponentialif=parseFloat(n);break;case "text":r.rawText=n;for(var f=this.parseText(n),e=0,h=f.length;e<h;e++)f[e]=this.parser.parse(f[e],!1);r.text=f;break;default:e=t.indexOf(".");f=d[t.substring(0,e)];e=d[t.substring(e+
1)];if("parameter"===f&&"font"===e){r.parameterFont=n;break}else if("Explanation"===f&&"font"===e){r.ExplanationFont=n;break}else if("tooltip"===f&&"font"===e){r.tooltipFont=n;break}console.log("----- attributo de control no identificado: <"+t+"> valor: <"+n+"> -----")}if("numeric"===r.type)switch(r.gui){case "spinner":return new a.Spinner(this.parent,r);case "button":return new a.Button(this.parent,r);case "textfield":return new a.TextField(this.parent,r);case "menu":return new a.Menu(this.parent,
r);case "scrollbar":return new a.Scrollbar(this.parent,r);default:return new a.Spinner(this.parent,r)}else{if("video"===r.type)return new a.Video(this.parent,r);if("audio"===r.type)return new a.Audio(this.parent,r);if("graphic"===r.type)return new a.GraphicControl(this.parent,r);if("text"===r.type)return new a.TextArea(this.parent,r)}};a.LessonParser.prototype.parseGraphic=function(b,c,g,f){v={rotateExp:f,parameter:"t"};b=this.split(b);f=0;for(var e=b.length;f<e;f++)if(t=b[f][0],n=b[f][1],s=d[t],
""!=n)switch(s){case "type":case "align":v[s]=d[n];break;case "background":case "abs_coord":case "visible":case "editable":case "fixed":case "vectors":v[s]="true"===d[n];break;case "color":case "fill":case "fillP":case "fillM":case "arrow":case "trace":v[s]="false"===d[n]?"":new a.Color(n,this.parent.evaluator);break;case "family":case "parameter":case "info":case "font":case "name":case "init":case "end":v[s]=n;break;case "drawif":case "width":case "decimals":case "size":case "spear":case "center":case "radius":case "opacity":case "inirot":case "inipos":case "range":""!=
n&&(v[s]=this.parser.parse(n));break;case "space":v.spaceID=n;break;case "expresion":""!=n&&("macro"!=v.type?(v.expresion=this.parser.parse(n),v.expresionString=n):v.expresion=n);break;case "text":v.text=this.parseText(n);break;case "file":var h=n.replace(/&squot;/g,"'");"["===h.charAt(0)&&"]"===h.charAt(h.length-1)&&(h=h.substring(1,h.length-1));h.match(y)&&(h="'"+h+"'");v.file=this.parser.parse(h);break;case "border":""!=n&&"false"!=d[n]&&(v.border=new a.Color(n,this.parent.evaluator));break;default:if(void 0!=
v.family&&t.substring(0,v.family.length+1)===v.family+"."){switch(d[t.substring(v.family.length+1)]){case "interval":""!=n&&(v.family_interval=this.parser.parse(n));break;case "steps":""!=n&&(v.family_steps=this.parser.parse(n))}break}if(void 0!=v.parameter&&t.match(v.parameter+".")){v.parameter!==t.substring(0,t.indexOf(v.parameter)+v.parameter.length)&&(v.parameter=t.substring(0,t.indexOf(v.parameter)+v.parameter.length));switch(d[t.substring(v.parameter.length+1)]){case "interval":""!=n&&(v.parameter_interval=
this.parser.parse(n));break;case "steps":""!=n&&(v.parameter_steps=this.parser.parse(n))}break}console.log("----- attributo del graphic no identificado: <"+t+"> valor: <"+n+"> -----")}c&&(v.abs_coord=c);g&&(v.background=g);switch(v.type){case "text":return new a.Text(this.parent,v);case "image":return new a.Image(this.parent,v);case "point":return new a.Point(this.parent,v);case "polygon":return new a.Polygon(this.parent,v);case "arc":return new a.Arc(this.parent,v);case "segment":return new a.Segment(this.parent,
v);case "arrow":return new a.Arrow(this.parent,v);case "macro":return new a.Macro(this.parent,v);case "curve":return new a.Curve(this.parent,v);case "equation":return new a.Equation(this.parent,v);case "sequence":return new a.Sequence(this.parent,v);case "fill":return new a.Fill(this.parent,v);case "generic":return new a.Generic(this.parent,v)}};a.LessonParser.prototype.parse3DGraphic=function(b,c,g,f){v={rotateExp:f,parameter:"t"};b=this.split(b);c=0;for(g=b.length;c<g;c++)switch(t=b[c][0],n=b[c][1],
s=d[t],s){case "type":case "model":v[s]=d[n];break;case "background":case "fixed":case "edges":v[s]="true"===d[n];break;case "color":case "backcolor":v[s]=new a.Color(n,this.parent.evaluator);break;case "type":case "model":v[s]=d[n];break;case "background":case "fixed":case "edges":case "split":v[s]="true"===d[n];break;case "color":case "backcolor":v[s]=new a.Color(n,this.parent.evaluator);break;case "drawif":case "width":case "length":case "height":case "decimals":case "Nu":case "Nv":case "inipos":case "endpos":""!=
n&&(v[s]=this.parser.parse(n));break;case "family":case "parameter":case "font":case "name":case "inirot":case "endrot":v[s]=n;break;case "space":v.spaceID=n;break;case "expresion":"macro"!=v.type&&"curve"!=v.type&&"surface"!=v.type?(v.expresion=this.parser.parse(n),v.expresionString=n):v.expresion=n.replace(/\\n/g," ").replace(/;/g," ");break;case "text":f=this.parseText(n);for(var e=0,h=f.length;e<h;e++)f[e]=this.parser.parse(f[e],!1);v.text=f;break;case "file":f=n.replace(/&squot;/g,"'");"["===
f.charAt(0)&&"]"===f.charAt(f.length-1)&&(f=f.substring(1,f.length-1));f.match(/./)&&(f="'"+f+"'");v.file=this.parser.parse(f);break;case "drawif":case "width":case "length":case "decimals":case "Nu":case "Nv":case "inirot":case "endrot":case "inipos":case "endpos":""!=n&&(v[s]=this.parser.parse(n));break;case "family":case "parameter":case "font":case "name":v[s]=n;break;case "space":v.spaceID=n;break;case "expresion":"macro"!=v.type&&"curve"!=v.type&&"surface"!=v.type?(v.expresion=this.parser.parse(n),
v.expresionString=n):v.expresion=n;break;case "text":f=this.parseText(n);e=0;for(h=f.length;e<h;e++)f[e]=this.parser.parse(f[e],!1);v.text=f;break;case "file":f=n.replace(/&squot;/g,"'");"["===f.charAt(0)&&"]"===f.charAt(f.length-1)&&(f=f.substring(1,f.length-1));f.match(/./)&&(f="'"+f+"'");v.file=this.parser.parse(f);break;default:if(void 0!==v.family&&t.substring(0,v.family.length+1)===v.family+"."){"interval"===d[t.substring(v.family.length+1)]?""!=n&&(v.family_interval=this.parser.parse(n)):""!=
n&&(v.family_steps=this.parser.parse(n));break}console.log("----- attributo del graphic3D no identificado: <"+t+"> valor: <"+n+"> -----")}switch(v.type){case "point":return new a.Point3D(this.parent,v);case "segment":return new a.Segment3D(this.parent,v);case "polygon":return new a.Polygon3D(this.parent,v);case "curve":return new a.Curve3D(this.parent,v);case "triangle":return new a.Triangle3D(this.parent,v);case "face":return new a.Face3D(this.parent,v);case "polireg":return new a.Polireg3D(this.parent,
v);case "surface":return new a.Surface3D(this.parent,v);case "text":return new a.Text3D(this.parent,v);case "cube":case "box":case "tetrahedron":case "octahedron":case "sphere":case "dodecahedron":case "icosahedron":case "ellipsoid":case "cone":case "cylinder":case "mesh":return new a.OtherGeometry(this.parent,v);case "macro":return new a.Macro3D(this.parent,v);default:console.log(v.type)}};a.LessonParser.prototype.parseAuxiliar=function(b){w={};b=this.split(b);for(var c=0,g=b.length;c<g;c++)b[c][1]=
b[c][1].replace(/&squot;/g,"'");c=0;for(g=b.length;c<g;c++)switch(t=b[c][0],n=b[c][1],s=d[t],s){case "id":case "file":case "init":case "doExpr":case "whileExpr":case "range":case "local":case "expresion":case "condition":case "parameter":w[s]=n.replace(/&squot;/g,"'");break;case "editable":case "constant":case "array":case "matrix":case "algorithm":case "event":case "sequence":w[s]="true"===d[n];break;case "size":case "rows":case "columns":w[s]=this.parser.parse(n);break;case "evaluate":case "execution":case "msg_pos":case "action":w[s]=
d[n];break;case "type":w[s]=d[n];break;case "x":case "y":case "width":case "height":w[s]=this.parser.parse(n);break;default:var f=t.indexOf("."),e=d[t.substring(0,f)],f=d[t.substring(f+1)];if("parameter"===e&&"font"===f){w.parameterFont=n;break}console.log("----- attributo de auxiliar no identificado: <"+t+"> valor: <"+n+"> -----")}w.type&&"rectangle"==w.type?this.parent.auxiliaries.push(new a.Rectangle(this.parent,w)):w.sequence?new a.Function(this.parent,w):w.constant?(b=new a.Constant(this.parent,
w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(b)):w.algorithm&&w.evaluate?(b=new a.Algorithm(this.parent,w),this.parent.auxiliaries.push(b)):w.array&&!w.matrix&&")"!=w.id.charAt(w.id.length-1)?(b=new a.Vector(this.parent,w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(b)):w.matrix&&")"!=w.id.charAt(w.id.length-1)?(b=new a.Matrix(this.parent,w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(b)):w.event&&")"!=w.id.charAt(w.id.length-1)?this.parent.events.push(new a.Event(this.parent,
w)):")"===w.id.charAt(w.id.length-1)?new a.Function(this.parent,w):new a.Variable(this.parent,w)};a.LessonParser.prototype.parseAction=function(b){C=b.action;A=b.parent;D=b.parameter;if(C)switch(C){case "message":return new a.Message(A,D);case "calculate":return new a.Calculate(A,D);case "openURL":return new a.OpenURL(A,D);case "openScene":return new a.OpenScene(A,D);case "about":return new a.About(A,D);case "config":return new a.Config(A,D);case "init":return new a.Init(A,D);case "clear":return new a.Clear(A,
D);case "animate":return new a.Animate(A,D);case "initAnimation":return new a.InitAnimation(A,D);case "playAudio":return new a.PlayAudio(A,D);default:console.log("----- Accion no soportada aun: <"+C+"> -----")}else return{execute:function(){}}};a.LessonParser.prototype.parseAnimation=function(b){var c={};b=this.split(b);for(var g=0,f=b.length;g<f;g++)switch(t=b[g][0],n=b[g][1],s=d[t],s){case "id":case "delay":case "init":case "doExpr":case "whileExpr":c[s]=n.replace(/&squot;/g,"'");break;case "controls":case "auto":case "loop":case "algorithm":case "evaluate":c[s]=
"true"===d[n];break;default:console.log("----- attributo de la animacion no identificado: <"+t+">  <"+n+"> -----")}return new a.Animation(this.parent,c)};a.LessonParser.prototype.parsePleca=function(d,l){d=this.split(d);f=e="";c=0;b="#536891";k="white";g="left";p="";h="SansSerif,BOLD,20";q="SansSerif,PLAIN,18";m=void 0;for(var r=0,s=d.length;r<s;r++)switch(t=d[r][0],n=d[r][1],t){case "title":e=n;break;case "subtitle":f=n;break;case "subtitlines":c=n;break;case "bgcolor":""!=n&&(b=(new a.Color(n,this.parent.evaluator)).getColor());
break;case "fgcolor":""!=n&&(k=(new a.Color(n,this.parent.evaluator)).getColor());break;case "align":""!=n&&(g=n);break;case "titleimage":p=n;break;case "titlefont":h=""!=n?a.convertFont(n):a.convertFont(h);break;case "subtitlefont":q=""!=n?a.convertFont(n):a.convertFont(q);break;default:console.log("----- attributo de la pleca no identificado: <"+t+">  <"+n+"> -----")}if(""===e&&""===f)return document.createElement("div");L=q.substring(0,q.indexOf("px"));L=L.substring(L.lastIndexOf(" "));""!=p&&
(x=this.parent.getImage(p),J=x.height);m=document.createElement("div");m.setAttribute("id","descartesPleca");J?(m.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+g+"; width: "+(l-30)+"px; height: "+(J-16)+"px; background: "+b+"; color: "+k+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; overflow: hidden; z-index: 100;"),x.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: -1; width: 100%; height: 100%"),
m.appendChild(x)):m.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+g+"; width: "+(l-30)+"px; background: "+b+"; color: "+k+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; z-index: 100;");F=document.createElement("div");F.setAttribute("style","padding: 0px; margin: 0px; font: "+h+"; overflow: hidden; white-space: nowrap;");F.innerHTML=e;P=document.createElement("div");if(1===parseInt(c)){O=0;M=document.createElement("div");
M.innerHTML=f;document.body.appendChild(M);R=L;do R-=O,M.setAttribute("style","padding: 0px; margin: 0px; font: "+q+"; font-size: "+R+"px; width: "+(l-30)+"px; line-height: "+R+"px;"),I=M.offsetHeight,S=I/R,O=1;while(1<S&&8<R);document.body.removeChild(M);P.setAttribute("style","padding: 0px; margin: 0px; font: "+q+"; font-size: "+R+"px; line-height: 110%; overflow: hidden; white-space: nowrap;")}else P.setAttribute("style","padding: 0px; margin: 0px; font: "+q+"; line-height: 110%;");P.innerHTML=
f;m.appendChild(F);m.appendChild(P);m.imageHeight=J;return m};a.LessonParser.prototype.split=function(a){if("string"!=typeof a)return[];a=(a||"").replace(/\\'/g,"\u2019");E=[];B=z=0;G=!1;H=0;for(K=!1;z<a.length;)" "!==a.charAt(z)||G||z++," "===a.charAt(z)||G||(G=!0,H=z),"="!==a.charAt(z)||"'"!==a.charAt(z+1)||K||(K=!0,E[B]=[a.substring(H,z)],H=z+2,z+=2),K&&"'"===a.charAt(z)&&(G=K=!1,E[B].push(a.substring(H,z)),B++),"="!==a.charAt(z)||"'"===a.charAt(z+1)||K||(E[B]=[a.substring(H,z)],H=z+1,z++,Q=a.substring(z).indexOf("="),
-1===Q?N=Q=a.length:(Q+=z,N=a.substring(z,Q).lastIndexOf(" "),N=-1===N?a.length:N+z),E[B].push(a.substring(H,N)),B++,G=!1,z=N),z++;return E};a.LessonParser.prototype.parseText=function(b){b=b||"";return b.match(/^\{\\rtf1/)?this.RTFparser.parse(b.substring(10)):new a.SimpleText(this.parent,b)};return a}(descartesJS||{},babel),descartesJS=function(a){function d(a,b){t=[];t.type="matrix";t.rows=a;t.cols=b;var c;u=0;for(r=b;u<r;u++){c=[];n=0;for(v=a;n<v;n++)c.push(0);t[u]=c}return t}function e(a,b){l=
a.rows;s=a.cols;t=d(l,s);var c;for(u=0;u<l;u++)for(n=0;n<s;n++){for(r=c=0;r<s;r++)c+=a[r][u]*b[n][r];t[n][u]=c}return t}function f(a,b,c){for(var g=d(c.length-1,c.length-1),f=0,e=g.length;f<e;f++)for(var h=0;h<e;h++)g[f][h]=f<a?h<b?c[f][h]:c[f][h+1]:f<b?c[f+1][h]:c[f+1][h+1];return g}function c(a){if(1<a.cols){for(var b=0,g=1,d=0,e=a.cols;d<e;d++)b+=g*a[0][d]*c(f(0,d,a)),g=-g;return b}return a[0][0]}if(a.loadLib)return a;var b,k={},g=Math.floor,p,h,q,m;a.fullDecimals=!1;a.Node=function(a,b){this.sep=
"";this.type=a;this.value=b;this.parent=null;this.childs=[]};a.Node.prototype.getRoot=function(){return null===this.parent?this:this.parent.getRoot()};a.Node.prototype.addChild=function(a){a.parent=this;this.childs.push(a)};a.Node.prototype.replaceLastChild=function(a){p=this.childs.length-1;lastChild=this.childs[p];lastChild.parent=null;this.childs[p]=a;a.parent=this;return a};a.Node.prototype.contains=function(a){if(this.value===a)return!0;for(var b=0,c=this.childs.length;b<c;b++)if(this.childs[b].contains(a))return!0;
return!1};a.Node.prototype.equalToMinus=function(){return"compOperator"===this.type?(this.type="operator",this.value="-",q=new a.Node("compOperator","=="),m=new a.Node("number","0"),q.addChild(this),q.addChild(m),h=this.getRoot(),h.setAllEvaluateFunction(),h):this};a.Node.prototype.setAllEvaluateFunction=function(){this.setEvaluateFunction();for(var a=0,b=this.childs.length;a<b;a++)this.childs[a].setAllEvaluateFunction()};a.Node.prototype.setEvaluateFunction=function(){if("number"===this.type)this.evaluate=
function(a){return parseFloat(this.value)};else if("string"===this.type)this.evaluate=function(a){return this.value};else if("identifier"===this.type&&0===this.childs.length)if("rnd"==this.value)this.evaluate=function(a){return Math.random()};else{var a;this.evaluate=function(b,c){a=b.variables[this.value];if("object"===typeof a)return a.evaluate(b);void 0==a&&(c||b.matrices[this.value]?a=b.matrices[this.value]:b.vectors[this.value]&&(a=b.vectors[this.value]));return void 0!==a?a:0}}else if("identifier"===
this.type&&"square_bracket"===this.childs[0].type&&1===this.childs[0].childs.length){var h,p;this.evaluate=function(a){h=this.childs[0].childs[0].evaluate(a);try{return p=a.vectors[this.value][0>h?0:g(h)],void 0!==p?p:0}catch(b){return 0}}}else if("identifier"===this.type&&"square_bracket"===this.childs[0].type&&1<this.childs[0].childs.length){var m,q;this.evaluate=function(a){m=this.childs[0].childs[0].evaluate(a);q=this.childs[0].childs[1].evaluate(a);try{return p=a.matrices[this.value][0>m?0:g(m)][0>
q?0:g(q)],void 0!==p?p:0}catch(b){return 0}}}else if("identifier"===this.type&&"parentheses"===this.childs[0].type){var r;this.evaluate=function(a){r=[];for(var c=0,g=this.childs[0].childs.length;c<g;c++)r[c]=this.childs[0].childs[c].evaluate(a);return"_Eval_"===this.value?(r[0]=0<r.length?r[0].toString():"",b=r[0].replace(a.parent.decimal_symbol_regexp,"."),void 0==k[b]&&(k[b]=a.parser.parse(b)),a.evalExpression(k[b])):a.functions[this.value].apply(a,r)}}else if("operator"===this.type)"+"===this.value?
this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);if("matrix"!==b.type||"matrix"!==a.type)return b+a;l=b.rows;s=b.cols;t=d(l,s);for(u=0;u<l;u++)for(n=0;n<s;n++)t[n][u]=b[n][u]+a[n][u];return t}:"-"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);if("matrix"!==b.type||"matrix"!==a.type)return b-a;l=b.rows;s=b.cols;t=d(l,s);for(u=0;u<l;u++)for(n=0;n<s;n++)t[n][u]=b[n][u]-a[n][u];return t}:"*"===this.value?
this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);return"matrix"!==b.type||"matrix"!==a.type?b*a:e(b,a)}:"/"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);if("matrix"!==b.type||"matrix"!==a.type)return b/a;var g=d(a.length,a.length),h=c(a);if(0===h)a=0;else{var h=1/h,k;if(1<a.length)for(var p=0,n=a.length;p<n;p++){k=h;for(var m=0;m<n;m++)g[m][p]=k*c(f(p,m,a)),k=-k;h=-h}else g[0][0]=h;a=g}b=0===
a?d(b.rows,b.cols):e(b,a);return b}:"%"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a);a=this.childs[1].evaluate(a);return b-g(b/a)*a}:"^"===this.value&&(this.evaluate=function(a){return Math.pow(this.childs[0].evaluate(a),this.childs[1].evaluate(a))});else if("compOperator"===this.type)"<"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<this.childs[1].evaluate(a))+0}:"<="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<=this.childs[1].evaluate(a))+
0}:">"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>this.childs[1].evaluate(a))+0}:">="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>=this.childs[1].evaluate(a))+0}:"=="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)===this.childs[1].evaluate(a))+0}:"!="===this.value&&(this.evaluate=function(a){return(this.childs[0].evaluate(a)!=this.childs[1].evaluate(a))+0});else if("boolOperator"===this.type)"&"===this.value?this.evaluate=
function(a){return this.childs[0].evaluate(a)?this.childs[1].evaluate(a)?1:0:0}:"|"===this.value?this.evaluate=function(a){return this.childs[0].evaluate(a)?1:this.childs[1].evaluate(a)?1:0}:"!"===this.value&&(this.evaluate=function(a){return!this.childs[0].evaluate(a)+0});else if("conditional"===this.type)this.evaluate=function(a){return 0<this.childs[0].evaluate(a)?this.childs[1].evaluate(a):this.childs[2].evaluate(a)};else if("sign"===this.type)this.evaluate="sign+"===this.value?function(a){return this.childs[0].evaluate(a)}:
function(a){return-this.childs[0].evaluate(a)};else if("parentheses"===this.type)this.evaluate=function(a,b){return this.childs[0].evaluate(a,b)};else if("(expr)"===this.type||"[expr]"===this.type)this.evaluate=function(a){var b=this.childs.length,c=[],g;if(1===b&&1===this.childs[0].childs.length&&"(expr)"===this.type)c=this.childs[0].childs[0].evaluate(a);else for(var d=0;d<b;d++){g=[];for(var f=0,e=this.childs[d].childs.length;f<e;f++)g.push(this.childs[d].childs[f].evaluate(a));c[d]=g}return c};
else if("asign"===this.type){var v,B,G,H,K,L;this.evaluate=function(a){v=this.childs[0];B=this.childs[1];1===v.childs.length&&"square_bracket"===v.childs[0].type?(h=v.childs[0].childs,1===h.length?(G=h[0].evaluate(a),G=0>G?0:g(G),a.vectors[v.value][G]=B.evaluate(a)):2===h.length&&(H=h[0].evaluate(a),K=h[1].evaluate(a),H=0>H?0:g(H),K=0>K?0:g(K),a.matrices[v.value][H]||(a.matrices[v.value][H]=[]),a.matrices[v.value][H][K]=B.evaluate(a))):(L=B.evaluate(a),L.type?a.matrices[v.value]=L:"object"!==typeof a.variables[v.value]&&
(a.variables[v.value]=L))}}};var l,s,t,n,u,r,v;a.Node.prototype.toString=function(){var a="tipo: "+this.type+", valor: "+this.value+"\n";this.sep="   "+(this.parent?this.parent.sep:"");for(var b=0,c=this.childs.length;b<c;b++)a+=this.sep+this.childs[b].toString();return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g,p,h,q=/^\s+/,m=/^[a-zA-Z_\u00C0-\u021B]+[a-zA-Z_0-9\u00C0-\u021B]*([.]*[0-9a-zA-Z_\u00C0-\u021B]+[0-9]*)*/,l=/^[0-9]+[.][0-9]+|^[.][0-9]+|^[0-9]+/,
s=/^==|^!=|^<=|^<|^>=|^>|^#/,t=/^\!|^\~|^\&\&|^\&|^\|\||^\|/,n=/^=/,u=/^[\?\:]/,r=/^[\+\-\*\/\%\^]/,v=/^\[|^\]/,w=/^\(|^\)/,y=/^,/,C=/^;/,A=/\|/g,D=/\|\*/g,E=/\*\|/g;a.Tokenizer=function(){};a.Tokenizer.prototype.tokenize=function(a){function B(a,b,g){e.push({type:a,value:b});k=k.slice(g);c+=g;p++;h=a}if(d=a){a=a.replace(/\\u(\S+) /g,function(a,b){return String.fromCharCode(parseInt(b,16))});a=a.replace(/\&sup(.+);/g,"^ $1 ");a=a.replace(/&squot;/g,"'");a.match(/\=\|\*/g)&&(a=a.replace(D,"'").replace(E,
"'"));a.match(/\=\|/g)&&(a=a.replace(A,"'"));var z=a.trim();"|"==z.charAt(0)&&"|"==z.charAt(z.length-1)&&(a=z.replace(A,"'"))}e=[];f=!1;c=0;k=a;p=0;for(h="";a&&c<a.length;)if(f=c,"'"==k[0]){for(g=1;"'"!=k[g];)if(g<k.length)g++;else{console.log(">Error, unknown symbol: ["+k+"], in the string <<"+d+">>");return}b=k.substring(1,g);B("string",b,b.length+2)}else if(b=k.match(q))k=k.slice(b[0].length),c+=b[0].length,p++;else if(b=k.match(m))"number"===h&&e.push({type:"operator",value:"*"}),B("identifier",
b[0],b[0].length);else if(b=k.match(l))B("number",b[0],b[0].length);else if(b=k.match(s))z=b[0],"#"==z&&(z="!="),B("compOperator",z,b[0].length);else if(b=k.match(t))z=b[0],"||"==z?z="|":"&&"==z?z="&":"~"==z&&(z="!"),B("boolOperator",z,b[0].length);else if((b=k.match(n))&&!k.match(/^==/))B("asign",b[0],b[0].length);else if(b=k.match(u))B("conditional",b[0],b[0].length);else if(b=k.match(r))B("operator",b[0],b[0].length);else if(b=k.match(v))B("square_bracket",b[0],b[0].length);else if(b=k.match(w))"("==
b&&"number"===h&&e.push({type:"operator",value:"*"}),B("parentheses",b[0],b[0].length);else if(b=k.match(y))B("separator",b[0],b[0].length);else if(178===k.charCodeAt(0))e.push({type:"operator",value:"^"}),B("number",2,1);else if(179===k.charCodeAt(0))e.push({type:"operator",value:"^"}),B("number",3,1);else if(b=k.match(C))B("final_of_expresion",b[0],b[0].length);else if(f==c){console.log("Error, simbolo no conocido: ["+k+"], en la cadena <<"+d+">>");return}return e};var z,B=/rnd|pi|e|Infinity|-Infinity|sqr|sqrt|ra\u00edz|exp|log|log10|abs|ent|sgn|ind|sin|sen|cos|tan|cot|sec|csc|sinh|senh|cosh|tanh|coth|sech|csch|asin|asen|acos|atan|min|max/;
a.Tokenizer.prototype.flatTokens=function(a,b){a=a||[];b=b||"";z="";for(var c=0,g=a.length;c<g;c++)z="string"==a[c].type?z+"&squot;"+a[c].value+"&squot;":"identifier"!=a[c].type||a[c].value.match(B)?z+a[c].value:z+b+a[c].value;return z};return a}(descartesJS||{}),descartesJS=function(a){function d(a){return isNaN(parseFloat(a))?a.replace(/^\s|\s$/g,"").replace(/^'|'$/g,""):parseFloat(a)}if(a.loadLib)return a;a.Parser=function(b){this.evaluator=b;this.tokenizer=new a.Tokenizer;this.vectors={};this.matrices=
{};this.variables={};this.functions={};this.definitions={};this.registerDefaultValues()};a.Parser.prototype.setDefinition=function(a,b){this.definitions[a]=b};a.Parser.prototype.getDefinition=function(a){return this.definitions[a]};a.Parser.prototype.setVariable=function(a,b){this.variables[a]=b};a.Parser.prototype.getVariable=function(a,b){b&&(this.variables[a]=void 0!==this.variables[a]?this.variables[a]:0);return this.variables[a]};a.Parser.prototype.setVector=function(a,b,c){this.vectors[a][b]=
c};a.Parser.prototype.getVector=function(a){this.vectors.hasOwnProperty(a)||(this.vectors[a]=[0,0,0]);return this.vectors[a]};a.Parser.prototype.setMatrix=function(a,b,c,g){this.matrices[a][b][c]=g};a.Parser.prototype.getMatrix=function(a){this.matrices.hasOwnProperty(a)||(this.matrices[a]=[[0,0,0],[0,0,0],[0,0,0]]);return this.matrices[a]};a.Parser.prototype.setFunction=function(a,b){this.functions[a]=b};a.Parser.prototype.getFunction=function(a){this.functions.hasOwnProperty(a)||(this.functions[a]=
function(){return 0});return this.functions[a]};var e,f,c,b,k,g,p,h,q,m,l,s;a.Parser.prototype.parse=function(d,n){(c=this.tokenizer.tokenize(d))||(c=[]);b=null;n=!n||!1;e=h=p=g=0;for(f=c.length;e<f;e++)if(q=c[e],m=q.value,l=q.type,"identifier"===l&&(e+1<f&&"parentheses"===c[e+1].type&&"("===c[e+1].value?this.getFunction(m):e+1<f&&"square_bracket"===c[e+1].type&&"["===c[e+1].value?c[e+3]&&"square_bracket"===c[e+3].type&&"]"===c[e+3].value?this.getVector(m):this.getMatrix(m):this.getVariable(m,!0)),
"asign"===l&&n&&(l="compOperator",m="=="),"asign"===l)if(k=new a.Node(l,m),null!=b)if("identifier"===b.type)b.parent&&b.parent.replaceLastChild(k),k.addChild(b),b=k,n=!0;else if("square_bracket"===b.type)k.addChild(b.parent),b=k,n=!0;else{k.type="compOperator";k.value="==";for(n=!0;b.parent&&this.getPrecedence(b.parent.value)>=this.getPrecedence(k.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(k);k.addChild(b);b=k}else{console.log("Error1: en la expresion <<"+d+">>, en el token {valor: "+
m+", tipo: "+l+"}");break}else if("parentheses"===l&&"("===m||"square_bracket"===l&&"["===m)if(k=new a.Node(l,m),"("===m&&g++,"["===m&&p++,null===b)"("===m&&(new a.Node("(expr)","(expr)")).addChild(k),"["===m&&(new a.Node("[expr]","[expr]")).addChild(k),b=k;else if("operator"===b.type||"boolOperator"===b.type||"compOperator"===b.type||"conditional"===b.type||"asign"===b.type)b.addChild(k),b=k;else if("sign"===b.type)b.addChild(k),b=k;else if("parentheses"===b.type&&"("===b.value)b.addChild(k),b=k;
else if("square_bracket"===b.type&&"["===b.value)b.addChild(k),b=k;else if("parentheses"===b.type&&"()"===b.value)b.parent.addChild(k),b=k;else if("square_bracket"===b.type&&"[]"===b.value)b.parent.addChild(k),b=k;else if("identifier"===b.type)b.addChild(k),b=k;else{console.log("Error2: en la expresion <<"+d+">>, en el token ["+e+"] {valor: "+m+", tipo: "+l+"}");break}else if("parentheses"===l&&")"===m)if(g--,null===b)console.log("Error3: en la expresion <<"+d+">>, en el token (valor:"+m+", tipo:"+
l);else{for(;b&&b.parent&&"("!=b.value;)b=b.parent;if(b&&"("===b.value)b.value="()";else{console.log("Error4: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}}else if("square_bracket"===l&&"]"===m)if(p--,null===b)console.log("Error5: en la expresion <<"+d+">>, en el token (valor:"+m+", tipo:"+l);else{for(;b&&b.parent&&"["!=b.value;)b=b.parent;if(b&&"["===b.value)b.value="[]";else{console.log("Error6: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}}else if("number"===
l||"string"===l||"identifier"===l)if(k=new a.Node(l,m),null===b)b=k;else if("operator"===b.type||"compOperator"===b.type||"boolOperator"===b.type||"parentheses"===b.type&&"("===b.value||"square_bracket"===b.type&&"["===b.value||"sign"===b.type||"conditional"===b.type||"asign"===b.type)b.addChild(k),b=k;else{console.log("Error7: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}else if("operator"===l||"compOperator"===l||"boolOperator"===l)if(k=new a.Node(l,m),null===b)if("-"===
m||"+"===m)k.type="sign",k.value="sign"+m,b=k;else if("!"===m)b=k;else{console.log("Error8: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}else if("operator"===b.type||"compOperator"===b.type||"boolOperator"===b.type||"asign"===b.type||"conditional"===b.type||"square_bracket"===b.type&&"["===b.value&&("-"===m||"+"===m||"!"===m)||"parentheses"===b.type&&"("===b.value&&("-"===m||"+"===m||"!"===m)){if("-"===m||"+"===m)k.type="sign",k.value="sign"+m;b.addChild(k);b=k}else if("number"===
b.type||"parentheses"===b.type&&"()"===b.value||"square_bracket"===b.type&&"[]"===b.value||"string"===b.type||"identifier"===b.type||"conditional"===b.type||"asign"===b.type){for(;b.parent&&this.getPrecedence(b.parent.value)>=this.getPrecedence(k.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(k);k.addChild(b);b=k}else{console.log("Error9: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}else if("conditional"===l)if(k=new a.Node(l,m),null!=b)if("?"===k.value){for(h++;b.parent&&
this.getPrecedence(b.parent.value)>this.getPrecedence(k.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(k);k.addChild(b);b=k}else{for(h--;b&&b.parent&&"?"!=b.value;)b=b.parent;if(b&&"?"===b.value)b.value="?:";else{console.log("Error10: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}}else{console.log("Error11: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}else if("separator"===l)if(null!=b)for(;b.parent&&"("!=b.value&&"["!=b.value;)b=
b.parent;else{console.log("Error12: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}else{console.log("Error13: en la expresion <<"+d+">>, en el token {valor: "+m+", tipo: "+l+"}");break}0<g&&alert("Error, faltan parentesis por cerrar: "+d);0>g&&alert("Error, faltan parentesis por abrir: "+d);0<p&&alert("Error, faltan square bracketss por cerrar: "+d);0>p&&alert("Error, faltan square bracketss por abrir: "+d);0!=h&&alert("Error, condicional incompleta: "+d);(s=b?b.getRoot():
null)&&s.setAllEvaluateFunction();return s};a.Parser.prototype.getPrecedence=function(a){switch(a){case "=":return 1;case "(":return 2;case "[":return 2;case "?":return 2;case ":":return 3;case "?:":return 3;case "|":return 6;case "&":return 7;case "<":return 5;case "<=":return 5;case ">":return 5;case ">=":return 5;case "==":return 5;case "!=":return 5;case "+":return 6;case "-":return 6;case "/":return 7;case "*":return 7;case "sign-":return 7;case "sign+":return 7;case "!":return 8;case "%":return 8;
case "^":return 9;default:return 9}};a.Parser.prototype.registerDefaultValues=function(){function b(a,c){for(var g in c)c.hasOwnProperty(g)&&(a[g]=c[g])}this.variables.rnd=Math.random;this.variables.pi=a.returnValue(Math.PI);this.variables.e=a.returnValue(Math.E);this.variables.Infinity=Infinity;this.variables["-Infinity"]=-Infinity;this.functions.sqr=function(a){return a*a};this.functions.sqrt=this.functions["ra\u00edz"]=Math.sqrt;this.functions.exp=Math.exp;this.functions.log=Math.log;this.functions.log10=
function(a){return Math.log(a)/Math.log(10)};this.functions.abs=Math.abs;this.functions.ent=Math.floor;this.functions.sgn=function(a){return 0<a?1:0>a?-1:0};this.functions.ind=function(a){return a?1:0};this.functions.sin=this.functions.sen=Math.sin;this.functions.cos=Math.cos;this.functions.tan=Math.tan;this.functions.cot=function(a){return 1/Math.tan(a)};this.functions.sec=function(a){return 1/Math.cos(a)};this.functions.csc=function(a){return 1/Math.sin(a)};this.functions.sinh=this.functions.senh=
function(a){return(Math.exp(a)-Math.exp(-a))/2};this.functions.cosh=function(a){return(Math.exp(a)+Math.exp(-a))/2};this.functions.tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))};this.functions.coth=function(a){return 1/this.functions.tanh(a)};this.functions.sech=function(a){return 1/this.functions.cosh(a)};this.functions.csch=function(a){return 1/this.functions.sinh(a)};this.functions.asin=this.functions.asen=Math.asin;this.functions.acos=Math.acos;this.functions.atan=
Math.atan;this.functions.min=Math.min;this.functions.max=Math.max;this.functions._Num_=function(a){return"number"==typeof a?"NaN":parseFloat(a)==a?parseFloat(a):"NaN"};var c=this;this.functions._Trace_=function(a){console.log(a)};this.functions._Stop_Audios_=function(){c.evaluator.parent.stopAudios()};this.functions.esCorrecto=function(b,g,d){return a.esCorrecto(b,g,c.evaluator,d)};this.functions.escorrecto=function(b,g,d){return a.escorrecto(b,g,c.evaluator,d)};window.parent!==window&&(this.functions["parent.set"]=
function(a,b){window.parent.postMessage({type:"set",name:a,value:b},"*");return 0},this.functions["parent.update"]=function(){window.parent.postMessage({type:"update"},"*");return 0},this.functions["parent.exec"]=function(a,b){window.parent.postMessage({type:"exec",name:a,value:b},"*");return 0});this.functions._GetValues_=function(b,g){var d;if(b){d=(d=document.getElementById(b))&&"descartes/archivo"==d.type?d.text.replace(/&brvbar;/g,String.fromCharCode("166")):a.openExternalFile(b);var f=[],e=
!1;if(d){d=d.replace(/\r/g,"").split("\n");for(var h=0,k=d.length;h<k;h++)d[h].match("<"+g+">")?(e=d[h].trim().split("<"+g+">"),2==e.length&&""!=e[1]&&(f=f.concat(e[1].split(String.fromCharCode("166")))),e=!0):d[h].match("</"+g+">")?(e=d[h].trim().split("</"+g+">"),2==e.length&&""!=e[0]&&(f=f.concat(e[0].split(String.fromCharCode("166")))),e=!1):e&&(f=f.concat(d[h].split(String.fromCharCode("166"))));h=0;for(k=f.length;h<k;h++)e=f[h].split("="),e[0]=e[0].trim(),2==e.length&&""!=e[0]&&(isNaN(parseFloat(e[1]))?
c.setVariable(e[0],e[1].replace(/^\s|\s$/g,"").replace(/^'|'$/g,"")):c.setVariable(e[0],parseFloat(e[1])))}return 0}};this.functions._GetMatrix_=function(b,g){var f;if(b){f=(f=document.getElementById(b))&&"descartes/archivo"==f.type?f.text.replace(/&brvbar;/g,String.fromCharCode("166")):a.openExternalFile(b);var e=[],h=!1;e.type="matrix";if(f){f=f.replace(/\r/g,"").split("\n");for(var k=0,p=f.length;k<p;k++)f[k].match("<"+g+">")?(h=f[k].trim().split("<"+g+">"),2==h.length&&""!=h[1]&&e.push(h[1].split(String.fromCharCode("166")).map(d)),
h=!0):f[k].match("</"+g+">")?(h=f[k].trim().split("</"+g+">"),2==h.length&&""!=h[0]&&e.push(h[0].split(String.fromCharCode("166")).map(d)),h=!1):h&&e.push(f[k].split(String.fromCharCode("166")).map(d));c.matrices[g]=e;c.setVariable(g+".filas",e[0].length);c.setVariable(g+".columnas",e.length)}return 0}};var g=document.createElement("a"),f;this.functions._Save_=function(a,b){document.body.appendChild(g);f=new Blob([b.replace(/\\n/g,"\n").replace(/\\q/g,"'")],{type:"text/plain"});g.setAttribute("download",
a);g.setAttribute("href",window.URL.createObjectURL(f));g.click();document.body.removeChild(g);return 0};var e,h,k,p,m=document.createElement("input");m.setAttribute("type","file");onHandleFileSelect=function(b){e=b.target.files;h=new FileReader;h.onload=function(b){a.addExternalFileContent(e[0].name,b.target.result);c.setVariable(k,e[0].name);c.getFunction(p)&&(c.getFunction(p).apply(c.evaluator,[]),c.evaluator.parent.update())};0<e.length&&h.readAsText(e[0])};m.addEventListener("change",onHandleFileSelect);
this.functions._Open_=function(a,b){k=a;p=b;m.click();return 0};this.functions._SaveState_=function(){this.functions._Save_("state.txt",JSON.stringify({variables:this.variables,vectors:this.vectors,matrices:this.matrices}));return 0};var q,l,s=document.createElement("input");s.setAttribute("type","file");onHandleFileSelect2=function(a){a.stopPropagation();a.preventDefault();q=a.target.files;l=new FileReader;l.onload=function(a){var g={};try{g=JSON.parse(a.target.result)}catch(d){}g.variables&&b(c.variables,
g.variables);g.vectors&&b(c.vectors,g.vectors);g.matrices&&b(c.matrices,g.matrices);c.evaluator.parent.update()};0<q.length&&l.readAsText(q[0])};s.removeEventListener("change",onHandleFileSelect2);s.addEventListener("change",onHandleFileSelect2);this.functions._OpenState_=function(){s.click();return 0};this.functions._Rojo_=function(b){return(new a.Color(b)).r/255};this.functions._Verde_=function(b){return(new a.Color(b)).g/255};this.functions._Azul_=function(b){return(new a.Color(b)).b/255};this.functions._AnchoDeCadena_=
function(b,c,g,d){return a.getTextWidth(b,a.convertFont(c+","+g+","+d))};this.functions._GetDay_=function(){return(new Date).getDate()};this.functions._GetMonth_=function(){return(new Date).getMonth()+1};this.functions._GetYear_=function(){return(new Date).getFullYear()};this.functions._GetHours_=function(){return(new Date).getHours()};this.functions._GetMinutes_=function(){return(new Date).getMinutes()};this.functions._GetSeconds_=function(){return(new Date).getSeconds()};this.functions._MatrixToStr_=
function(a){var b=this.matrices[a];if(b){strM="<"+a+">\\n";for(var c=0,g=b.rows;c<g;c++){for(var d=0,f=b.cols;d<f;d++)strM+=b[c][d]+(d<f-1?" "+String.fromCharCode("166")+" ":"");strM+="\\n"}return strM+="</"+a+">"}return""}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=Math.floor;a.Evaluator=function(d){this.parent=d;this.parser=new a.Parser(this);this.variables=this.parser.variables;this.functions=this.parser.functions;this.vectors=this.parser.vectors;this.matrices=
this.parser.matrices;this.definitions=this.parser.definitions};a.Evaluator.prototype.setDefinition=function(a,d){this.definitions[a]=d};a.Evaluator.prototype.getDefinition=function(a){return this.definitions[a]};a.Evaluator.prototype.setVariable=function(a,d){this.variables[a]=d};a.Evaluator.prototype.getVariable=function(a){return this.variables[a]};a.Evaluator.prototype.setVector=function(a,f,c){f=0>f?0:d(f);this.vectors[a][f]=c};a.Evaluator.prototype.getVector=function(a,f){f=0>f?0:d(f);return this.vectors[a][f]};
a.Evaluator.prototype.setMatrix=function(a,f,c,b){f=0>f?0:d(f);c=0>c?0:d(c);this.matrices[a][f][c]=b};a.Evaluator.prototype.getMatrix=function(a,f,c){f=0>f?0:d(f);c=0>c?0:d(c);return this.matrices[a][f][c]};a.Evaluator.prototype.setFunction=function(a,d){this.functions[a]=d};a.Evaluator.prototype.getFunction=function(a){return this.functions[a]};a.Evaluator.prototype.evalExpression=function(a){return a?a.evaluate(this):0};a.externalEvaluator=new a.Evaluator;return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var d=2,e=!1,f;a.RTFNode=function(a,b,c,d){this.evaluator=a;this.type="rtfNode";this.value=b;this.nodeType=c;this.style=d;this.styleString=d.toString();this.color=d.textColor;this.underline=d.textUnderline;this.overline=d.textOverline;this.parent=null;this.children=[];switch(this.nodeType){case "textBlock":this.draw=this.drawTextBlock;break;case "textLineBlock":this.draw=this.drawTextLineBlock;break;case "formula":this.draw=this.drawFormula;break;case "superIndex":this.draw=
this.drawSuperIndex;break;case "subIndex":this.draw=this.drawSubIndex;break;case "dynamicText":this.draw=this.drawDynamicText;this.decimal_symbol=this.evaluator.parent.decimal_symbol;break;case "fraction":this.draw=this.drawFraction;break;case "numerator":case "denominator":this.draw=this.drawNumDen;break;case "radical":this.draw=this.drawRadical;break;case "limit":this.draw=this.drawLimit;break;case "integral":this.draw=this.drawIntegral;break;case "sum":this.draw=this.drawSum;break;case "matrix":this.draw=
this.drawMatrix;break;case "defparts":this.draw=this.drawDefparts;break;case "text":case "newLine":this.draw=this.drawText;break;case "hyperlink":this.draw=this.drawHyperlink;break;case "mathSymbol":this.draw=this.drawMathSymbol;break;case "index":case "radicand":case "from":case "to":case "what":case "element":this.draw=this.drawGenericBlock;break;case "componentNumCtrl":this.draw=this.drawComponentNumCtrl;break;case "componentSpace":this.draw=this.drawComponentSpace}};a.RTFNode.prototype.getRoot=
function(){return null==this.parent?this:this.parent.getRoot()};a.RTFNode.prototype.addChild=function(a){a.parent=this;this.children.push(a)};var c=0,b=0,k=0;a.RTFNode.prototype.getTextMetrics=function(){if("textBlock"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);for(var g=0,f=this.children.length;g<f;g++)this.children[g].getTextMetrics()}else if("textLineBlock"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),this.getBlockMetric();else if("newLine"==this.nodeType){this.spaceWidth=
a.getTextWidth(" ",this.styleString);var h=a.getFontMetrics(this.styleString);this.baseline=h.baseline;this.descent=h.descent;this.ascent=h.ascent;this.w=0;this.h=h.h}else if("text"==this.nodeType||"dynamicText"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);h=a.getFontMetrics(this.styleString);this.baseline=h.baseline;this.descent=h.descent;this.ascent=h.ascent;var g=this.value,q;"string"!=typeof this.value&&(f=void 0==this.decimals?d:this.evaluator.evalExpression(this.decimals),
q=void 0==this.fixed?e:this.fixed,g=this.evaluator.evalExpression(this.value,f,q),parseFloat(g).toString()===g.toString()&&(g=q?parseFloat(g).toFixed(f):a.removeNeedlessDecimals(parseFloat(g).toFixed(f)),g=(""+g).replace(".",this.decimal_symbol)),g+=" ");this.w=a.getTextWidth(g,this.styleString);this.h=h.h}else if("formula"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),this.getBlockMetric();else if("hyperlink"===this.nodeType){g=a.getFontMetrics(this.styleString);this.baseline=
g.baseline;this.descent=g.descent;this.ascent=g.ascent;this.w=a.getTextWidth(this.value,this.styleString);this.h=g.h;this.clickCacher=document.createElement("div");this.clickCacher.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; cursor: pointer;");var m=this;this.clickCacher.addEventListener("click",function(a){m.click=!0;window.open(m.URL,m.URL)})}else if("superIndex"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),f=c,h=b,q=k,g=a.getFontMetrics(this.styleString),
this.getBlockMetric(),0>this.h&&(this.ascent=g.ascent,this.descent=g.descent,this.h=this.ascent+this.descent,this.w=1.5*this.spaceWidth),g=q/2-h+this.h,this.superIndexPos=g-this.ascent,this.ascent=g,this.descent=h,this.baseline=this.ascent,this.h=this.ascent+this.descent;else if("subIndex"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),f=c,h=b,q=k,g=a.getFontMetrics(this.styleString),this.getBlockMetric(),0>this.h&&(this.ascent=g.ascent,this.descent=g.descent,this.h=this.ascent+
this.descent,this.w=1.5*this.spaceWidth),this.subIndexPos=h+1,this.ascent=f,this.descent=this.subIndexPos+this.descent,this.baseline=this.ascent,this.h=this.ascent+this.descent;else if("fraction"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);var l=this.children[0],s=this.children[1],g=a.getFontMetrics(l.styleString);l.getBlockMetric();s.getBlockMetric();f=c;h=b;q=k;0>l.h&&(l.h=g.h,l.w=this.spaceWidth);0>s.h&&(s.h=g.h,s.w=this.spaceWidth);this.h=l.h+s.h-1;this.ascent=l.h+Math.round(q/
2)-h;this.descent=this.h-this.ascent;this.baseline=this.ascent;this.w=Math.max(l.w,s.w)+this.spaceWidth+8}else if("radical"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);h=this.children[0].style.clone();if(1===this.children.length)this.children[1]=new a.RTFNode(this.evaluator," ","radicand",h),this.children[1].addChild(this.children[0]),this.children[0]=new a.RTFNode(this.evaluator," ","index",h);else if("index"!==this.children[0].nodeType||"radicand"!==this.children[1].nodeType){q=
new a.RTFNode(this.evaluator,"","radicand",h);g=0;for(f=this.children.length;g<f;g++)q.addChild(this.children[g]);this.children=[];this.children[0]=new a.RTFNode(this.evaluator,"","index",h);this.children[1]=q}g=this.children[0];f=this.children[1];0>=g.children.length&&(h=this.style.clone(),h.fontSize=parseInt(h.fontSize-0.2*h.fontSize),g.addChild(new a.RTFNode(this.evaluator," ","text",h)));0>=f.children.length&&f.addChild(new a.RTFNode(this.evaluator," ","text",this.style.clone()));g.getBlockMetric();
f.getBlockMetric();this.ascent=f.h/2<g.h?f.h/2+g.h+2-f.descent:f.ascent+4;this.descent=f.descent;this.baseline=this.ascent;this.h=this.ascent+this.descent;this.w=g.w+f.w+4*this.spaceWidth}else if("sum"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),f=c,h=b,q=k,h=this.children[0],f=this.children[1],q=this.children[2],h.getBlockMetric(),f.getBlockMetric(),q.getBlockMetric(),-1==h.ascent&&(l=a.getFontMetrics(h.styleString),h.ascent=l.ascent,h.descent=l.descent,h.h=l.h),-1==f.ascent&&
(l=a.getFontMetrics(f.styleString),f.ascent=l.ascent,f.descent=l.descent,f.h=l.h),g=a.getFontMetrics(this.styleString),this.ascent=g.h+f.h>q.ascent?g.h-g.descent+f.h:q.ascent,this.descent=h.h>q.descent?h.h+g.descent:q.descent,this.baseline=this.ascent,this.h=this.ascent+this.descent,g=this.style.clone(),g.fontType="Times New Roman",g.Bold="bold",g=g.toString(),g=a.getTextWidth(String.fromCharCode(8721),g),this.w=Math.max(h.w,f.w,g)+Math.max(q.w,this.spaceWidth)+this.spaceWidth;else if("integral"==
this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),f=c,h=b,q=k,h=this.children[0],f=this.children[1],q=this.children[2],h.getBlockMetric(),f.getBlockMetric(),q.getBlockMetric(),-1==h.ascent&&(l=a.getFontMetrics(h.styleString),h.ascent=l.ascent,h.descent=l.descent,h.h=l.h),-1==f.ascent&&(l=a.getFontMetrics(f.styleString),f.ascent=l.ascent,f.descent=l.descent,f.h=l.h),g=a.getFontMetrics(this.styleString),this.ascent=g.h+f.h>q.ascent?g.h-g.descent+f.h:q.ascent,this.descent=h.h>q.descent?
h.h+g.descent:q.descent,this.baseline=this.ascent,this.h=this.ascent+this.descent,g=this.style.clone(),g.fontSize*=1.5,g.fontType="Times New Roman",g.Bold="bold",g=g.toString(),g=a.getTextWidth(String.fromCharCode(8747),g),this.w=Math.max(h.w,f.w,g)+Math.max(q.w,this.spaceWidth)+2*this.spaceWidth;else if("limit"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),f=c,h=b,q=k,h=this.children[0],f=this.children[1],q=this.children[2],g=a.getFontMetrics(this.styleString),h.getBlockMetric(),
f.getBlockMetric(),q.getBlockMetric(),-1==h.ascent&&(l=a.getFontMetrics(h.styleString),h.ascent=l.ascent,h.descent=l.descent,h.h=l.h),-1==f.ascent&&(l=a.getFontMetrics(f.styleString),f.ascent=l.ascent,f.descent=l.descent,f.h=l.h),-1==q.ascent&&(l=a.getFontMetrics(q.styleString),q.ascent=l.ascent,q.descent=l.descent,q.h=l.h),this.ascent=q.ascent,this.descent=Math.max(g.h,q.descent),this.baseline=this.ascent,this.h=this.ascent+this.descent,g=a.getTextWidth(" "+String.fromCharCode(8594),this.styleString),
0==h.w&&(h.w=this.spaceWidth),0==f.w&&(f.w=this.spaceWidth),0==q.w&&(q.w=this.spaceWidth),this.w=f.w+h.w+q.w+g+this.spaceWidth;else if("matrix"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);g=a.getFontMetrics(this.styleString);f=c;h=b;q=k;q=g.ascent;for(var l=g.descent,s=g.h,t=this.spaceWidth,n,u,g=0,f=this.children.length;g<f;g++)this.children[g].getBlockMetric(),n=this.children[g].h,u=this.children[g].w,s<n&&(s=n,q=this.children[g].ascent,l=this.children[g].descent),t<u&&
(t=u);this.childWidth=t+2*this.spaceWidth;this.childh=s;this.childAscent=q;this.childDescent=l;this.h=this.rows*s;this.ascent=this.h/2+h;this.descent=this.h-this.ascent;this.w=this.columns*this.childWidth+this.spaceWidth}else if("defparts"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);g=a.getFontMetrics(this.styleString);f=c;h=b;q=k;q=g.ascent;l=g.descent;s=g.h;t=this.spaceWidth;g=0;for(f=this.children.length;g<f;g++)this.children[g].getBlockMetric(),n=this.children[g].h,u=
this.children[g].w,s<n&&(s=n,q=this.children[g].ascent,l=this.children[g].descent),t<u&&(t=u);this.childWidth=t+2*this.spaceWidth;this.childh=s;this.childAscent=q;this.childDescent=l;this.h=this.parts*s;this.ascent=this.h/2+h;this.descent=this.h-this.ascent;this.w=t+this.spaceWidth/2}else"mathSymbol"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),h=a.getFontMetrics(this.styleString),this.baseline=h.baseline,this.descent=h.descent,this.ascent=h.ascent,this.w=a.getTextWidth(this.value,
this.styleString)+this.spaceWidth,this.h=h.h):"componentNumCtrl"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),this.componentNumCtrl=this.evaluator.parent.getControlByCId(this.value),h=this.componentNumCtrl.h||0,this.baseline=Math.round(3*h/5),this.descent=Math.round(2*h/5),this.ascent=this.baseline,this.h=h,this.w=this.componentNumCtrl.w):"componentSpace"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),this.componentSpace=this.evaluator.parent.getSpaceByCId(this.value),
this.h=this.ascent=this.descent=this.baseline=0,this.w=this.componentSpace.w):console.log("Element i=unknown",this.nodeType)};a.RTFNode.prototype.getBlockMetric=function(){this.w=0;for(var a=-1,d=-1,f,e=0,m=this.children.length;e<m;e++){f=this.children[e];f.getTextMetrics();childAscent=f.ascent;childDescent=f.descent;this.w+=f.w;var l=childDescent;f=f.h;c=childAscent;b=l;k=f;d<childAscent&&(d=childAscent);a<childDescent&&(a=childDescent)}this.ascent=d;this.descent=a;this.baseline=this.ascent;this.h=
this.ascent+this.descent};a.RTFNode.prototype.drawTextBlock=function(a,b,c,k,m,l,s,t){f=t;this.stableWidth||(d=k,e=m,this.getTextMetrics());s=s?-this.children[0].ascent:0;m=k=0;for(l=this.children.length;m<l;m++)0<m&&(k+=this.children[m-1].h),this.children[m].draw(a,b+0,c+s+k)};a.RTFNode.prototype.drawTextLineBlock=function(a,b,c){for(var d=0,e=0,k=this.children.length;e<k;e++)a.strokeStyle=f,a.fillStyle=f,0<e&&(d+=this.children[e-1].w,"formula"==this.children[e-1].nodeType&&(d+=2*this.children[e-
1].spaceWidth)),this.children[e].draw(a,b+d,c+this.baseline)};a.RTFNode.prototype.drawFormula=function(a,b,c){for(var d=0,f=0,e=this.children.length;f<e;f++)0<f&&(d+=this.children[f-1].w),this.children[f].draw(a,b+this.spaceWidth+d,c)};a.RTFNode.prototype.drawText=function(a,b,c){null!=this.color&&(a.fillStyle=this.color);a.font=this.styleString;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,b-1,c);if(this.underline){var d="bold"==this.style.textBold,f=d?1:0.5;a.lineWidth=d?
2:1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(b-1,parseInt(c+this.descent/2)+f);a.lineTo(b-1+this.w,parseInt(c+this.descent/2)+f);a.stroke()}this.overline&&(f=(d="bold"==this.style.textBold)?2:1.5,a.lineWidth=d?2:1,null!=this.color&&(a.strokeStyle=this.color),a.beginPath(),a.moveTo(b-1,parseInt(c-this.ascent)+f),a.lineTo(b-1+this.w,parseInt(c-this.ascent)+f),a.stroke())};a.RTFNode.prototype.drawDynamicText=function(b,c,f){var k=Math.floor(0.5*this.spaceWidth),m=void 0==this.decimals?
d:this.evaluator.evalExpression(this.decimals),l=void 0==this.fixed?e:this.fixed,s=this.evaluator.evalExpression(this.value);parseFloat(s).toString()===s.toString()&&(s=l?parseFloat(s).toFixed(m):a.removeNeedlessDecimals(parseFloat(s).toFixed(m)),s=(""+s).replace(".",this.decimal_symbol));null!=this.color&&(b.fillStyle=this.color);b.font=this.styleString;b.textAlign="start";b.textBaseline="alphabetic";this.w=a.getTextWidth(s,this.styleString);b.fillText(s,k+c,f);this.underline&&(l=(m="bold"==this.style.textBold)?
1:0.5,b.lineWidth=m?2:1,null!=this.color&&(b.strokeStyle=this.color),b.beginPath(),b.moveTo(k+c-1,parseInt(f+this.descent/2)+l),b.lineTo(k+c-1+this.w,parseInt(f+this.descent/2)+l),b.stroke());this.overline&&(l=(m="bold"==this.style.textBold)?2:1.5,b.lineWidth=m?2:1,null!=this.color&&(b.strokeStyle=this.color),b.beginPath(),b.moveTo(k+c-1,parseInt(f-this.ascent)+l),b.lineTo(k+c-1+this.w,parseInt(f-this.ascent)+l),b.stroke());this.w+=2*k};a.RTFNode.prototype.drawHyperlink=function(a,b,c){this.clickCacher.parentNode||
(a.canvas.nextSibling.className?a.canvas.parentNode.insertBefore(this.clickCacher,a.canvas.nextSibling.nextSibling):a.canvas.parentNode.insertBefore(this.clickCacher,a.canvas.nextSibling),this.clickCacher.style.left=b-2+"px",this.clickCacher.style.top=c-this.ascent-2+"px");a.save();this.click?(a.fillStyle="red",a.strokeStyle="red"):(a.fillStyle="blue",a.strokeStyle="blue");a.font=this.styleStr;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,b-1,c);var d="bold"==this.style.textBold,
f=d?1:0.5;a.lineWidth=d?2:1;a.beginPath();a.moveTo(b-1,Math.ceil(c+this.descent/2)+f-2);a.lineTo(b-1+this.w,Math.ceil(c+this.descent/2)+f-2);a.stroke();a.restore()};a.RTFNode.prototype.drawRadical=function(a,b,c){var d=Math.floor(this.spaceWidth);this.children[0].draw(a,b,Math.floor(c+this.children[1].descent-this.children[1].h/2-this.children[0].descent));this.children[1].draw(a,b+1.5*d+this.children[0].w,c);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(b,Math.floor(c+
this.children[1].descent-this.children[1].h/2));a.lineTo(b+this.children[0].w,Math.floor(c+this.children[1].descent-this.children[1].h/2));a.lineTo(b+this.children[0].w+0.5*d,c+this.children[1].descent);a.lineTo(b+this.children[0].w+1*d,c-this.children[1].ascent);a.lineTo(b+this.children[0].w+2*d+this.children[1].w,c-this.children[1].ascent);a.stroke()};a.RTFNode.prototype.drawFraction=function(a,b,c){this.children[0].draw(a,b+(this.w-this.children[0].w)/2,c-this.ascent);this.children[1].draw(a,b+
(this.w-this.children[1].w)/2,c-this.ascent+this.children[0].h-1);var d=Math.floor(0.5*this.spaceWidth);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(b+d,parseInt(c-this.ascent+this.children[0].h)-0.5);a.lineTo(b-d+this.w-1,parseInt(c-this.ascent+this.children[0].h)-0.5);a.stroke()};a.RTFNode.prototype.drawNumDen=function(a,b,c){for(var d=0,f=0,e=this.children.length;f<e;f++)0<f&&(d+=this.children[f-1].w),this.children[f].draw(a,b+d,c+this.baseline)};a.RTFNode.prototype.drawSubIndex=
function(a,b,c){for(var d=0,f=0,e=this.children.length;f<e;f++)0<f&&(d+=this.children[f-1].w),this.children[f].draw(a,b+d,c+this.subIndexPos)};a.RTFNode.prototype.drawSuperIndex=function(a,b,c){for(var d=0,f=0,e=this.children.length;f<e;f++)0<f&&(d+=this.children[f-1].w),this.children[f].draw(a,b+d,c-this.superIndexPos)};a.RTFNode.prototype.drawLimit=function(b,c,d){var f=a.getFontMetrics(this.styleString),e=" "+String.fromCharCode(8594),k=a.getTextWidth(e,this.styleString);this.children[0].draw(b,
c,d+f.descent+this.children[0].ascent);this.children[1].draw(b,c+this.children[0].w+k,d+f.descent+this.children[1].ascent);this.children[2].draw(b,c+k+this.children[0].w+this.children[1].w,d);null!=this.color&&(b.fillStyle=this.color);b.font=this.styleString;b.textAlign="start";b.textBaseline="alphabetic";b.fillText("l\u00edm",c+this.children[0].w,d);b.fillText(e,c+this.children[0].w,d+f.descent+this.children[0].ascent)};a.RTFNode.prototype.drawIntegral=function(b,c,d){var f=this.style.clone();f.fontSize*=
1.5;f.fontType="Times New Roman";f.Bold="bold";var f=f.toString(),e=a.getTextWidth(String.fromCharCode(8747),f),k=a.getFontMetrics(f),s=Math.max(this.children[0].w,this.children[1].w,Math.floor(1.5*e));this.children[0].draw(b,c+e,d+k.descent+this.children[0].ascent);this.children[1].draw(b,c+e+this.spaceWidth/2,d-this.ascent+this.children[1].ascent);this.children[2].draw(b,c+s+e,d);null!=this.color&&(b.fillStyle=this.color);b.font=f;b.textAlign="start";b.textBaseline="alphabetic";b.fillText(String.fromCharCode(8747),
c,d+k.descent/2)};a.RTFNode.prototype.drawSum=function(b,c,d){var f=this.style.clone();f.fontType="Times New Roman";f.Bold="bold";var f=f.toString(),e=a.getTextWidth(String.fromCharCode(8721),f),k=a.getFontMetrics(this.styleString),s=Math.max(this.children[0].w,this.children[1].w,e);this.children[0].draw(b,c+(s-this.children[0].w)/2,d+k.descent+this.children[0].ascent);this.children[1].draw(b,c+(s-this.children[1].w)/2,d-k.ascent-this.children[1].descent);this.children[2].draw(b,c+s,d);null!=this.color&&
(b.fillStyle=this.color);b.font=f;b.textAlign="start";b.textBaseline="alphabetic";b.fillText(String.fromCharCode(8721),c+Math.floor((s-e)/2),d-5)};a.RTFNode.prototype.drawMatrix=function(a,b,c){for(var d,f,e=0,k=this.children.length;e<k;e++)d=e%this.columns,f=Math.floor(e/this.columns),this.children[e].draw(a,2*this.spaceWidth+b+d*this.childWidth,c-this.ascent+this.childAscent+f*this.childh);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(Math.floor(b+this.spaceWidth)+
0.5,c-this.ascent+0.5);a.lineTo(Math.floor(b+this.spaceWidth/2)+0.5,c-this.ascent+0.5);a.lineTo(Math.floor(b+this.spaceWidth/2)+0.5,c+this.descent+0.5);a.lineTo(Math.floor(b+this.spaceWidth)+0.5,c+this.descent+0.5);a.moveTo(Math.floor(b+this.w-this.spaceWidth)-0.5,c-this.ascent+0.5);a.lineTo(Math.floor(b+this.w-this.spaceWidth/2)-0.5,c-this.ascent+0.5);a.lineTo(Math.floor(b+this.w-this.spaceWidth/2)-0.5,c+this.descent+0.5);a.lineTo(Math.floor(b+this.w-this.spaceWidth)-0.5,c+this.descent+0.5);a.stroke()};
a.RTFNode.prototype.drawDefparts=function(a,b,c){for(var d=0,f=this.children.length;d<f;d++)this.children[d].draw(a,b+3*this.spaceWidth,c-this.ascent+this.childAscent+d%this.parts*this.childh);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(parseInt(b+2*this.spaceWidth)+0.5,c-this.ascent+0.5);a.lineTo(parseInt(b+2*this.spaceWidth)-4.5,c-this.ascent+4.5);a.lineTo(parseInt(b+2*this.spaceWidth)-4.5,c+this.descent-this.h/2-4.5);a.lineTo(b-0.5,c+this.descent-this.h/2);
a.lineTo(parseInt(b+2*this.spaceWidth)-4.5,c+this.descent-this.h/2+4.5);a.lineTo(parseInt(b+2*this.spaceWidth)-4.5,c+this.descent-4.5);a.lineTo(parseInt(b+2*this.spaceWidth)+0.5,c+this.descent+0.5);a.stroke()};a.RTFNode.prototype.drawMathSymbol=function(a,b,c){a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color,a.fillStyle=this.color);a.beginPath();"("==this.value?(a.font=this.styleString,a.textAlign="start",a.textBaseline="alphabetic",a.fillText("(",b,c)):")"==this.value?(a.font=this.styleString,
a.textAlign="start",a.textBaseline="alphabetic",a.fillText(")",b+this.spaceWidth,c)):(a.font=this.styleString,a.textAlign="center",a.textBaseline="alphabetic",a.fillText(this.value,b+this.w/2,c))};a.RTFNode.prototype.drawGenericBlock=function(a,b,c){for(var d=0,f=0,e=this.children.length;f<e;f++)0<f&&(d+=this.children[f-1].w),this.children[f].draw(a,b+d,c)};a.RTFNode.prototype.drawComponentNumCtrl=function(a,b,c){this.parent.getTextMetrics();this.componentNumCtrl.expresion=this.evaluator.parser.parse("("+
b+","+(c-this.ascent)+","+this.componentNumCtrl.w+","+this.componentNumCtrl.h+")")};a.RTFNode.prototype.drawComponentSpace=function(a,b,c){this.getTextMetrics();this.componentSpace.xExpr=this.evaluator.parser.parse(b+"");this.componentSpace.yExpr=this.evaluator.parser.parse(c-this.parent.ascent+"")};a.RTFNode.prototype.draw=function(a,b,c){console.log(">>> Dibujo desconocido ",this.nodeType)};a.RTFNode.prototype.toHTML=function(){var a="";if("textLineBlock"===this.nodeType||"textBlock"===this.nodeType)for(var b=
0,c=this.children.length;b<c;b++)a+=this.children[b].toHTML();else"text"===this.nodeType?a="<span "+this.style.toCSS()+">"+this.value+"</span>":"newLine"===this.nodeType&&(a="<span "+this.style.toCSS()+">"+this.value+"<br /></span>");return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d=String.fromCharCode,e,f,c,b,k,g,p,h,q,m,l;a.RTFTokenizer=function(){};a.RTFTokenizer.prototype.tokenize=function(a){if(a)a=a.replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&quote;/g,
"''").replace(/\&squot;/g,"'").replace(/\\rquote /g,"'").replace(/\\endash /g,"-").replace(/\n/g," ").replace(/\r/g,"").replace(/\\uc(\d+) /g,"").replace(/\\uc(\d+)/g,"");else return[];e=[];f=a.length;e=[];c="";k=b=0;p=a.charAt(0);h=!1;for(q="text";b<f;)g=p,p=a.charAt(b+1),h?"\\"===p||"{"===p||"}"===p||" "===p||";"===p?(h=!1,c+=g," "===p&&(b++,p=a.charAt(b+1)),(m=c.match(/^\'([0-9a-f]{2})/))?(l="","text"===q&&(l=e.pop().value),c=l+=d(parseInt(m[1],16))+c.substring(3)):(m=c.match(/^u[0-9]+/))?(l="",
"text"===q&&(l=e.pop().value),c=l+=d(m[0].substring(1))):("{"===c||"}"===c?(e.push({type:"text",value:c}),q="text"):(e.push({type:"controlWord",value:c}),q="controlWord"),c="")):c+=g:"\\"===g?(h=!0,""!==c&&(e.push({type:"text",value:c}),q="text"),c=""):"{"===g?(k++,""!==c&&e.push({type:"text",value:c}),c="",e.push({type:"openBlock",value:k}),q="openBlock"):"}"===g?(""!==c&&e.push({type:"text",value:c}),c="",e.push({type:"closeBlock",value:k}),q="closeBlock",k--):c+=g,b++;""!==c&&e.push({type:"text",
value:c});return e};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g,p,h,q,m,l,s,t,n,u,r,v,w,y,C,A,D,E,z,B,G,H,K,L;a.RTFParser=function(b){this.evaluator=b;this.tokenizer=new a.RTFTokenizer};a.RTFParser.prototype.parse=function(x){x=d=this.tokenizer.tokenize(x);for(var J=[],F=!1,P=!1,M=[],I=0,R=x.length;I<R;I++)if("openBlock"==x[I].type&&M.push(x[I].value),"closeBlock"==x[I].type&&(M.pop(),0>=M.length&&(F=!1)),"controlWord"!=x[I].type||"expr"!=x[I].value&&
"decimals"!=x[I].value||(P=!0),"controlWord"==x[I].type&&"mjaformula"==x[I].value&&(F=!0),"text"==x[I].type&&F&&!P){for(var S=0,O=x[I].value,Q="",N=0,V=O.length;N<V;N++)if("("==O.charAt(N)||")"==O.charAt(N)||"+"==O.charAt(N)||"-"==O.charAt(N)||"*"==O.charAt(N)||"="==O.charAt(N))Q=O.substring(S,N),""!=Q&&J.push({type:"text",value:Q}),J.push({type:O.charAt(N),value:O.charAt(N)}),S=N+1;Q=O.substring(S,N);""!=Q&&J.push({type:"text",value:Q})}else J.push(x[I]),"text"==x[I].type&&P&&(P=!1);d=J;e={};c=2;
if("openBlock"==d[0].type&&"fonttbl"==d[1].value){for(f=d[0].value;"closeBlock"!=d[c].type&&d[c].value!=f;)e[d[c].value]=d[c+2].value.substring(0,d[c+2].value.length-1),c+=3;c++}b={};k=0;if("openBlock"==d[c].type&&"colortbl"==d[c+1].value){f=d[c++].value;for(c++;"closeBlock"!=d[c].type&&d[c].value!=f;)g=parseInt(d[c++].value.substring(3)).toString(16),p=parseInt(d[c++].value.substring(5)).toString(16),h=parseInt(d[c++].value.substring(4)).toString(16),";"===d[c].value&&c++,b[k++]="#"+(2>g.length?
"0"+g:g)+(2>p.length?"0"+p:p)+(2>h.length?"0"+h:h);c++}q=new a.RTFNode(this.evaluator,"","textBlock","",!1,"");m=new a.RTFNode(this.evaluator,"","textLineBlock","",!1,"");q.addChild(m);t=s=l=null;y=w=v=r=u=n=!1;C=[new a.FontStyle(20,"Arial","","",!1,!1,null)];A=C[0];D=!0;z=E=-1;B=[];L=K=H=G=!1;x=c;for(J=d.length;x<J;x++)if("controlWord"==d[x].type&&e[d[x].value])A.fontType=e[d[x].value];else if("controlWord"==d[x].type&&d[x].value.match(/^fs(\d+)/))A.fontSize=parseInt(d[x].value.match(/^fs(\d+)/)[1]/
2);else if("controlWord"==d[x].type&&"b"==d[x].value)A.textBold="bold";else if("controlWord"==d[x].type&&"b0"==d[x].value)A.textBold="";else if("controlWord"==d[x].type&&"i"==d[x].value)A.textItalic="italic";else if("controlWord"==d[x].type&&"i0"==d[x].value)A.textItalic="";else if("controlWord"==d[x].type&&"ul"==d[x].value)A.textUnderline=!0;else if("controlWord"==d[x].type&&"ulnone"==d[x].value)A.textUnderline=!1;else if("controlWord"==d[x].type&&"ol"==d[x].value)A.textOverline=!0;else if("controlWord"==
d[x].type&&"olnone"==d[x].value)A.textOverline=!1;else if("controlWord"==d[x].type&&d[x].value.match(/^cf(\d+)/))A.textColor=b[parseInt(d[x].value.substring(2))],0<B.length&&(B[B.length-1].style.textColor=A.textColor);else if("openBlock"==d[x].type)E=d[x].value,A=A.clone(),C.push(A),B.push(null);else if("closeBlock"==d[x].type)d[x].value==z&&(z=-1,n=!1,m=m.parent),C.pop(),A=C[C.length-1],B.pop();else if("controlWord"==d[x].type&&"par"==d[x].value){m.addChild(new a.RTFNode(this.evaluator,"","newLine",
A.clone()));q=new a.RTFNode(this.evaluator,"","textLineBlock",A.clone());if("textBlock"!=m.nodeType)for(m=m.parent;"textBlock"!=m.nodeType;)m=m.parent;m.addChild(q);m=q}else if("controlWord"==d[x].type&&"mjaformula"==d[x].value)G=!0,z=E,n=!0,q=new a.RTFNode(this.evaluator,"","formula",A.clone()),m.addChild(q),m=q,B[B.length-1]=q;else if("controlWord"==d[x].type&&("fraction"==d[x].value||"radicand"==d[x].value||"radical"==d[x].value||"what"==d[x].value||"sum"==d[x].value||"integral"==d[x].value||"limit"==
d[x].value))F=B[B.length-2].style.clone(),q=new a.RTFNode(this.evaluator,"",d[x].value,F),B[B.length-2].addChild(q),B[B.length-1]=q;else if("controlWord"==d[x].type&&"index"==d[x].value||"to"==d[x].value||"from"==d[x].value)F=B[B.length-2].style.clone(),F.fontSize=parseInt(F.fontSize-0.2*F.fontSize),8>F.fontSize&&(F.fontSize=8),q=new a.RTFNode(this.evaluator,"",d[x].value,F),B[B.length-2].addChild(q),B[B.length-1]=q;else if("controlWord"==d[x].type&&("num"==d[x].value||"den"==d[x].value))F=B[B.length-
2].style.clone(),F.fontSize=Math.round(F.fontSize-0.1*F.fontSize),8>F.fontSize&&(F.fontSize=8),"num"==d[x].value?q=new a.RTFNode(this.evaluator,"","numerator",F):"den"==d[x].value&&(q=new a.RTFNode(this.evaluator,"","denominator",F)),B[B.length-2].addChild(q),B[B.length-1]=q;else if("controlWord"==d[x].type&&("subix"==d[x].value||"supix"==d[x].value))F=B[B.length-2].style.clone(),F.fontSize=Math.floor(F.fontSize-F.fontSize/3),8>F.fontSize&&(F.fontSize=8),"subix"==d[x].value?q=new a.RTFNode(this.evaluator,
"","subIndex",F):"supix"==d[x].value&&(q=new a.RTFNode(this.evaluator,"","superIndex",F)),q.originalStyle=B[B.length-2].style.clone(),B[B.length-2].addChild(q),B[B.length-1]=q;else if("controlWord"==d[x].type&&("defparts"==d[x].value||"matrix"==d[x].value||"element"==d[x].value))F=B[B.length-2].style.clone(),q=new a.RTFNode(this.evaluator,"",d[x].value,F),B[B.length-2].addChild(q),B[B.length-1]=q,"defparts"==d[x].value?t=q:"matrix"==d[x].value&&(s=q);else if("controlWord"==d[x].type&&"parts"==d[x].value)y=
!0;else if("text"==d[x].type&&y)t.parts=parseInt(d[x].value),y=!1;else if("controlWord"==d[x].type&&"rows"==d[x].value)v=!0;else if("text"==d[x].type&&v)s.rows=parseInt(d[x].value),v=!1;else if("controlWord"==d[x].type&&"columns"==d[x].value)w=!0;else if("text"==d[x].type&&w)s.columns=parseInt(d[x].value),w=!1;else if("controlWord"==d[x].type&&"expr"==d[x].value)D=!1,u=!0;else if("controlWord"==d[x].type&&"decimals"==d[x].value)r=!0;else if("text"==d[x].type&&r)l.decimals=this.evaluator.parser.parse(d[x].value+
""),r=!1;else if("controlWord"==d[x].type&&"fixed1"==d[x].value)l.fixed=!0;else if("controlWord"==d[x].type&&"fixed0"==d[x].value)l.fixed=!1;else if("controlWord"!=d[x].type||"component"!=d[x].value)if("controlWord"==d[x].type&&"NumCtrl"==d[x].value)H=!0;else if("controlWord"==d[x].type&&"Space"==d[x].value)K=!0;else if("controlWord"==d[x].type&&"hyperlink"==d[x].value)L=!0;else if("text"==d[x].type&&L){textContent=d[x].value.split("|")[0];F=A.clone();q=new a.RTFNode(this.evaluator,textContent,"hyperlink",
F);q.URL=d[x].value.split("|")[1];if("textLineBlock"!=m.nodeType)for(m=m.parent;"textLineBlock"!=m.nodeType;)m=m.parent;m.addChild(q);L=!1}else if("text"==d[x].type&&H)q=new a.RTFNode(this.evaluator,d[x].value,"componentNumCtrl",A.clone()),m.addChild(q),H=!1;else if("text"==d[x].type&&K)q=new a.RTFNode(this.evaluator,d[x].value,"componentSpace",A.clone()),m.addChild(q),K=!1;else if("text"==d[x].type&&u)F=B[B.length-2].style.clone(),textContent=this.evaluator.parser.parse(d[x].value),q=new a.RTFNode(this.evaluator,
textContent,"dynamicText",F),B[B.length-2].addChild(q),l=B[B.length-1]=q,u=!1;else if("text"==d[x].type&&!u&&!n){textContent=d[x].value;q=new a.RTFNode(this.evaluator,textContent,"text",A.clone());if("textLineBlock"!=m.nodeType)for(m=m.parent;"textLineBlock"!=m.nodeType;)m=m.parent;m.addChild(q)}else if("text"==d[x].type&&!u&&n)textContent=d[x].value,q=new a.RTFNode(this.evaluator,textContent,"text",B[B.length-1].style.clone()),B[B.length-1].addChild(q);else if("("==d[x].type||")"==d[x].type)F=B[B.length-
1].style.clone(),F.textItalic="",q=new a.RTFNode(this.evaluator,d[x].type,"mathSymbol",F),B[B.length-1].addChild(q);else if("+"==d[x].type||"-"==d[x].type||"*"==d[x].type||"="==d[x].type)q=new a.RTFNode(this.evaluator,d[x].type,"mathSymbol",B[B.length-1].style.clone()),B[B.length-1].addChild(q);if(null!=m){var U=m.getRoot();U.stableWidth=D;U.getTextMetrics();U.hasFormula=G}return U};a.FontStyle=function(a,b,c,d,f,g,e){this.fontSize=a;this.fontType=b;this.textItalic=c;this.textBold=d;this.textUnderline=
f;this.textOverline=g;this.textColor=e};a.FontStyle.prototype.toString=function(){"arial"==this.fontType.toLowerCase()?this.fontType="descartesJS_sansserif, Arial, Helvetica, Sans-serif":this.fontType.toLowerCase().match("times")?this.fontType="descartesJS_serif, 'Times New Roman', Times, serif":this.fontType="descartesJS_monospace, 'Courier New', Courier, Monospace";return(this.textBold+" "+this.textItalic+" "+this.fontSize+"px "+this.fontType).trim()};a.FontStyle.prototype.toCSS=function(){var a=
"style='font: "+this.fontSize+"px "+this.fontType+"; ";this.textUnderline&&!this.textOverline&&(a+="text-decoration: underline; ");!this.textUnderline&&this.textOverline&&(a+="text-decoration: overline; ");this.textUnderline&&this.textOverline&&(a+="text-decoration: underline overline; ");this.textBold&&!this.textItalic&&(a+="font-style: normal; font-weight: bold; ");!this.textBold&&this.textItalic&&(a+="font-style: italic; font-weight: normal; ");this.textBold&&this.textItalic&&(a+="font-style: italic; font-weight: bold; ");
this.textBold||this.textItalic||(a+="font-style: normal; font-weight: normal; ");this.textColor&&(a+="color: "+this.textColor+"; ");return a+"'"};a.FontStyle.prototype.clone=function(){return new a.FontStyle(this.fontSize,this.fontType,this.textItalic,this.textBold,this.textUnderline,this.textOverline,this.textColor)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d,e,f,c,b,k,g,p,h,q,m,l,s,t;a.Space=function(b,c){this.parent=b;e=this.evaluator=this.parent.evaluator;f=
e.parser;this.id="";this.values=c;this.type="R2";this.xExpr=f.parse("0");this.yExpr=f.parse("0");this.w=parseInt(b.container.width);this.h=parseInt(b.container.height);this.drawif=f.parse("1");this.fixed=2!=b.version?!1:!0;this.scale=48;this.Oy=this.Ox=0;this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";this.bg_display="topleft";this.background="descinst.com.mja.descartes.DescartesJS.class"===b.code||b.arquimedes?new a.Color("f0f8fa"):new a.Color("ffffff");this.net=
2!=b.version?new a.Color("c0c0c0"):"";this.net10=2!=b.version?new a.Color("808080"):"";this.axes=2!=b.version?new a.Color("808080"):"";this.text=new a.Color("ffafaf");this.numbers=!1;this.x_axis=2!=b.version?"":" ";this.y_axis=2!=b.version?"":" ";this.sensitive_to_mouse_movements=!1;this.cID="";this.mouse_y=this.mouse_x=0;this.ctrs=[];this.graphicsCtr=[];this.graphics=[];this.backgroundGraphics=[];this.zIndex=b.zIndex;this.plecaHeight=b.plecaHeight||0;this.displaceRegionNorth=b.displaceRegionNorth||
0;this.displaceRegionWest=b.displaceRegionWest||0;for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);this.init()};a.Space.prototype.init=function(){d=this.parent;e=this.evaluator;c=this.id;this.displaceRegionNorth=d.displaceRegionNorth||0;this.displaceRegionWest=d.displaceRegionWest||0;void 0!=this.wExpr&&(this.w=(parseInt(d.container.width)-this.displaceRegionWest)*parseFloat(this.wExpr)/100);void 0!=this.hExpr&&(this.h=(parseInt(d.container.height)-this.displaceRegionNorth)*parseFloat(this.hExpr)/
100);g=parseInt(d.container.height);p=parseInt(d.container.width);this.x=e.evalExpression(this.xExpr)+this.displaceRegionWest;this.y=e.evalExpression(this.yExpr)+this.plecaHeight+this.displaceRegionNorth;this.container&&(this.container.style.left=this.x+"px",this.container.style.top=this.y+"px");0<=this.y?(b=g-this.y,this.h>b&&(this.h=b)):(b=this.h+this.y,this.h=b>=g?g:b);0<=this.x?(k=p-this.x,this.w>k&&(this.w=k)):(k=this.w+this.x,this.w=k>=p?p:k);""==this.imageSrc&&this.imageSrc.trim().toLowerCase().match(/vacio.gif$/)||
(this.image=d.getImage(this.imageSrc));this.OxExpr&&(q=this.OxExpr,"%"===q[q.length-1]?this.Ox=this.w*parseFloat(q)/100:(h=parseFloat(q),h!=q&&(h=0),this.Ox=h));this.OyExpr&&(m=this.OyExpr,"%"===m[m.length-1]?this.Oy=this.h*parseFloat(m)/100:(h=parseFloat(m),h!=m&&(h=0),this.Oy=h));""!==this.id&&2!==d.version?(e.setVariable(c+"._w",this.w),e.setVariable(c+"._h",this.h),e.setVariable(c+".escala",this.scale),e.setVariable(c+".Ox",this.Ox),e.setVariable(c+".Oy",this.Oy),e.setVariable(c+".mouse_x",0),
e.setVariable(c+".mouse_y",0),e.setVariable(c+".mouse_pressed",0),e.setVariable(c+".mouse_clicked",0),e.setVariable(c+".clic_izquierdo",0)):(h=e.getVariable("_w"),void 0===h&&(h=this.w),e.setVariable("_w",h),h=e.getVariable("_h"),void 0===h&&(h=this.h),e.setVariable("_h",h),h=e.getVariable("escala"),void 0===h&&(h=this.scale),e.setVariable("escala",h),h=e.getVariable("Ox"),void 0===h&&(h=this.Ox),e.setVariable("Ox",h),h=e.getVariable("Oy"),void 0===h&&(h=this.Oy),e.setVariable("Oy",h),e.setVariable("mouse_x",
0),e.setVariable("mouse_y",0),e.setVariable("mouse_pressed",0),e.setVariable("mouse_clicked",0),e.setVariable("clic_izquierdo",0),""===this.x_axis&&""===this.y_axis&&2==d.version&&(this.axes=""));this.w_2=this.w/2;this.h_2=this.h/2};a.Space.prototype.addCtr=function(a){"graphic"===a.type?this.graphicsCtr.push(a):this.ctrs.push(a)};a.Space.prototype.addGraph=function(a,b){"R2"==this.type&&b||"R3"==this.type&&!b||(a.background&&"R3"!==this.type?this.backgroundGraphics.push(a):this.graphics.push(a))};
a.Space.prototype.clearClick=function(){this.evaluator.setVariable(this.mclickedString,0);this.evaluator.setVariable(this.mclicizquierdoString,0)};a.Space.prototype.getRelativeX=function(a){return(parseInt(a)-this.w_2-this.Ox)/this.scale};a.Space.prototype.getRelativeY=function(a){return(-parseInt(a)+this.h_2+this.Oy)/this.scale};a.Space.prototype.getAbsoluteX=function(a){return a*this.scale+this.w_2+this.Ox};a.Space.prototype.getAbsoluteY=function(a){return-a*this.scale+this.h_2+this.Oy};a.Space.prototype.findOffset=
function(){l=this.container;this.offsetTop=this.offsetLeft=0;this.container&&this.container.style&&(s=this.container.style.display);this.container.style.display="block";if(l.getBoundingClientRect){var a=l.getBoundingClientRect();this.offsetLeft=a.left;this.offsetTop=a.top}else for(;l;)l.tagName&&"html"!==l.tagName.toLowerCase()?(this.offsetLeft+=l.offsetLeft||0,this.offsetTop+=l.offsetTop||0,l=l.parentNode):l=null;this.container&&this.container.style&&(this.container.style.display=s)};a.Space.prototype.getCursorPosition=
function(b){t=a.getCursorPosition(b);return{x:t.x-this.offsetLeft,y:t.y-this.offsetTop}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d;a.SpaceExternal=function(a){d=this;d.parent=a;d.width=228;d.vSpace=25;d.container=document.createElement("div");d.container.setAttribute("style","-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border-style: ridge; border-width: 5px; border-color: gray; box-shadow: #000 0px 0px 25px 5px; overflow-y: scroll; overflow-x: hidden; position: fixed; left: 0px; top: 0px; z-index: 10000; width: "+
(d.width+27)+"px; height: 460px; background-color: #63b4fb");d.moveManipulator=document.createElement("div");d.moveManipulator.setAttribute("style"," position: absolute; left: 0px; top: 0px; width: "+(d.width+27)+"px; height: "+d.vSpace+"px; line-height: "+d.vSpace+"px; background-color: ddd; cursor: move; padding-left: 75px; font-family: Sans-Serif; font-size: 18px;");d.moveManipulator.innerHTML="Descartes";d.container.appendChild(d.moveManipulator);d.ctrs=[]};a.SpaceExternal.prototype.init=function(){function d(b){c.newPosition=
a.getCursorPosition(b);c.container.style.left=c.initialPosition.x+(c.newPosition.x-c.oldPosition.x)+"px";c.container.style.top=c.initialPosition.y+(c.newPosition.y-c.oldPosition.y)+"px"}function f(a){a.preventDefault();c.findOffset();document.body.removeEventListener("mousemove",d);document.body.removeEventListener("mouseup",f)}document.body.appendChild(this.container);var c=this,b=c.parent.evaluator.parser,k;k=0;for(var g=c.ctrs.length;k<g;k++)c.ctrs[k].expresion=b.parse("(0,"+(c.vSpace+23+35*k)+
","+c.width+",35)"),c.ctrs[k].update();c.numCtr=g;k="espa\u00f1ol"==c.language?"cr\u00e9ditos":"english"==c.language?"about":"cr\u00e9ditos";k=new a.Button(c.parent,{region:"external",name:k,font_size:b.parse("15"),expresion:b.parse("(0,"+c.vSpace+","+c.width/2+",25)")});k.actionExec={execute:a.showAbout};k.update();(new a.Button(c.parent,{region:"external",name:"config",font_size:b.parse("15"),action:"config",expresion:b.parse("("+c.width/2+","+c.vSpace+","+c.width/2+",25)")})).update();k="espa\u00f1ol"==
c.language?"inicio":"english"==c.language?"init":"inicio";(new a.Button(c.parent,{region:"external",name:k,font_size:b.parse("15"),action:"init",expresion:b.parse("(0,"+(c.vSpace+23+35*g)+","+c.width/2+",25)")})).update();k="espa\u00f1ol"==c.language?"limpiar":"english"==c.language?"clear":"limpiar";(new a.Button(c.parent,{region:"external",name:k,font_size:b.parse("15"),action:"clear",expresion:b.parse("("+c.width/2+","+(c.vSpace+23+35*g)+","+c.width/2+",25)")})).update();k="espa\u00f1ol"==c.language?
"cerrar":"close";b=new a.Button(c.parent,{region:"external",name:k,font_size:b.parse("15"),expresion:b.parse("("+c.width/4+","+(c.vSpace+46+35*g)+","+c.width/2+",25)")});b.update();b.canvas.addEventListener("click",function(a){c.hide()});c.setPositionAndSize();c.moveManipulator.addEventListener("mousedown",function(b){b.preventDefault();c.oldPosition=a.getCursorPosition(b);c.initialPosition={x:c.container.offsetLeft,y:c.container.offsetTop};document.body.addEventListener("mousemove",d);document.body.addEventListener("mouseup",
f)});c.findOffset();c.hide()};a.SpaceExternal.prototype.addCtr=function(a){this.ctrs.push(a)};a.SpaceExternal.prototype.show=function(){this.setPositionAndSize();this.container.style.display="block"};a.SpaceExternal.prototype.hide=function(){this.container.style.display="none"};a.SpaceExternal.prototype.setPositionAndSize=function(){var a=this.vSpace+46+35*this.numCtr+25+10;this.container.style.left=Math.max(parseInt(window.innerWidth-this.width)/2,0)+"px";this.container.style.top="5px";this.container.style.height=
window.innerHeight<this.vSpace+75?this.vSpace+75+"px":a>window.innerHeight-10?window.innerHeight-10:a+"px"};a.SpaceExternal.prototype.findOffset=function(){tmpContainer=this.container;this.offsetTop=this.offsetLeft=0;this.container&&this.container.style&&(tmpDisplay=this.container.style.display);this.container.style.display="block";if(tmpContainer.getBoundingClientRect){var a=tmpContainer.getBoundingClientRect();this.offsetLeft=a.left;this.offsetTop=a.top}else for(;tmpContainer;)tmpContainer.tagName&&
"html"!==tmpContainer.tagName.toLowerCase()?(this.offsetLeft+=tmpContainer.offsetLeft||0,this.offsetTop+=tmpContainer.offsetTop||0,tmpContainer=tmpContainer.parentNode):tmpContainer=null;this.container&&this.container.style&&(this.container.style.display=tmpDisplay);for(var a=0,d=this.ctrs.length;a<d;a++)this.ctrs[a].findOffset&&this.ctrs[a].findOffset()};return a}(descartesJS||{}),descartesJS=function(a){var d,e;if(a.loadLib)return a;var f=Math.floor,c=Math.round,b=2*Math.PI,k=a.convertFont("SansSerif,PLAIN,12"),
g=a.convertFont("Monospaced,PLAIN,12"),p=10,h,q,m,l,s,t,n,u,r,v,w,y,C,A,D,E,z,B,G,H,K,L,x,J,F,P,M,I,R;a.Space2D=function(b,c){a.Space.call(this,b,c);h=this;h.backgroundCanvas=document.createElement("canvas");h.backgroundCanvas.setAttribute("id",h.id+"_background");h.backgroundCanvas.setAttribute("width",h.w+"px");h.backgroundCanvas.setAttribute("height",h.h+"px");h.backgroundCtx=h.backgroundCanvas.getContext("2d");h.backgroundCtx.imageSmoothingEnabled=!1;h.backgroundCtx.mozImageSmoothingEnabled=!1;
h.backgroundCtx.webkitImageSmoothingEnabled=!1;h.canvas=document.createElement("canvas");h.canvas.setAttribute("id",h.id+"_canvas");h.canvas.setAttribute("width",h.w+"px");h.canvas.setAttribute("height",h.h+"px");h.canvas.setAttribute("class","DescartesSpace2DCanvas");h.canvas.setAttribute("style","z-index: "+h.zIndex+";");h.ctx=h.canvas.getContext("2d");h.ctx.imageSmoothingEnabled=!1;h.ctx.mozImageSmoothingEnabled=!1;h.ctx.webkitImageSmoothingEnabled=!1;h.graphicControlContainer=document.createElement("div");
h.graphicControlContainer.setAttribute("id",h.id+"_graphicControls");h.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+h.zIndex+";");h.numericalControlContainer=document.createElement("div");h.numericalControlContainer.setAttribute("id",h.id+"_numericalControls");h.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+h.zIndex+";");h.container=document.createElement("div");h.container.setAttribute("id",
h.id);h.container.setAttribute("class","DescartesSpace2DContainer");h.container.setAttribute("style","left: "+h.x+"px; top: "+h.y+"px; z-index: "+h.zIndex+";");h.parent.arquimedes&&"#f0f8fa"===h.background.getColor()&&(h.container.style.border="1px solid #b8c4c8");h.container.appendChild(h.backgroundCanvas);h.container.appendChild(h.canvas);h.container.appendChild(h.graphicControlContainer);h.container.appendChild(h.numericalControlContainer);b.container.insertBefore(h.container,b.loader);h.parent.images[h.id+
".image"]=h.canvas;h.parent.images[h.id+".image"].ready=1;h.parent.images[h.id+".image"].complete=!0;h.evaluator.setVariable(h.id+".image",h.id+".image");h.parent.images[h.id+".back"]=h.backgroundCanvas;h.parent.images[h.id+".back"].ready=1;h.parent.images[h.id+".back"].complete=!0;h.evaluator.setVariable(h.id+".back",h.id+".back");""!==h.id&&2!==b.version?(h.OxString=h.id+".Ox",h.OyString=h.id+".Oy",h.scaleString=h.id+".escala",h.wString=h.id+"._w",h.hString=h.id+"._h",h.mxString=h.id+".mouse_x",
h.myString=h.id+".mouse_y",h.mpressedString=h.id+".mouse_pressed",h.mclickedString=h.id+".mouse_clicked",h.mclicizquierdoString=h.id+".clic_izquierdo"):(h.OxString="Ox",h.OyString="Oy",h.scaleString="escala",h.wString="_w",h.hString="_h",h.mxString="mouse_x",h.myString="mouse_y",h.mpressedString="mouse_pressed",h.mclickedString="mouse_clicked",h.mclicizquierdoString="clic_izquierdo");h.click=0;h.registerMouseAndTouchEvents()};a.extend(a.Space2D,a.Space);a.Space2D.prototype.init=function(){h=this;
h.uber.init.call(h);h.canvas&&(h.backgroundCanvas.setAttribute("width",h.w+"px"),h.backgroundCanvas.setAttribute("height",h.h+"px"),h.canvas.setAttribute("width",h.w+"px"),h.canvas.setAttribute("height",h.h+"px"));h.container&&h.findOffset()};a.Space2D.prototype.update=function(a){h=this;q=h.evaluator;m=h.parent;q.setVariable(h.wString,h.w);q.setVariable(h.hString,h.h);h.drawIfValue=0<q.evalExpression(h.drawif);if(h.drawIfValue){s=h.x!==q.evalExpression(h.xExpr)+h.displaceRegionWest;t=h.y!==q.evalExpression(h.yExpr)+
m.plecaHeight+h.displaceRegionNorth;h.spaceChange=a||s||t||h.drawBefore!==h.drawIfValue||h.Ox!==q.getVariable(h.OxString)||h.Oy!==q.getVariable(h.OyString)||h.scale!==q.getVariable(h.scaleString);h.x=s?q.evalExpression(h.xExpr)+h.displaceRegionWest:h.x;h.y=t?q.evalExpression(h.yExpr)+m.plecaHeight+h.displaceRegionNorth:h.y;h.Ox=q.getVariable(h.OxString);h.Oy=q.getVariable(h.OyString);h.scale=q.getVariable(h.scaleString);h.drawBefore=h.drawIfValue;1E-6>h.scale?(h.scale=1E-6,q.setVariable(h.scaleString,
1E-6)):1E6<h.scale&&(h.scale=1E6,q.setVariable(h.scaleString,1E6));if(s||t)h.container.style.left=h.x+"px",h.container.style.top=h.y+"px",h.findOffset();h.container.style.display="block";h.drawTrace=!h.spaceChange&&(!h.fixed&&!h.click||h.fixed);h.spaceChange&&h.drawBackground();h.draw()}else h.container.style.display="none"};a.Space2D.prototype.drawBackground=function(){q=this.evaluator;l=this.backgroundCtx;l.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);l.fillStyle=this.background.getColor();
l.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);this.image&&""!=this.image.src&&this.image.ready&&this.image.complete&&("topleft"===this.bg_display?l.drawImage(this.image,0,0):"stretch"===this.bg_display?l.drawImage(this.image,0,0,this.w,this.h):"patch"===this.bg_display?(l.fillStyle=l.createPattern(this.image,"repeat"),l.fillRect(0,0,this.canvas.width,this.canvas.height)):"imgcenter"===this.bg_display&&l.drawImage(this.image,(this.w-this.image.width)/2,(this.h-this.image.height)/
2));u=this.scale;r=0;for(v=0>this.w+this.h?0:this.w+this.h;u>v;)u/=10,r++;for(;u<v/10;)u*=10;l.lineWidth=1;""!==this.net&&(l.strokeStyle=this.net.getColor(),this.drawMarks(l,u/10,-1));if(2!==this.parent.version&&""!==this.net10||2===this.parent.version&&""!==this.net&&""!==this.net10)l.strokeStyle=this.net10.getColor(),this.drawMarks(l,u,-1);if(""!==this.axes){l.strokeStyle=this.axes.getColor();l.beginPath();if(""!==this.x_axis||2!==this.parent.version)l.moveTo(0,f(this.h/2+this.Oy)+0.5),l.lineTo(this.w,
f(this.h/2+this.Oy)+0.5);if(""!==this.y_axis||2!==this.parent.version)l.moveTo(f(this.w/2+this.Ox)+0.5,0),l.lineTo(f(this.w/2+this.Ox)+0.5,this.h);l.stroke();this.drawMarks(l,u,4);this.drawMarks(l,u/2,2);this.drawMarks(l,u/10,1)}if(""!==this.x_axis||""!==this.y_axis)l.fillStyle=""!==this.axes?this.axes.getColor():"black",l.font=k,l.textAlign="right",l.textBaseline="alphabetic",l.fillText(this.x_axis,f(this.w)-2,f(this.h/2+this.Oy)+12),l.fillText(this.y_axis,f(this.w/2+this.Ox)-2,12);this.numbers&&
""!=this.axes&&(l.fillStyle=this.axes.getColor(),l.font=k,l.textAlign="start",l.textBaseline="bottom",u>(this.w+this.h)/2?this.drawNumbers(l,u/5,u<=this.scale?r+1:r):u>(this.w+this.h)/4?this.drawNumbers(l,u/2,u<=this.scale?r+1:r):this.drawNumbers(l,u,r));for(var a=0,b=this.backgroundGraphics.length;a<b;a++)this.backgroundGraphics[a].draw()};a.Space2D.prototype.draw=function(){l=this.ctx;l.clearRect(0,0,this.canvas.width,this.canvas.height);for(var a=0,c=this.graphics.length;a<c;a++)n=this.graphics[a],
""!==n.trace&&this.drawTrace&&n.drawTrace(),n.draw();a=0;for(c=this.graphicsCtr.length;a<c;a++)this.graphicsCtr[a].draw();""!=this.text&&this.click&&"L"===this.whichButton&&(l.fillStyle=this.text.getColor(),l.strokeStyle=l.fillStyle,l.lineWidth=1,l.font=g,l.textAlign="center",l.textBaseline="alphabetic",K=1>=this.scale?this.mouse_x.toFixed(0):this.mouse_x.toFixed(this.scale.toString().length),L=1>=this.scale?this.mouse_y.toFixed(0):this.mouse_y.toFixed(this.scale.toString().length),x="("+K+","+L+
")",J=f(l.measureText(x).width/2),F=this.getAbsoluteX(this.mouse_x),P=this.getAbsoluteY(this.mouse_y),M=f(F),I=f(P-10),M+J>this.w?M=this.w-J:0>M-J&&(M=J),I+1>this.h?I=this.h:0>I-14&&(I=15),l.fillText(x,M,I),l.beginPath(),l.arc(F,P,2.5,0,b,!0),l.stroke())};a.Space2D.prototype.drawMarks=function(a,b,d){w=this.w;y=this.h;z=0;B=w;G=0;H=y;D=f(w/2+this.Ox);E=f(y/2+this.Oy);0<=d&&(z=D-d,B=D+d,G=E-d,H=E+d);a.beginPath();for(d=-c(D/b);(C=D+c(d*b))<w;d++)a.moveTo(C+0.5,G+0.5),a.lineTo(C+0.5,H+0.5);for(d=-c(E/
b);(A=E+c(d*b))<y;d++)a.moveTo(z+0.5,A+0.5),a.lineTo(B+0.5,A+0.5);a.stroke()};a.Space2D.prototype.drawNumbers=function(a,b,d){w=this.w;y=this.h;D=f(w/2+this.Ox);E=f(y/2+this.Oy);for(d=-c(D/b);(C=D+c(d*b))<w;d++)a.fillText(parseFloat((d*b/this.scale).toFixed(4)),C+1,E-2);for(d=-c(E/b);(A=E+c(d*b))<y;d++)0!==parseFloat(-d*b/this.scale)&&a.fillText(parseFloat((-d*b/this.scale).toFixed(4)),D+5,A+5)};a.Space2D.prototype.registerMouseAndTouchEvents=function(){function b(a){document.body.focus();l.parent.clearClick();
l.click=1;l.evaluator.setVariable(l.mpressedString,1);l.evaluator.setVariable(l.mclickedString,0);l.evaluator.setVariable(l.mclicizquierdoString,0);l.parent.deactivateGraphiControls();k(a);window.addEventListener("touchmove",m);window.addEventListener("touchend",c);a.stopPropagation();a.preventDefault()}function c(a){document.body.focus();l.click=0;l.evaluator.setVariable(l.mpressedString,0);l.evaluator.setVariable(l.mclickedString,1);l.evaluator.setVariable(l.mclicizquierdoString,1);window.removeEventListener("touchmove",
m);window.removeEventListener("touchend",c);a.preventDefault();l.parent.update()}function g(b){document.body.focus();b.stopPropagation();b.preventDefault();l.parent.clearClick();l.click=1;l.parent.deactivateGraphiControls();l.whichButton=a.whichButton(b);"R"===l.whichButton?(window.addEventListener("mouseup",h),l.clickPosForZoom=l.getCursorPosition(b).y,l.clickPosForZoomNew=l.clickPosForZoom,l.fixed||(l.tempScale=l.scale,window.addEventListener("mousemove",n))):"L"===l.whichButton&&(l.evaluator.setVariable(l.mpressedString,
1),l.evaluator.setVariable(l.mclickedString,0),l.evaluator.setVariable(l.mclicizquierdoString,0),k(b),window.addEventListener("mousemove",m),window.addEventListener("mouseup",h))}function h(a){document.body.focus();a.stopPropagation();a.preventDefault();l.click=0;l.evaluator.setVariable(l.mpressedString,0);l.evaluator.setVariable(l.mclickedString,1);l.evaluator.setVariable(l.mclicizquierdoString,1);"R"===l.whichButton&&(window.removeEventListener("mousemove",n),l.clickPosForZoom==l.clickPosForZoomNew&&
l.parent.externalSpace.show());window.removeEventListener("mousemove",m);window.removeEventListener("mouseup",h);l.parent.update()}function k(a){Date.now()-q>p&&(l.posAnte=l.getCursorPosition(a),l.mouse_x=l.getRelativeX(l.posAnte.x),l.mouse_y=l.getRelativeY(l.posAnte.y),l.evaluator.setVariable(l.mxString,l.mouse_x),l.evaluator.setVariable(l.myString,l.mouse_y),l.evaluator.setVariable(l.mclickedString,0),l.evaluator.setVariable(l.mclicizquierdoString,0),l.parent.update(),q=Date.now())}function n(a){a.preventDefault();
l.clickPosForZoomNew=l.getCursorPosition(a).y;l.evaluator.setVariable(l.scaleString,l.tempScale+l.tempScale/45*((l.clickPosForZoom-l.clickPosForZoomNew)/10));l.parent.update()}function m(a){a.preventDefault();a.stopPropagation();!l.fixed&&Date.now()-q>p&&(l.posNext=l.getCursorPosition(a),d=f(l.posAnte.x-l.posNext.x),e=f(l.posAnte.y-l.posNext.y),l.evaluator.setVariable(l.OxString,l.Ox-d),l.evaluator.setVariable(l.OyString,l.Oy-e),l.posAnte.x-=d,l.posAnte.y-=e);k(a)}var q=0,l=this;R=a.hasTouchSupport;
l.clickPosForZoom=null;l.clickPosForZoomNew=null;l.canvas.oncontextmenu=function(a){return!1};R&&(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("touchmove",k),this.canvas.addEventListener("touchstart",b));R||(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("mousemove",k),this.canvas.addEventListener("mousedown",g))};return a}(descartesJS||{}),descartesJS=function(a){var d,e,f;function c(a,b){return b.depth-a.depth}function b(b,c){Z=a.subtract3D(b,a.scalarProduct3D(c,
a.dotProduct3D(b,c)));W=a.add3D(b,a.scalarProduct3D(Z,-2));X=a.norm3D(W);return 0!==X?a.scalarProduct3D(W,1/X):a.scalarProduct3D(b,-1)}if(a.loadLib)return a;var k=Math.floor,g=Math.round,p=Math.max,h=Math.cos,q=Math.sin,m=Math.sqrt,l=15*Math.PI/180,s=Math.cos(l),t=Math.sin(l),n,u,r,v,w,y,C,A,D,E,z,B,G,H,K,L,x,J,F,P,M,I,R,S=[],O,Q,N,V,U,Y,Z,W,X;a.Space3D=function(b,c){a.Space.call(this,b,c);r=this;r.backgroundCanvas=document.createElement("canvas");r.backgroundCanvas.setAttribute("id",r.id+"_background");
r.backgroundCanvas.setAttribute("width",r.w+"px");r.backgroundCanvas.setAttribute("height",r.h+"px");r.canvas=document.createElement("canvas");r.canvas.setAttribute("id",r.id+"_canvas");r.canvas.setAttribute("width",r.w+"px");r.canvas.setAttribute("height",r.h+"px");r.canvas.setAttribute("class","DescartesSpace3DCanvas");r.canvas.setAttribute("style","z-index: "+r.zIndex+";");r.ctx=r.canvas.getContext("2d");r.ctx.imageSmoothingEnabled=!1;r.ctx.mozImageSmoothingEnabled=!1;r.ctx.webkitImageSmoothingEnabled=
!1;r.graphicControlContainer=document.createElement("div");r.graphicControlContainer.setAttribute("id",r.id+"_graphicControls");r.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+r.zIndex+";");r.numericalControlContainer=document.createElement("div");r.numericalControlContainer.setAttribute("id",r.id+"_numericalControls");r.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+r.zIndex+";");r.container=
document.createElement("div");r.container.setAttribute("id",r.id);r.container.setAttribute("class","DescartesSpace3DContainer");r.container.setAttribute("style","left: "+r.x+"px; top: "+r.y+"px; z-index: "+r.zIndex+";");r.container.appendChild(r.backgroundCanvas);r.container.appendChild(r.canvas);r.container.appendChild(r.graphicControlContainer);r.container.appendChild(r.numericalControlContainer);b.container.insertBefore(r.container,b.loader);r.eye={x:0,y:0,z:0};r.lights=[{x:50,y:50,z:70},{x:50,
y:-50,z:30},{x:20,y:0,z:-80},{x:0,y:0,z:0}];for(var d=0,f=r.lights.length;d<f;d++)r.lights[d]=a.normalize3D(r.lights[d]);r.light3={x:0,y:0,z:0};r.intensity=[0.4,0.5,0.3,0];r.userIntensity=0;r.dim=1;r.tmpIntensity=[];r.OxStr=r.id+".Ox";r.OyStr=r.id+".Oy";r.scaleStr=r.id+".escala";r.wStr=r.id+"._w";r.hStr=r.id+"._h";r.obsStr=r.id+".observador";r.rotZStr=r.id+".rot.z";r.rotYStr=r.id+".rot.y";r.userI_Dim_Str=r.id+".userIlum.dim";r.userI_I_Str=r.id+".userIlum.I";r.userI_x_Str=r.id+".userIlum.x";r.userI_y_Str=
r.id+".userIlum.y";r.userI_z_Str=r.id+".userIlum.z";r.evaluator.setVariable(r.rotZStr,0);r.evaluator.setVariable(r.rotYStr,0);r.evaluator.setVariable(r.userI_Dim_Str,r.dim);r.evaluator.setVariable(r.userI_I_Str,r.userIntensity);r.evaluator.setVariable(r.userI_x_Str,0);r.evaluator.setVariable(r.userI_y_Str,0);r.evaluator.setVariable(r.userI_z_Str,0);r.registerMouseAndTouchEvents()};a.extend(a.Space3D,a.Space);a.Space3D.prototype.init=function(a){r=this;r.uber.init.call(r);r.canvas&&(r.canvas.setAttribute("width",
r.w+"px"),r.canvas.setAttribute("height",r.h+"px"));r.container&&r.findOffset();r.w_2=r.w/2;r.h_2=r.h/2;r.oldMouse={x:0,y:0}};a.Space3D.prototype.update=function(a){r=this;n=r.evaluator;u=r.parent;n.setVariable(r.wStr,r.w);n.setVariable(r.hStr,r.h);r.drawIfValue=0<n.evalExpression(r.drawif);if(r.drawIfValue){D=r.x!==n.evalExpression(r.xExpr)+r.displaceRegionWest;E=r.y!==n.evalExpression(r.yExpr)+u.plecaHeight+r.displaceRegionNorth;r.spaceChange=a||D||E||r.drawBefore!==r.drawIfValue||r.Ox!==n.getVariable(r.OxStr)||
r.Oy!==n.getVariable(r.OyStr)||r.scale!==n.getVariable(r.scaleStr);r.x=D?n.evalExpression(r.xExpr)+r.displaceRegionWest:r.x;r.y=E?n.evalExpression(r.yExpr)+u.plecaHeight+r.displaceRegionNorth:r.y;r.Ox=n.getVariable(r.OxStr);r.Oy=n.getVariable(r.OyStr);r.scale=n.getVariable(r.scaleStr);r.drawBefore=r.drawIfValue;if(a||void 0==r.observer){var b;a=0;for(var c=r.parent.controls.length;a<c;a++)r.parent.controls[a].id===r.obsStr&&(b=!0);r.observer=b?n.getVariable(r.obsStr)||0.5*(r.w+r.h):2.5*(r.w+r.h);
r.observer=p(r.observer,0.1*(r.w+r.h));n.setVariable(r.obsStr,r.observer);r.eye={x:r.observer/r.scale*s,y:0,z:r.observer/r.scale*t};r.D=r.scale*r.eye.x/s;r.XE=g(r.scale*r.eye.y+0.5);r.YE=g(r.scale*r.eye.z+0.5)}r.observer=p(n.getVariable(r.obsStr),0.1*(r.w+r.h));n.setVariable(r.obsStr,r.observer);1E-6>r.scale?(r.scale=1E-6,n.setVariable(r.scaleStr,1E-6)):1E6<r.scale&&(r.scale=1E6,n.setVariable(r.scaleStr,1E6));if(D||E)r.container.style.left=r.x+"px",r.container.style.top=r.y+"px",r.findOffset();r.container.style.display=
"block";r.dim=n.getVariable(r.userI_Dim_Str);r.userIntensity=n.getVariable(r.userI_I_Str);r.light3={x:parseInt(n.getVariable(r.userI_x_Str)),y:parseInt(n.getVariable(r.userI_y_Str)),z:parseInt(n.getVariable(r.userI_z_Str))};r.updateCamera();r.draw()}else r.container.style.display="none"};a.Space3D.prototype.draw=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle=this.background.getColor();this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);this.image&&
""!=this.image.src&&this.image.ready&&this.image.complete&&("topleft"===this.bg_display?this.ctx.drawImage(this.image,0,0):"stretch"===this.bg_display?this.ctx.drawImage(this.image,0,0,this.w,this.h):"patch"===this.bg_display?(this.ctx.fillStyle=ctx.createPattern(this.image,"repeat"),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)):"center"===this.bg_display&&this.ctx.drawImage(this.image,(this.w-this.image.width)/2,(this.h-this.image.height)/2));for(var a=0,b=this.graphics.length;a<b;a++)this.graphics[a].update();
this.primitives=[];a=0;for(b=this.graphics.length;a<b;a++){v=this.graphics[a];if(v.split||this.split)for(var d=a+1;d<b;d++)w=this.graphics[d],(w.split||this.split)&&v.splitFace(w);this.primitives=this.primitives.concat(v.primitives||[])}y=this.primitives;C=y.length;for(a=0;a<C;a++)y[a].computeDepth(this);if("painter"===this.render)this.drawPainter(y);else for(y=y.sort(c),a=0;a<C;a++)y[a].draw(this.ctx,this);a=0;for(b=this.graphicsCtr.length;a<b;a++)this.graphicsCtr[a].draw()};var T;a.renderNode=function(a){this.value=
a;this.front=this.back=null};a.renderNode.prototype.inOrder=function(){var a=[];this.back&&(a=a.concat(this.back.inOrder()));a.push(this.value);this.front&&(a=a.concat(this.front.inOrder()));return a};a.Space3D.prototype.buildTree=function(b){if(0===b.length)return null;var c,d=[],f=[];T=b.shift();for(var g=0,e=b.length;g<e;g++){c=null;for(var h=0,k=b[g].spaceVertices.length;h<k;h++)whereIs=2<T.spaceVertices.length?this.inPlane2(T.spaceVertices[0],T.normal,b[g].spaceVertices[h]):0,whereIs=0<T.direction?
-whereIs:whereIs,null===c?0>whereIs?c="front":0<whereIs&&(c="back"):0>whereIs?"back"===c&&(c="cross"):0<whereIs&&"front"===c&&(c="cross");if("back"===c)d.push(b[g]);else if("front"===c)f.push(b[g]);else if(null==c)d.push(b[g]);else{c=null;h=0;for(k=T.spaceVertices.length;h<k;h++)whereIs=2<b[g].spaceVertices.length?this.inPlane2(b[g].spaceVertices[0],b[g].normal,T.spaceVertices[h]):-1,whereIs=0<b[g].direction?-whereIs:whereIs,null===c?0>whereIs?c="front":0<whereIs&&(c="back"):0>whereIs?"back"===c&&
(c="cross"):0<whereIs&&"front"===c&&(c="cross");"front"===c?d.push(b[g]):f.push(b[g])}}b=new a.renderNode(T);b.back=this.buildTree(d);b.front=this.buildTree(f);return b};a.Space3D.prototype.drawPainter=function(a){if(a=this.buildTree(a)){a=a.inOrder();for(var b=0;b<a.length;b++)a[b].draw(this.ctx,this)}};a.Space3D.prototype.inPlane=function(a,b,c,d){return parseFloat(((d.x-a.x)*(b.y-a.y)*(c.z-a.z)+(d.y-a.y)*(b.z-a.z)*(c.x-a.x)+(d.z-a.z)*(b.x-a.x)*(c.y-a.y)-(d.z-a.z)*(b.y-a.y)*(c.x-a.x)-(d.y-a.y)*
(b.x-a.x)*(c.z-a.z)-(d.x-a.x)*(b.z-a.z)*(c.y-a.y)).toFixed(8))};a.Space3D.prototype.inPlane2=function(a,b,c){return parseFloat((b.x*(c.x-a.x)+b.y*(c.y-a.y)+b.z*(c.z-a.z)).originalToFixed(8))};a.Space3D.prototype.updateCamera=function(){r=this;r.D=r.observer;r.eye.x=r.D/r.scale;r.eye.y=r.XE/r.scale;r.eye.z=r.YE/r.scale};a.Space3D.prototype.rotateVertex=function(b){x=a.degToRad(r.evaluator.getVariable(r.rotZStr));J=h(x);F=q(x);d=b.x*J-b.y*F;e=b.x*F+b.y*J;f=b.z;x=a.degToRad(r.evaluator.getVariable(r.rotYStr));
J=h(x);F=q(x);return{x:f*F+d*J,y:e,z:f*J-d*F}};a.Space3D.prototype.project=function(a){r=this;G=r.eye.x-a.x;H=r.eye.y-a.y;K=r.eye.z-a.z;var b=m(G*G+H*H+K*K);L=-a.x/b||0;G=this.w_2+this.Ox+r.scale*(a.y+L*(r.eye.y-a.y));H=this.h_2+this.Oy-r.scale*(a.z+L*(r.eye.z-a.z));return{x:G,y:H,z:b}};a.Space3D.prototype.computeColor=function(c,d,f){c.match("rgba")?c=a.RGBAToHexColor(c):c.match("#")&&(c=new a.Color(c.substring(1)));V=a.subtract3D(this.eye,d.average);U=a.norm3D(V);Y=a.scalarProduct3D(V,1/U);this.lights[3]=
a.subtract3D(this.light3,d.average);R=a.norm3D(this.lights[3]);for(var g=0,e=this.intensity.length-1;g<e;g++)S[g]=this.intensity[g]*this.dim;S[3]=this.userIntensity*this.userIntensity/R||0;O=f?this.dim/2:this.dim/4;Q=0;N=0<=d.direction?d.normal:a.scalarProduct3D(d.normal,-1);g=0;for(e=this.lights.length;g<e;g++)f?(Q=Math.max(0,a.dotProduct3D(b(this.lights[g],N),Y)),Q*=Q*Q):Q=Math.max(0,a.dotProduct3D(this.lights[g],N)),O+=S[g]*Q;O=Math.min(O,1);P=k(c.r*O);M=k(c.g*O);I=k(c.b*O);return"rgba("+P+","+
M+","+I+","+c.a+")"};a.Space3D.prototype.registerMouseAndTouchEvents=function(){function b(a){document.body.focus();p.click=1;p.evaluator.setVariable(p.id+".mouse_pressed",1);p.parent.deactivateGraphiControls();p.posAnte=p.getCursorPosition(a);p.oldMouse.x=p.getRelativeX(p.posAnte.x);p.oldMouse.y=p.getRelativeY(p.posAnte.y);e(a);window.addEventListener("touchmove",k);window.addEventListener("touchend",c);a.preventDefault()}function c(a){document.body.focus();p.click=0;p.evaluator.setVariable(p.id+
".mouse_pressed",0);window.removeEventListener("touchmove",k,!1);window.removeEventListener("touchend",c,!1);a.preventDefault()}function d(b){document.body.focus();p.click=1;p.parent.deactivateGraphiControls();p.whichButton=a.whichButton(b);"R"===p.whichButton?(window.addEventListener("mouseup",f),p.clickPosForZoom=p.getCursorPosition(b).y,p.clickPosForZoomNew=p.clickPosForZoom,p.fixed||(p.tempScale=p.scale,window.addEventListener("mousemove",h))):"L"==p.whichButton&&(p.evaluator.setVariable(p.id+
".mouse_pressed",1),p.posAnte=p.getCursorPosition(b),p.oldMouse.x=p.getRelativeX(p.posAnte.x),p.oldMouse.y=p.getRelativeY(p.posAnte.y),e(b),window.addEventListener("mousemove",k),window.addEventListener("mouseup",f));b.preventDefault()}function f(a){document.body.focus();p.click=0;p.evaluator.setVariable(p.id+".mouse_pressed",0);a.preventDefault();"R"===p.whichButton&&(window.removeEventListener("mousemove",h,!1),p.clickPosForZoom==p.clickPosForZoomNew&&p.parent.externalSpace.show());window.removeEventListener("mousemove",
k,!1);window.removeEventListener("mouseup",f,!1)}function e(a){p.posAnte=p.getCursorPosition(a);p.mouse_x=p.getRelativeX(p.posAnte.x);p.mouse_y=p.getRelativeY(p.posAnte.y);p.evaluator.setVariable(p.id+".mouse_x",p.mouse_x);p.evaluator.setVariable(p.id+".mouse_y",p.mouse_y);70<Date.now()-l&&(p.parent.update(),l=Date.now())}function h(a){a.preventDefault();p.clickPosForZoomNew=p.getCursorPosition(a).y;p.evaluator.setVariable(p.scaleStr,p.tempScale+p.tempScale/45*((p.clickPosForZoom-p.clickPosForZoomNew)/
10));p.parent.update()}function k(b){if(!p.fixed&&p.click){z=parseInt(50*(p.oldMouse.x-p.mouse_x));B=parseInt(50*(p.oldMouse.y-p.mouse_y));if(z!==p.disp.x||B!==p.disp.y)p.alpha=a.degToRad(p.evaluator.getVariable(p.rotZStr)),p.beta=a.degToRad(-p.evaluator.getVariable(p.rotYStr)),p.alpha=g(a.radToDeg(p.alpha)-z),p.beta=g(a.radToDeg(p.beta)-B),p.evaluator.setVariable(p.rotZStr,p.alpha),p.evaluator.setVariable(p.rotYStr,-p.beta),p.disp.x=z,p.disp.y=B,p.oldMouse.x=p.getRelativeX(p.posAnte.x),p.oldMouse.y=
p.getRelativeY(p.posAnte.y);e(b);b.preventDefault()}}var p=this,l=0;A=a.hasTouchSupport;this.canvas.oncontextmenu=function(){return!1};A&&this.canvas.addEventListener("touchstart",b);A||this.canvas.addEventListener("mousedown",d);this.disp={x:0,y:0}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d;a.SpaceAP=function(e,f){a.Space.call(this,e,f);this.exportarVars=this.importarVars=null;d=e.evaluator;this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=d.parser.parse(this.file.substring(1,
this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=d.parser.parse(this.file):this.file=d.parser.parse("'"+this.file+"'");this.oldFile=d.evalExpression(this.file);this.initFile()};a.extend(a.SpaceAP,a.Space);a.SpaceAP.prototype.initFile=function(){this.firstUpdate=!0;var d;if(this.oldFile){var f=document.getElementById(this.oldFile);d=f&&"descartes/spaceApFile"==f.type?f.text:a.openExternalFile(this.oldFile);null!=d&&(d=d.split("\n"))}if(d&&d.toString().match(/<applet/gi)){for(var f=
"",c=!1,b=0,k=d.length;b<k&&(d[b].match("<applet")&&(c=!0),c&&(f+=d[b]),!d[b].match("</applet"));b++);b=document.createElement("div");b.innerHTML=f;b.firstChild.setAttribute("width",this.w);b.firstChild.setAttribute("height",this.h);f=this.descApp?this.descApp.container:null;this.descApp=new a.DescartesApp(b.firstChild);this.descApp.container.setAttribute("class","DescartesAppContainer");this.descApp.container.setAttribute("style","position: absolute; overflow: hidden; background-color: "+this.background+
"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");f?this.parent.container.replaceChild(this.descApp.container,f):this.parent.container.insertBefore(this.descApp.container,this.parent.loader);f=this.descApp.spaces;b=0;for(k=f.length;b<k;b++)f[b].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none";var g=this;this.descApp.update=function(){this.updateAuxiliaries();this.updateEvents();
this.updateControls();this.updateSpaces();g.exportar()}}else f=this.descApp?this.descApp.container:null,this.descApp={},this.descApp.container=document.createElement("div"),this.descApp.container.setAttribute("class","DescartesAppContainer"),b="position: absolute; overflow: hidden; background-color: "+this.background+"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";",this.image&&("topleft"==this.bg_display?b+="background-image: url("+this.imageSrc+
"); background-repeat:no-repeat;":"stretch"==this.bg_display?b+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-size: 100% 100%;":"patch"==this.bg_display?b+="background-image: url("+this.imageSrc+");":"imgcenter"==this.bg_display&&(b+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-position: center center;")),this.descApp.container.setAttribute("style",b),f?this.parent.container.replaceChild(this.descApp.container,f):this.parent.container.insertBefore(this.descApp.container,
this.parent.loader),this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none"};a.SpaceAP.prototype.update=function(){var a=this.evaluator.evalExpression(this.file);if(this.oldFile!=a)this.oldFile=a,this.initFile();else{var a=this.x!=this.evaluator.evalExpression(this.xExpr),d=this.y!=this.evaluator.evalExpression(this.yExpr)+this.plecaHeight;this.x=a?this.evaluator.evalExpression(this.xExpr):this.x;this.y=d?this.evaluator.evalExpression(this.yExpr)+this.plecaHeight:
this.y;a&&(this.descApp.container.style.left=this.x+"px");d&&(this.descApp.container.style.top=this.y+"px");if(a||d)for(var a=this.descApp.spaces,d=0,c=a.length;d<c;d++)a[d].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none";if(this.firstUpdate&&(this.firstUpdate=!1,null==this.importarVars)){this.importarVars=[];for(var b in this.evaluator.variables)this.evaluator.variables.hasOwnProperty(b)&&b.match(/^public./)&&this.importarVars.push({varName:b,
value:this.evaluator.getVariable(b)})}this.importar()}};a.SpaceAP.prototype.importar=function(){for(var a,d=!1,c=0,b=this.importarVars.length;c<b;c++)a=this.evaluator.getVariable(this.importarVars[c].varName),a!=this.importarVars[c].value&&(this.importarVars[c].value=a,this.descApp.evaluator.setVariable(this.importarVars[c].varName,this.importarVars[c].value),d=!0);d&&this.descApp.update()};a.SpaceAP.prototype.exportar=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var d,e,f,c;a.SpaceHTML_IFrame=function(b,c){a.Space.call(this,b,c);var d=this.parent.evaluator;window.navigator.userAgent.toLowerCase().match(/firefox/);this.file=this.file?this.file.trim():"";this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=d.parser.parse(this.file.substring(1,this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=d.parser.parse(this.file):this.file=d.parser.parse("'"+this.file+"'");this.oldFile=d.evalExpression(this.file);this.MyIFrame=document.createElement("iframe");
0!=this.oldFile&&this.MyIFrame.setAttribute("src",this.oldFile);this.MyIFrame.setAttribute("id",this.id);this.MyIFrame.setAttribute("marginheight",0);this.MyIFrame.setAttribute("marginwidth",0);this.MyIFrame.setAttribute("frameborder",0);this.MyIFrame.setAttribute("scrolling","auto");this.MyIFrame.setAttribute("style","position: static; left: 0px; top: 0px;");this.container=document.createElement("div");a.isIOS?this.container.setAttribute("style","overflow: scroll; -webkit-overflow-scrolling: touch; position: absolute; width: "+
this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";"):this.container.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.container.appendChild(this.MyIFrame);this.parent.container.insertBefore(this.container,this.parent.loader);var f=this;this.MyIFrame.onload=function(a){var b=this;f.evaluator.setFunction(f.id+".set",function(a,c){b.contentWindow.postMessage({type:"set",
name:a,value:c},"*");return 0});f.evaluator.setFunction(f.id+".update",function(){b.contentWindow.postMessage({type:"update"},"*");return 0});f.evaluator.setFunction(f.id+".exec",function(a,c){b.contentWindow.postMessage({type:"exec",name:a,value:c},"*");return 0})};this.update=this.iframeUpdate;this.evaluator.setVariable(this.id+"._scroll",0)};a.extend(a.SpaceHTML_IFrame,a.Space);a.SpaceHTML_IFrame.prototype.init=function(){self=this;self.uber.init.call(self);self.MyIFrame&&(self.MyIFrame.style.width=
self.w+"px",self.MyIFrame.style.height=self.h+"px",self.MyIFrame.style.left=self.x+"px",self.MyIFrame.style.top=self.y+"px")};a.SpaceHTML_IFrame.prototype.iframeUpdate=function(a){d=this.evaluator;this.drawIfValue=0<d.evalExpression(this.drawif);this.container.style.display=this.drawIfValue?"block":"none";if(this.drawIfValue){a&&(this.y=this.x=Infinity);e=this.x!==d.evalExpression(this.xExpr)+this.displaceRegionWest;f=this.y!==d.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth;
this.x=e?d.evalExpression(this.xExpr)+this.displaceRegionWest:this.x;this.y=f?d.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth:this.y;if(e||f)this.container.style.left=this.x+"px",this.container.style.top=this.y+"px";c=d.evalExpression(this.file);c!==this.oldFile&&(this.oldFile=c,this.MyIFrame.setAttribute("src",c));this.scrollVar=d.getVariable(this.id+"._scroll");1==this.scrollVar?(this.MyIFrame.setAttribute("scrolling","yes"),this.MyIFrame.style.overflow=""):-1==this.scrollVar?
(this.MyIFrame.setAttribute("scrolling","no"),this.MyIFrame.style.overflow="hidden"):(this.MyIFrame.setAttribute("scrolling","auto"),this.MyIFrame.style.overflow="")}};return a}(descartesJS||{}),descartesJS=function(a){function d(a){var d=document.createElement("label");d.setAttribute("style","text-align:right; padding:5px; -webkit-touch-callout:none; -webkit-user-select:none; -khtml-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none;");d.innerHTML=babel.translate(c,a);
return d}function e(a,c){var d=document.createElement("input");d.value=a;c&&d.setAttribute("type",c);return d}function f(a){a=this.querySelector("input")||this.querySelector("select");var c=a.value;"checkbox"==a.getAttribute("type")&&(c=a.checked.toString());this.obj.value=c}if(a.loadLib)return a;var c;a.EditorGenericPanel=function(a){this.editor=a;this.parent=a.parent;c=this.parent.language};a.EditorGenericPanel.prototype.findObjectByName=function(a,c){for(var d=0,f=a.length;d<f;d++)if(a[d].name==
c)return a[d];return null};a.EditorGenericPanel.prototype.newLabelAndInput=function(a,c){var g=document.createElement("div");g.setAttribute("class","DescartesLabelAndElementContainer");g.obj=a;var p=d(a.name),h=e(a.value);g.appendChild(p);g.appendChild(h);c.appendChild(g);g.addEventListener("change",f);return g};a.EditorGenericPanel.prototype.newLabelAndMenu=function(a,c,g){var e=document.createElement("div");e.setAttribute("class","DescartesLabelAndElementContainer");e.obj=a;for(var h=d(a.name),
q=document.createElement("select"),m=0,l=g.length;m<l;m++)q.innerHTML+="<option value='"+g[m]+"'> "+g[m]+"</option>\n";q.value=a.value;e.appendChild(h);e.appendChild(q);c.appendChild(e);e.addEventListener("change",f);return e};a.EditorGenericPanel.prototype.newLabelAndCheckbox=function(a,c){var g=document.createElement("div");g.setAttribute("class","DescartesLabelAndElementContainer");g.obj=a;var p=d(a.name),h=e(a.value,"checkbox");h.checked="true"==a.value?!0:!1;g.appendChild(p);g.appendChild(h);
c.appendChild(g);g.addEventListener("change",f);return g};a.EditorGenericPanel.prototype.newFieldSet=function(a,c){var d=document.createElement("fieldset"),f=document.createElement("legend");f.innerHTML=c;d.appendChild(f);a.appendChild(d);return d};a.EditorGenericPanel.prototype.setValue=function(a,c){a.obj=c;var d=a.querySelector("input")||a.querySelector("select");d&&("checkbox"==d.getAttribute("type")?d.checked="true"==c.value?!0:!1:d.value=c.value)};a.EditorGenericPanel.prototype.fillAttributes=
function(a){for(var c,d=0,f=a.length;d<f;d++)(c=this.attributes[a[d].name])&&this.setValue(c,a[d])};a.EditorGenericPanel.prototype.hideAllAttributes=function(){for(var b in this.attributes)a.hideHTML(this.attributes[b])};a.EditorGenericPanel.prototype.showAttributes=function(b){for(var c=0,d=b.length;c<d;c++)this.attributes[b[c].name]&&a.showHTML(this.attributes[b[c].name])};a.EditorGenericPanel.prototype.toNameValueArray=function(a){var c=[],d;for(d in a)c.push({name:d,value:a[d]});return c};a.EditorGenericPanel.prototype.createPanel2=
function(a){var c=this.useDisplaceIndex?this.editor.definitionPanel.params.length:0;if(!a){a=0;for(var d=this.params.length;a<d;a++)this.buildobj(this.params[a]);this.ulContainer=document.createElement("ul");this.editor.listContainer.appendChild(this.ulContainer)}var f,e,q,m,l;this.ulContainer.style.display=0==this.params.length?"none":null;a=0;for(d=this.params.length;a<d;a++){f=document.createElement("li");f.setAttribute("data-index",a);l=this.params[a].obj;e=document.createElement("span");e.innerHTML=
'<div class="Descartes_param_name">&lt;param name="'+this.prefix+(10>a+c+1?"0":"")+(a+c+1)+'" value="<br></div>';f.appendChild(e);for(var s=0,t=l.length;s<t;s++)m=l[s],m.value=m.value.replace(/</g,"&lt;"),"family_interval"==m.name||"family_steps"==m.name?(q=this.params[a].paramObj.family,e=document.createElement("span"),e.setAttribute("class","family"),e.innerHTML=q+(""!=q?".":"")+("family_interval"==m.name?babel.toLanguage("interval"):babel.toLanguage("steps"))+"='",f.appendChild(e),q=document.createElement("span"),
q.setAttribute("class","DescartesSpanValue"),q.setAttribute("contenteditable","true"),q.setAttribute("autocapitalize","off"),q.innerHTML=babel.toLanguage(m.value),f.appendChild(q),e=document.createElement("span"),e.innerHTML="'"+(s<t-1?" ":""),f.appendChild(e)):"parameter_interval"==m.name||"parameter_steps"==m.name?(parameter=this.params[a].paramObj.parameter,e=document.createElement("span"),e.setAttribute("class","parameter"),e.innerHTML=parameter+(""!=parameter?".":"")+("parameter_interval"==m.name?
babel.toLanguage("interval"):babel.toLanguage("steps"))+"='",f.appendChild(e),q=document.createElement("span"),q.setAttribute("class","DescartesSpanValue"),q.setAttribute("contenteditable","true"),q.setAttribute("autocapitalize","off"),q.innerHTML=babel.toLanguage(m.value),f.appendChild(q),e=document.createElement("span"),e.innerHTML="'"+(s<t-1?" ":""),f.appendChild(e)):this.dontShowList[m.name]||(e=document.createElement("span"),e.innerHTML=babel.toLanguage(m.name)+"='",f.appendChild(e),q=document.createElement("span"),
q.setAttribute("class","DescartesSpanValue"),q.setAttribute("contenteditable","true"),q.setAttribute("autocapitalize","off"),q.innerHTML=babel.toLanguage(m.value),f.appendChild(q),e=document.createElement("span"),e.innerHTML="'"+(s<t-1?" ":""),f.appendChild(e)),"family"==m.name&&q.addEventListener("input",function(a){a=this.parentNode.querySelectorAll(".family");for(var b,c=0,d=a.length;c<d;c++)b=a[c].innerHTML,b.match("intervalo")?a[c].innerHTML=this.textContent+(""!=this.textContent?".":"")+"intervalo='":
a[c].innerHTML=this.textContent+(""!=this.textContent?".":"")+"pasos='"}),"parameter"==m.name&&q.addEventListener("input",function(a){a=this.parentNode.querySelectorAll(".parameter");for(var b,c=0,d=a.length;c<d;c++)b=a[c].innerHTML,b.match("intervalo")?a[c].innerHTML=this.textContent+(""!=this.textContent?".":"")+"intervalo='":a[c].innerHTML=this.textContent+(""!=this.textContent?".":"")+"pasos='"});e=document.createElement("span");e.innerHTML='<br>"&gt;';f.appendChild(e);this.ulContainer.appendChild(f)}};
a.EditorGenericPanel.prototype.add=function(a){var c={name:"_"};c.paramObj=this.newParamObject(a);c.obj=this.toNameValueArray(c.paramObj);this.params.push(c);this.ulContainer.innerHTML="";this.createPanel2(!0);this.notifyProgram&&this.editor.programPanel.renumerate();a=this.ulContainer.querySelectorAll("li");a[this.params.length-1].className+=" DescartesElementSelected";return a[this.params.length-1]};a.EditorGenericPanel.prototype.remove=function(a){this.params.splice(a,1);this.ulContainer.innerHTML=
"";this.createPanel2(!0);this.notifyProgram&&this.editor.programPanel.renumerate()};a.EditorGenericPanel.prototype.clone=function(a){a=this.params[a];var c={name:"_",paramObj:{}},d;for(d in a.paramObj)c.paramObj[d]=a.paramObj[d];c.obj=this.toNameValueArray(c.paramObj);this.params.push(c);this.ulContainer.innerHTML="";this.createPanel2(!0);this.notifyProgram&&this.editor.programPanel.renumerate();d=this.ulContainer.querySelectorAll("li");d[this.params.length-1].className+=" DescartesElementSelected";
return d[this.params.length-1]};a.EditorGenericPanel.prototype.moveUp=function(a){if(0<a){var c=this.params[a-1];this.params[a-1]=this.params[a];this.params[a]=c;this.ulContainer.innerHTML="";this.createPanel2(!0);c=this.ulContainer.querySelectorAll("li");c[a-1].className+=" DescartesElementSelected";return c[a-1]}};a.EditorGenericPanel.prototype.moveDown=function(a){if(a<this.params.length-1){var c=this.params[a+1];this.params[a+1]=this.params[a];this.params[a]=c;this.ulContainer.innerHTML="";this.createPanel2(!0);
c=this.ulContainer.querySelectorAll("li");c[a+1].className+=" DescartesElementSelected";return c[a+1]}};a.EditorGenericPanel.prototype.renumerate=function(){for(var a=this.editor.definitionPanel.params.length,c=this.ulContainer.querySelectorAll("li"),d=0,f=c.length;d<f;d++)c[d].firstChild.innerHTML='&lt;param name="'+this.prefix+(d+a+1)+'" value="'};a.EditorGenericPanel.prototype.getContent=function(){for(var a="",c=this.ulContainer.querySelectorAll("li"),d,f=0,e=c.length;f<e;f++){d=c[f].querySelectorAll("span");
for(var q=0,m=d.length;q<m;q++)a="DescartesSpanValue"==d[q].className?a+d[q].textContent.replace(/'/g,"&squot;"):a+d[q].textContent;a+="\n"}return a.replace(/intervalo=''/g,"").replace(/pasos=''/g,"")};a.hideHTML=function(a){a&&a.style&&(a.style.display="none")};a.showHTML=function(a){a&&a.style&&(a.style.display="")};a.hideMultipleHTML=function(b){for(var c=0,d=b.length;c<d;c++)a.hideHTML(b[c])};a.showMultipleHTML=function(b){for(var c=0,d=b.length;c<d;c++)a.showHTML(b[c])};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.EditorConfigPanel=function(d){a.EditorGenericPanel.call(this,d);this.params=d.sceneParams;this.config=d.configAttributes;this.createPanel2()};a.extend(a.EditorConfigPanel,a.EditorGenericPanel);a.EditorConfigPanel.prototype.createPanel=function(){var a;a=document.getElementById("tab_1");var e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);this.parameters=[];a=this.findObjectByName(this.params,"docBase");
a.value==window.location.href&&(a.value="_default_");this.parameters.push(this.newLabelAndInput(this.findObjectByName(this.params,"docBase"),e));this.parameters.push(this.newLabelAndMenu(this.findObjectByName(this.params,"decimal_symbol"),e,[".",","]));this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(this.params,"antialias"),e));this.parameters.push(this.newLabelAndMenu(this.findObjectByName(this.params,"language"),e,"english espa\u00f1ol catal\u00e0 euskera fran\u00e7ais galego portugu\u00eas valenci\u00e0".split(" ")));
var f=this.parent.lessonParser.split(this.findObjectByName(this.params,"Buttons").value);a=[];for(var c=0,b=f.length;c<b;c++)a.push({name:babel[f[c][0]]||f[c][0],value:babel[f[c][1]]||f[c][1]});f=this.newFieldSet(e,"buttons");this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(a,"about"),f));this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(a,"config"),f));this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(a,"init"),f));this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(a,
"clear"),f));this.parameters.push(this.newLabelAndInput(this.findObjectByName(a,"widthEast"),e));this.parameters.push(this.newLabelAndInput(this.findObjectByName(a,"widthWest"),e));this.parameters.push(this.newLabelAndInput(this.findObjectByName(a,"height"),e))};a.EditorConfigPanel.prototype.createPanel2=function(){this.ulContainer=document.createElement("ul");this.editor.listContainer.appendChild(this.ulContainer);var a=this.parent.lessonParser,e,f,c,b,k=_tmpH=null;e=document.createElement("li");
f=document.createElement("span");f.innerHTML="&lt;ajs ";e.appendChild(f);for(var g=0,p=this.config.length;g<p;g++)c=this.config[g].name,b=this.config[g].value,"width"==c&&(k=b),"height"==c&&(_tmpH=b),f=document.createElement("span"),f.innerHTML=c+'="',e.appendChild(f),f=document.createElement("span"),f.setAttribute("class","DescartesSpanValue"),f.setAttribute("contenteditable","true"),f.setAttribute("autocapitalize","off"),f.innerHTML=b,e.appendChild(f),f=document.createElement("span"),f.innerHTML=
'" ',e.appendChild(f);f=document.createElement("span");f.innerHTML="&gt;";e.appendChild(f);this.ulContainer.appendChild(e);g=0;for(p=this.params.length;g<p;g++){e=document.createElement("li");c=this.params[g].name;b=this.params[g].value;"size"==c&&null!=k&&null!=_tmpH&&(b=k+"x"+_tmpH);if("Buttons"!=babel[this.params[g].name])f=document.createElement("span"),f.innerHTML='&lt;param name="'+babel.toLanguage(c)+'" value="',e.appendChild(f),f=document.createElement("span"),f.setAttribute("class","DescartesSpanValue"),
f.setAttribute("contenteditable","true"),f.setAttribute("autocapitalize","off"),f.innerHTML=babel.toLanguage(b),e.appendChild(f),f=document.createElement("span"),f.innerHTML='"&gt;';else{f=document.createElement("span");f.innerHTML='&lt;param name="'+babel.toLanguage(c)+'" value="';e.appendChild(f);for(var h=a.split(b),q=0,m=h.length;q<m;q++)c=babel[h[q][0]]||h[q][0],b=babel[h[q][1]]||h[q][1],f=document.createElement("span"),f.innerHTML=babel.toLanguage(c)+"='",e.appendChild(f),f=document.createElement("span"),
f.setAttribute("class","DescartesSpanValue"),f.setAttribute("contenteditable","true"),f.setAttribute("autocapitalize","off"),f.innerHTML=babel.toLanguage(b),e.appendChild(f),f=document.createElement("span"),f.innerHTML="'"+(q<m-1?" ":""),e.appendChild(f);f=document.createElement("span");f.innerHTML='">'}e.appendChild(f);this.ulContainer.appendChild(e)}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.EditorSpacePanel=function(d){a.EditorGenericPanel.call(this,d);this.params=
d.spaceParams;this.prefix="E_";this.dontShowList={};this.createPanel2()};a.extend(a.EditorSpacePanel,a.EditorGenericPanel);a.EditorSpacePanel.prototype.createPanel=function(){var a=document.getElementById("tab_2"),e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);this.leftPanel=document.createElement("div");this.leftPanel.setAttribute("class","DescartesLeftPanelClass");a=document.createElement("div");this.leftPanel.appendChild(a);e.appendChild(this.leftPanel);
this.rightPanel=document.createElement("div");this.rightPanel.setAttribute("class","DescartesRightPanelClass");e.appendChild(this.rightPanel);for(var e=0,f=this.params.length;e<f;e++)this.buildobj(this.params[e]);this.configLeftPanel(a);this.configRightPanel(this.rightPanel)};a.EditorSpacePanel.prototype.buildobj=function(a){var e=a.value,f,c,b;c="R2";for(var k=0,g=e.length;k<g;k++)if(f=e[k],"type"==babel[f[0]]){c=f[1];break}c=this.newParamObject(c);k=0;for(g=e.length;k<g;k++)f=e[k],b=babel[f[1]]||
f[1],"#"==b.charAt(0)&&7==b.length&&(b=b.substring(1)),c[babel[f[0]]]=b;a.paramObj=c;a.obj=this.toNameValueArray(c)};a.EditorSpacePanel.prototype.configLeftPanel=function(d){function e(b){b=this.obj;f.hideAllAttributes();f.showAttributes(b);f.fillAttributes(b);a.showHTML(f.configRightSubPanel)}for(var f=this,c=document.createElement("ul"),b,k=0,g=this.params.length;k<g;k++)b=document.createElement("li"),b.innerHTML=this.params[k].paramObj.id+"  (space"+this.params[k].paramObj.type+")",b.obj=this.params[k].obj,
b.paramObj=this.params[k].paramObj,b.addEventListener("click",e),c.appendChild(b);d.appendChild(c)};a.EditorSpacePanel.prototype.configRightPanel=function(d){this.configRightSubPanel=document.createElement("div");d.appendChild(this.configRightSubPanel);this.attributes={};this.attributes.id=this.newLabelAndInput({name:"id",value:""},this.configRightSubPanel);this.attributes.x=this.newLabelAndInput({name:"x",value:""},this.configRightSubPanel);this.attributes.y=this.newLabelAndInput({name:"y",value:""},
this.configRightSubPanel);this.attributes.width=this.newLabelAndInput({name:"width",value:""},this.configRightSubPanel);this.attributes.height=this.newLabelAndInput({name:"height",value:""},this.configRightSubPanel);this.attributes.drawif=this.newLabelAndInput({name:"drawif",value:""},this.configRightSubPanel);this.attributes.fixed=this.newLabelAndCheckbox({name:"fixed",value:"false"},this.configRightSubPanel);this.attributes.scale=this.newLabelAndInput({name:"scale",value:""},this.configRightSubPanel);
this.attributes["O.x"]=this.newLabelAndInput({name:"O.x",value:""},this.configRightSubPanel);this.attributes["O.y"]=this.newLabelAndInput({name:"O.y",value:""},this.configRightSubPanel);this.attributes.image=this.newLabelAndInput({name:"image",value:""},this.configRightSubPanel);this.attributes.bg_display=this.newLabelAndMenu({name:"bg_display",value:"topleft"},this.configRightSubPanel,["topleft","stretch","patch","center"]);this.attributes.background=this.newLabelAndInput({name:"background",value:""},
this.configRightSubPanel);this.attributes.file=this.newLabelAndInput({name:"file",value:""},this.configRightSubPanel);this.attributes.net=this.newLabelAndInput({name:"net",value:""},this.configRightSubPanel);this.attributes.net10=this.newLabelAndInput({name:"net10",value:""},this.configRightSubPanel);this.attributes.axes=this.newLabelAndInput({name:"axes",value:""},this.configRightSubPanel);this.attributes.text=this.newLabelAndInput({name:"text",value:""},this.configRightSubPanel);this.attributes.numbers=
this.newLabelAndCheckbox({name:"numbers",value:"false"},this.configRightSubPanel);this.attributes.x_axis=this.newLabelAndInput({name:"x_axis",value:""},this.configRightSubPanel);this.attributes.y_axis=this.newLabelAndInput({name:"y_axis",value:""},this.configRightSubPanel);this.attributes.render=this.newLabelAndMenu({name:"render",value:"sort"},this.configRightSubPanel,["sort","painter"]);this.attributes.split=this.newLabelAndCheckbox({name:"split",value:"false"},this.configRightSubPanel);this.attributes.sensitive_to_mouse_movements=
this.newLabelAndCheckbox({name:"sensitive_to_mouse_movements",value:"false"},this.configRightSubPanel);a.hideHTML(this.configRightSubPanel)};a.EditorSpacePanel.prototype.newParamObject=function(a){return"R2"==a?{type:"R2",id:"E0",x:"0",y:"0",width:"100%",height:"100%",drawif:"1",fixed:"false",scale:"48","O.x":"0","O.y":"0",image:"",bg_display:"topleft",background:"f0f8fa",net:"b8c4c8",net10:"889498",axes:"405860",text:"405860",numbers:"false",x_axis:"",y_axis:"",sensitive_to_mouse_movements:"false"}:
"R3"==a?{type:"R3",id:"E0",x:"0",y:"0",width:"100%",height:"100%",drawif:"1",fixed:"false",scale:"48","O.x":"0","O.y":"0",image:"",bg_display:"topleft",background:"000000",render:"order",split:"false",sensitive_to_mouse_movements:"false"}:{type:"HTMLIFrame",id:"E0",x:"0",y:"0",width:"100%",height:"100%",drawif:"1",image:"",bg_display:"topleft",background:"f0f8fa",file:""}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.EditorControlPanel=function(d){a.EditorGenericPanel.call(this,
d);this.params=d.ctrsParams;this.prefix="C_";this.dontShowList={};this.createPanel2()};a.extend(a.EditorControlPanel,a.EditorGenericPanel);a.EditorControlPanel.prototype.createPanel=function(){var a=document.getElementById("tab_3"),e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);this.leftPanel=document.createElement("div");this.leftPanel.setAttribute("class","DescartesLeftPanelClass");a=document.createElement("div");this.leftPanel.appendChild(a);e.appendChild(this.leftPanel);
this.rightPanel=document.createElement("div");this.rightPanel.setAttribute("class","DescartesRightPanelClass");e.appendChild(this.rightPanel);for(var e=0,f=this.params.length;e<f;e++)this.buildobj(this.params[e]);this.configLeftPanel(a);this.configRightPanel(this.rightPanel)};a.EditorControlPanel.prototype.buildobj=function(a){var e=a.value,f,c,b;c="spinner";for(var k=0,g=e.length;k<g;k++)if(f=e[k],"type"==babel[f[0]]){c=babel[f[1]];break}if("numeric"==c)for(c="spinner",k=0,g=e.length;k<g;k++)if(f=
e[k],"gui"==babel[f[0]]){c=babel[f[1]];break}c=this.newParamObject(c);k=0;for(g=e.length;k<g;k++)f=e[k],b=babel[f[1]]||f[1],"#"==b.charAt(0)&&7==b.length&&(b=b.substring(1)),c[babel[f[0]]]=b;a.paramObj=c;a.obj=this.toNameValueArray(c)};a.EditorControlPanel.prototype.configLeftPanel=function(d){function e(b){b=this.obj;f.hideAllAttributes();f.showAttributes(b);f.fillAttributes(b);a.showHTML(f.configRightSubPanel)}for(var f=this,c=document.createElement("ul"),b,k=0,g=this.params.length;k<g;k++)b=document.createElement("li"),
b.innerHTML=this.params[k].paramObj.id+"  ("+this.params[k].paramObj.type+")",b.obj=this.params[k].obj,b.paramObj=this.params[k].paramObj,b.addEventListener("click",e),c.appendChild(b);d.appendChild(c)};a.EditorControlPanel.prototype.configRightPanel=function(d){this.configRightSubPanel=document.createElement("div");d.appendChild(this.configRightSubPanel);this.attributes={};this.attributes.id=this.newLabelAndInput({name:"id",value:""},this.configRightSubPanel);this.attributes.gui=this.newLabelAndMenu({name:"gui",
value:"spinner"},this.configRightSubPanel,["spinner","textfield","menu","scrollbar","button"]);this.attributes.region=this.newLabelAndMenu({name:"region",value:"south"},this.configRightSubPanel,"south north east west external interior scenario".split(" "));this.attributes.params=this.newLabelAndInput({name:"params",value:""},this.configRightSubPanel);this.attributes.name=this.newLabelAndInput({name:"name",value:""},this.configRightSubPanel);this.attributes.expresion=this.newLabelAndInput({name:"expresion",
value:""},this.configRightSubPanel);this.attributes.value=this.newLabelAndInput({name:"value",value:""},this.configRightSubPanel);this.attributes.incr=this.newLabelAndInput({name:"incr",value:""},this.configRightSubPanel);this.attributes.min=this.newLabelAndInput({name:"min",value:""},this.configRightSubPanel);this.attributes.max=this.newLabelAndInput({name:"max",value:""},this.configRightSubPanel);this.attributes.discrete=this.newLabelAndCheckbox({name:"discrete",value:"false"},this.configRightSubPanel);
this.attributes.decimals=this.newLabelAndInput({name:"decimals",value:""},this.configRightSubPanel);this.attributes.fixed=this.newLabelAndCheckbox({name:"fixed",value:"false"},this.configRightSubPanel);this.attributes.exponentialif=this.newLabelAndInput({name:"exponentialif",value:""},this.configRightSubPanel);this.attributes.visible=this.newLabelAndInput({name:"visible",value:""},this.configRightSubPanel);this.attributes.action=this.newLabelAndMenu({name:"action",value:""},this.configRightSubPanel,
" calculate init clear animate openURL openScene playAudio".split(" "));this.attributes.parameter=this.newLabelAndInput({name:"parameter",value:""},this.configRightSubPanel);this.attributes.drawif=this.newLabelAndInput({name:"drawif",value:""},this.configRightSubPanel);this.attributes.activeif=this.newLabelAndInput({name:"activeif",value:""},this.configRightSubPanel);this.attributes.onlyText=this.newLabelAndCheckbox({name:"onlyText",value:"false"},this.configRightSubPanel);this.attributes.options=
this.newLabelAndInput({name:"options",value:""},this.configRightSubPanel);this.attributes.color=this.newLabelAndInput({name:"color",value:""},this.configRightSubPanel);this.attributes.activeif=this.newLabelAndInput({name:"colorInt",value:""},this.configRightSubPanel);this.attributes.bold=this.newLabelAndCheckbox({name:"bold",value:"false"},this.configRightSubPanel);this.attributes.italics=this.newLabelAndCheckbox({name:"italics",value:"false"},this.configRightSubPanel);this.attributes.underlined=
this.newLabelAndCheckbox({name:"underlined",value:"false"},this.configRightSubPanel);this.attributes.font_size=this.newLabelAndInput({name:"font_size",value:""},this.configRightSubPanel);this.attributes.image=this.newLabelAndInput({name:"image",value:""},this.configRightSubPanel);this.attributes.size=this.newLabelAndInput({name:"size",value:""},this.configRightSubPanel);this.attributes.constraint=this.newLabelAndInput({name:"constraint",value:""},this.configRightSubPanel);this.attributes.text=this.newLabelAndInput({name:"text",
value:""},this.configRightSubPanel);this.attributes.file=this.newLabelAndInput({name:"file",value:""},this.configRightSubPanel);a.hideHTML(this.configRightSubPanel)};a.EditorControlPanel.prototype.newParamObject=function(a){return"spinner"==a?{id:"n1",type:"numeric",gui:"spinner",region:"south",space:"E0",name:"",expresion:"(0,0,100,23)",value:"0",incr:"0.1",min:"",max:"",discrete:"false",decimals:"2",fixed:"true",exponentialif:"",visible:"true",action:"",parameter:"",drawif:"",activeif:""}:"textfield"==
a?{id:"n1",type:"numeric",gui:"textfield",onlyText:"false",region:"south",space:"E0",name:"",expresion:"(0,0,100,23)",value:"0",incr:"0.1",min:"",max:"",discrete:"false",decimals:"2",fixed:"true",exponentialif:"",visible:"true",action:"",parameter:"",drawif:"",activeif:"",evaluate:"false",answer:""}:"menu"==a?{id:"n1",type:"numeric",gui:"menu",region:"south",space:"E0",name:"",expresion:"(0,0,100,23)",value:"0",decimals:"2",fixed:"true",exponentialif:"",visible:"true",options:"",action:"",parameter:"",
drawif:"",activeif:""}:"scrollbar"==a?{id:"n1",type:"numeric",gui:"scrollbar",region:"south",space:"E0",name:"",expresion:"(0,0,100,23)",value:"0",incr:"0.1",min:"0",max:"100",discrete:"false",decimals:"2",fixed:"true",exponentialif:"",visible:"true",action:"",parameter:"",drawif:"",activeif:""}:"button"==a?{id:"n1",gui:"button",type:"numeric",region:"south",space:"E0",name:"",expresion:"(0,0,100,23)",value:"0",visible:"true",color:"222222",colorInt:"f0f8ff",bold:"false",italics:"false",underlined:"false",
font_size:"12",image:"",action:"",parameter:"",drawif:"",activeif:""}:"graphic"==a?{id:"g1",type:"graphic",space:"E0",color:"222222",colorInt:"f0f8ff",size:"4",expresion:"(0,0)",constraint:"",image:"",drawif:"",activeif:""}:"text"==a?{id:"t1",type:"text",space:"E0",expresion:"(0,0)",text:"",answer:"",drawif:"",activeif:""}:"audio"==a?{id:"a1",type:"audio",space:"E0",expresion:"(0,0)",drawif:"",file:""}:{id:"v1",type:"video",space:"E0",expresion:"(0,0)",drawif:"",file:""}};return a}(descartesJS||{}),
descartesJS=function(a){if(a.loadLib)return a;a.EditorDefinitionPanel=function(d){a.EditorGenericPanel.call(this,d);this.params=d.defParams;this.prefix="A_";this.dontShowList={type:!0};this.notifyProgram=!0;this.createPanel2()};a.extend(a.EditorDefinitionPanel,a.EditorGenericPanel);a.EditorDefinitionPanel.prototype.createPanel=function(){var a=document.getElementById("tab_4"),e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);this.leftPanel=document.createElement("div");
this.leftPanel.setAttribute("class","DescartesLeftPanelClass");a=document.createElement("div");this.leftPanel.appendChild(a);e.appendChild(this.leftPanel);this.rightPanel=document.createElement("div");this.rightPanel.setAttribute("class","DescartesRightPanelClass");e.appendChild(this.rightPanel);for(var e=0,f=this.params.length;e<f;e++)this.buildobj(this.params[e]);this.configLeftPanel(a);this.configRightPanel(this.rightPanel)};a.EditorDefinitionPanel.prototype.buildobj=function(a){for(var e=a.value,
f,c,b,k=b=c=!1,g=0,p=e.length;g<p;g++)f=e[g],"array"==babel[f[0]]&&(c=!0),"matrix"==babel[f[0]]&&(b=!0),f[1].match(/\)$/)&&(k=!0);c=this.newParamObject(b?"matrix":c?"array":k?"function":"variable");g=0;for(p=e.length;g<p;g++)f=e[g],b=babel[f[1]]||f[1],"#"==b.charAt(0)&&7==b.length&&(b=b.substring(1)),c[babel[f[0]]]=b;a.paramObj=c;a.obj=this.toNameValueArray(c)};a.EditorDefinitionPanel.prototype.configLeftPanel=function(d){function e(b){b=this.obj;f.hideAllAttributes();f.showAttributes(b);f.fillAttributes(b);
a.showHTML(f.configRightSubPanel)}for(var f=this,c=document.createElement("ul"),b,k=0,g=this.params.length;k<g;k++)b=document.createElement("li"),b.innerHTML=this.params[k].paramObj.id+"  ("+this.params[k].paramObj.type+")",b.obj=this.params[k].obj,b.paramObj=this.params[k].paramObj,b.addEventListener("click",e),c.appendChild(b);d.appendChild(c)};a.EditorDefinitionPanel.prototype.configRightPanel=function(d){this.configRightSubPanel=document.createElement("div");d.appendChild(this.configRightSubPanel);
this.attributes={};this.attributes.id=this.newLabelAndInput({name:"id",value:""},this.configRightSubPanel);this.attributes.expresion=this.newLabelAndInput({name:"expresion",value:""},this.configRightSubPanel);this.attributes.algorithm=this.newLabelAndCheckbox({name:"algorithm",value:"false"},this.configRightSubPanel);this.attributes.range=this.newLabelAndInput({name:"range",value:""},this.configRightSubPanel);this.attributes.local=this.newLabelAndInput({name:"local",value:""},this.configRightSubPanel);
this.attributes.init=this.newLabelAndInput({name:"init",value:""},this.configRightSubPanel);this.attributes.doExpr=this.newLabelAndInput({name:"doExpr",value:""},this.configRightSubPanel);this.attributes.whileExpr=this.newLabelAndInput({name:"whileExpr",value:""},this.configRightSubPanel);this.attributes.evaluate=this.newLabelAndMenu({name:"evaluate",value:"onlyOnce"},this.configRightSubPanel,["onlyOnce","always"]);this.attributes.file=this.newLabelAndInput({name:"file",value:""},this.configRightSubPanel);
this.attributes.columns=this.newLabelAndInput({name:"columns",value:""},this.configRightSubPanel);this.attributes.rows=this.newLabelAndInput({name:"rows",value:""},this.configRightSubPanel);a.hideHTML(this.configRightSubPanel)};a.EditorDefinitionPanel.prototype.newParamObject=function(a){return"variable"==a?{id:"v1",expresion:"0",type:"variable"}:"function"==a?{id:"f(x)",algorithm:"false",expresion:"x",range:"",local:"",init:"",doExpr:"",whileExpr:"",type:"function"}:"array"==a?{id:"V1",array:"true",
evaluate:"onlyOnce",size:"3",expresion:"V3[0]=0;V3[1]=0;V3[2]=0",file:"",type:"array"}:{id:"M1",matrix:"true",evaluate:"onlyOnce",columns:"3",rows:"3",expresion:"M4[0,0]=0;M4[1,0]=0;M4[2,0]=0;M4[0,1]=0;M4[1,1]=0;M4[2,1]=0;M4[0,2]=0;M4[1,2]=0;M4[2,2]=0;",type:"matrix"}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.EditorProgramPanel=function(d){a.EditorGenericPanel.call(this,d);this.params=d.progParams;this.prefix="A_";this.dontShowList={type:!0};this.useDisplaceIndex=
!0;this.createPanel2()};a.extend(a.EditorProgramPanel,a.EditorGenericPanel);a.EditorProgramPanel.prototype.createPanel=function(){var a=document.getElementById("tab_5"),e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);this.leftPanel=document.createElement("div");this.leftPanel.setAttribute("class","DescartesLeftPanelClass");a=document.createElement("div");this.leftPanel.appendChild(a);e.appendChild(this.leftPanel);this.rightPanel=document.createElement("div");
this.rightPanel.setAttribute("class","DescartesRightPanelClass");e.appendChild(this.rightPanel);for(var e=0,f=this.params.length;e<f;e++)this.buildobj(this.params[e]);this.configLeftPanel(a);this.configRightPanel(this.rightPanel)};a.EditorProgramPanel.prototype.buildobj=function(a){var e=a.value,f,c,b;c="constant";for(var k=0,g=e.length;k<g;k++)f=e[k],"constant"==babel[f[0]]&&(c="constant"),"event"==babel[f[0]]&&(c="event"),"algorithm"==babel[f[0]]&&(c="algorithm");c=this.newParamObject(c);k=0;for(g=
e.length;k<g;k++)f=e[k],b=babel[f[1]]||f[1],"#"==b.charAt(0)&&7==b.length&&(b=b.substring(1)),c[babel[f[0]]]=b;a.paramObj=c;a.obj=this.toNameValueArray(c)};a.EditorProgramPanel.prototype.configLeftPanel=function(d){function e(b){b=this.obj;f.hideAllAttributes();f.showAttributes(b);f.fillAttributes(b);a.showHTML(f.configRightSubPanel)}for(var f=this,c=document.createElement("ul"),b,k=0,g=this.params.length;k<g;k++)b=document.createElement("li"),b.innerHTML=this.params[k].paramObj.id+"  ("+this.params[k].paramObj.type+
")",b.obj=this.params[k].obj,b.paramObj=this.params[k].paramObj,b.addEventListener("click",e),c.appendChild(b);d.appendChild(c)};a.EditorProgramPanel.prototype.configRightPanel=function(d){this.configRightSubPanel=document.createElement("div");d.appendChild(this.configRightSubPanel);this.attributes={};this.attributes.id=this.newLabelAndInput({name:"id",value:""},this.configRightSubPanel);this.attributes.expresion=this.newLabelAndInput({name:"expresion",value:""},this.configRightSubPanel);this.attributes.condition=
this.newLabelAndInput({name:"condition",value:""},this.configRightSubPanel);this.attributes.action=this.newLabelAndMenu({name:"action",value:""},this.configRightSubPanel," calculate init clear animate openURL openScene playAudio".split(" "));this.attributes.parameter=this.newLabelAndInput({name:"parameter",value:""},this.configRightSubPanel);this.attributes.execution=this.newLabelAndMenu({name:"execution",value:"onlyOnce"},this.configRightSubPanel,["onlyOnce","alternate","always"]);this.attributes.algorithm=
this.newLabelAndCheckbox({name:"algorithm",value:"false"},this.configRightSubPanel);this.attributes.evaluate=this.newLabelAndMenu({name:"evaluate",value:"onlyOnce"},this.configRightSubPanel,["onlyOnce","always"]);this.attributes.init=this.newLabelAndInput({name:"init",value:""},this.configRightSubPanel);this.attributes.doExpr=this.newLabelAndInput({name:"doExpr",value:""},this.configRightSubPanel);this.attributes.whileExpr=this.newLabelAndInput({name:"whileExpr",value:""},this.configRightSubPanel);
a.hideHTML(this.configRightSubPanel)};a.EditorProgramPanel.prototype.newParamObject=function(a){return"constant"==a?{id:"c1",expresion:"0",evaluate:"onlyOnce",constant:"true",type:"constant"}:"event"==a?{id:"e1",event:"true",condition:"",action:"",parameter:"",execution:"",type:"event"}:{id:"A1",algorithm:"true",evaluate:"onlyOnce",init:"",doExpr:"",whileExpr:"",type:"algorithm"}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.EditorGraphicPanel=function(d){a.EditorGenericPanel.call(this,
d);this.params=d.graphParams;this.prefix="G_";this.dontShowList={useFamily:!0};this.createPanel2()};a.extend(a.EditorGraphicPanel,a.EditorGenericPanel);a.EditorGraphicPanel.prototype.createPanel=function(){var a=document.getElementById("tab_6"),e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);this.leftPanel=document.createElement("div");this.leftPanel.setAttribute("class","DescartesLeftPanelClass");a=document.createElement("div");this.leftPanel.appendChild(a);
e.appendChild(this.leftPanel);this.rightPanel=document.createElement("div");this.rightPanel.setAttribute("class","DescartesRightPanelClass");e.appendChild(this.rightPanel);for(var e=0,f=this.params.length;e<f;e++)this.buildobj(this.params[e]);this.configLeftPanel(a);this.configRightPanel(this.rightPanel)};a.EditorGraphicPanel.prototype.buildobj=function(a){var e=a.value,f,c,b;c="equation";for(var k=0,g=e.length;k<g;k++)if(f=e[k],"type"==babel[f[0]]){c=babel[f[1]];break}c=this.newParamObject(c);for(var p=
"",h="t",k=0,g=e.length;k<g;k++)f=e[k],b=f[1],"family"==babel[f[0]]&&(p=b),"parameter"==babel[f[0]]&&(h=b);k=0;for(g=e.length;k<g;k++){f=e[k];b=babel[f[1]]||f[1]||"";"#"==b.charAt(0)&&7==b.length&&(b=b.substring(1));"family"==babel[f[0]]&&(c.useFamily="true");if(""!=p&&babel[f[0].substring(p.length+1)]&&f[0].substring(0,p.length)==p){if("interval"==babel[f[0].substring(p.length+1)]){c.family_interval=b;continue}if("steps"==babel[f[0].substring(p.length+1)]){c.family_steps=b;continue}}if(""!=h&&babel[f[0].substring(h.length+
1)]&&f[0].substring(0,h.length)==h){if("interval"==babel[f[0].substring(h.length+1)]){c.parameter_interval=b;continue}if("steps"==babel[f[0].substring(h.length+1)]){c.parameter_steps=b;continue}}c[babel[f[0]]]=b}a.paramObj=c;a.obj=this.toNameValueArray(c)};a.EditorGraphicPanel.prototype.configLeftPanel=function(d){function e(b){b=this.obj;f.hideAllAttributes();f.showAttributes(b);f.fillAttributes(b);a.showHTML(f.configRightSubPanel)}for(var f=this,c=document.createElement("ul"),b,k=0,g=this.params.length;k<
g;k++)b=document.createElement("li"),b.innerHTML=this.params[k].paramObj.id+"  ("+this.params[k].paramObj.type+")",b.obj=this.params[k].obj,b.paramObj=this.params[k].paramObj,b.addEventListener("click",e),c.appendChild(b);d.appendChild(c)};a.EditorGraphicPanel.prototype.configRightPanel=function(d){this.configRightSubPanel=document.createElement("div");d.appendChild(this.configRightSubPanel);this.attributes={};this.attributes.space=this.newLabelAndInput({name:"space",value:""},this.configRightSubPanel);
this.attributes.background=this.newLabelAndCheckbox({name:"background",value:"false"},this.configRightSubPanel);this.attributes.color=this.newLabelAndInput({name:"color",value:""},this.configRightSubPanel);this.attributes.drawif=this.newLabelAndInput({name:"drawif",value:""},this.configRightSubPanel);this.attributes.abs_coord=this.newLabelAndCheckbox({name:"abs_coord",value:"false"},this.configRightSubPanel);this.attributes.expresion=this.newLabelAndInput({name:"expresion",value:""},this.configRightSubPanel);
this.attributes.trace=this.newLabelAndCheckbox({name:"trace",value:"false"},this.configRightSubPanel);this.attributes.parameter=this.newLabelAndInput({name:"parameter",value:""},this.configRightSubPanel);this.attributes.parameter_interval=this.newLabelAndInput({name:"parameter_interval",value:""},this.configRightSubPanel);this.attributes.parameter_steps=this.newLabelAndInput({name:"parameter_steps",value:""},this.configRightSubPanel);this.attributes.useFamily=this.newLabelAndCheckbox({name:"useFamily",
value:"false"},this.configRightSubPanel);this.attributes.family=this.newLabelAndInput({name:"family",value:""},this.configRightSubPanel);this.attributes.family_interval=this.newLabelAndInput({name:"family_interval",value:""},this.configRightSubPanel);this.attributes.family_steps=this.newLabelAndInput({name:"family_steps",value:""},this.configRightSubPanel);this.attributes.fillP=this.newLabelAndInput({name:"fillP",value:""},this.configRightSubPanel);this.attributes.fillM=this.newLabelAndInput({name:"fillM",
value:""},this.configRightSubPanel);this.attributes.width=this.newLabelAndInput({name:"width",value:""},this.configRightSubPanel);this.attributes.visible=this.newLabelAndCheckbox({name:"visible",value:"false"},this.configRightSubPanel);this.attributes.editable=this.newLabelAndCheckbox({name:"editable",value:"false"},this.configRightSubPanel);this.attributes.fill=this.newLabelAndInput({name:"fill",value:""},this.configRightSubPanel);this.attributes.size=this.newLabelAndInput({name:"size",value:""},
this.configRightSubPanel);this.attributes.range=this.newLabelAndInput({name:"range",value:""},this.configRightSubPanel);this.attributes.text=this.newLabelAndInput({name:"text",value:""},this.configRightSubPanel);this.attributes.decimals=this.newLabelAndInput({name:"decimals",value:""},this.configRightSubPanel);this.attributes.fixed=this.newLabelAndCheckbox({name:"fixed",value:"false"},this.configRightSubPanel);this.attributes.spear=this.newLabelAndInput({name:"spear",value:""},this.configRightSubPanel);
this.attributes.arrow=this.newLabelAndInput({name:"arrow",value:""},this.configRightSubPanel);this.attributes.center=this.newLabelAndInput({name:"center",value:""},this.configRightSubPanel);this.attributes.radius=this.newLabelAndInput({name:"radius",value:""},this.configRightSubPanel);this.attributes.init=this.newLabelAndInput({name:"init",value:""},this.configRightSubPanel);this.attributes.end=this.newLabelAndInput({name:"end",value:""},this.configRightSubPanel);this.attributes.vectors=this.newLabelAndCheckbox({name:"vectors",
value:"false"},this.configRightSubPanel);this.attributes.border=this.newLabelAndInput({name:"border",value:""},this.configRightSubPanel);this.attributes.file=this.newLabelAndInput({name:"file",value:""},this.configRightSubPanel);this.attributes.opacity=this.newLabelAndInput({name:"opacity",value:""},this.configRightSubPanel);this.attributes.inirot=this.newLabelAndInput({name:"inirot",value:""},this.configRightSubPanel);this.attributes.inipos=this.newLabelAndInput({name:"inipos",value:""},this.configRightSubPanel);
this.attributes.name=this.newLabelAndInput({name:"name",value:""},this.configRightSubPanel);this.attributes.info=this.newLabelAndInput({name:"info",value:""},this.configRightSubPanel);a.hideHTML(this.configRightSubPanel)};a.EditorGraphicPanel.prototype.newParamObject=function(a){return"equation"==a?{space:"E0",type:"equation",background:"false",color:"20303a",drawif:"",abs_coord:"false",expresion:"y=x",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",fillP:"",fillM:"",
width:"1",visible:"false",editable:"false",info:""}:"curve"==a?{space:"E0",type:"curve",background:"false",color:"20303a",drawif:"",abs_coord:"false",expresion:"(t,t)",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",parameter:"t",parameter_interval:"[0,1]",parameter_steps:"8",fill:"",width:"1",visible:"false",editable:"false",info:""}:"sequence"==a?{space:"E0",type:"sequence",background:"false",color:"20303a",drawif:"",abs_coord:"false",expresion:"(n,1/n)",trace:"false",
useFamily:"false",family:"",family_interval:"",family_steps:"",size:"2",visible:"false",editable:"false",range:"[1,100]",info:""}:"point"==a?{space:"E0",type:"point",background:"false",color:"20303a",drawif:"",abs_coord:"false",expresion:"(0,0)",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",text:"",decimals:"2",fixed:"true",size:"2",font:"Monospaced,PLAIN,15",info:""}:"segment"==a?{space:"E0",type:"segment",background:"false",color:"20303a",drawif:"",abs_coord:"false",
expresion:"(0,0)(1,1)",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",text:"",decimals:"2",fixed:"true",size:"2",width:"1",font:"Monospaced,PLAIN,15",info:""}:"arrow"==a?{space:"E0",type:"arrow",background:"false",color:"20303a",drawif:"",abs_coord:"false",expresion:"(0,0)(1,1)",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",text:"",decimals:"2",fixed:"true",width:"5",size:"",spear:"8",arrow:"ee0022",font:"Monospaced,PLAIN,15",info:""}:"polygon"==
a?{space:"E0",type:"polygon",background:"false",color:"20303a",drawif:"",abs_coord:"false",expresion:"(0,0)(1,1)(2,-1)",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",fill:"",width:"1",info:""}:"arc"==a?{space:"E0",type:"arc",background:"false",color:"20303a",drawif:"",abs_coord:"false",center:"(0,0)",radius:"1",init:"0",end:"90",vectors:"false",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",text:"",decimals:"2",fixed:"true",fill:"",width:"1",
font:"Monospaced,PLAIN,15",info:""}:"fill"==a?{space:"E0",type:"fill",background:"false",color:"20303a",drawif:"",abs_coord:"false",expresion:"(0,0)",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",info:""}:"text"==a?{space:"E0",type:"text",background:"false",color:"20303a",drawif:"",expresion:"[20,20]",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",text:"",decimals:"2",fixed:"true",width:"1",border:"",font:"Monospaced,PLAIN,15",info:""}:
"image"==a?{space:"E0",type:"image",background:"false",drawif:"",abs_coord:"false",expresion:"(0,0)",trace:"false",useFamily:"false",family:"",family_interval:"",family_steps:"",file:"",inirot:"0",opacity:"0",info:""}:{space:"E0",type:"macro",background:"false",drawif:"",abs_coord:"false",name:"mac1",expresion:"",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"0",inipos:"[0,0]",info:""}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.EditorGraphic3DPanel=
function(d){a.EditorGenericPanel.call(this,d);this.params=d.graph3DParams;this.prefix="S_";this.dontShowList={useFamily:!0};this.createPanel2()};a.extend(a.EditorGraphic3DPanel,a.EditorGenericPanel);a.EditorGraphic3DPanel.prototype.createPanel=function(){var a=document.getElementById("tab_7"),e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);this.leftPanel=document.createElement("div");this.leftPanel.setAttribute("class","DescartesLeftPanelClass");a=document.createElement("div");
this.leftPanel.appendChild(a);e.appendChild(this.leftPanel);this.rightPanel=document.createElement("div");this.rightPanel.setAttribute("class","DescartesRightPanelClass");e.appendChild(this.rightPanel);for(var e=0,f=this.params.length;e<f;e++)this.buildobj(this.params[e]);this.configLeftPanel(a);this.configRightPanel(this.rightPanel)};a.EditorGraphic3DPanel.prototype.buildobj=function(a){var e=a.value,f,c,b;c="point";for(var k=0,g=e.length;k<g;k++)if(f=e[k],"type"==babel[f[0]]){c=babel[f[1]];break}c=
this.newParamObject(c);for(var p="",k=0,g=e.length;k<g;k++)f=e[k],b=f[1],"family"==babel[f[0]]&&(p=b);k=0;for(g=e.length;k<g;k++){f=e[k];b=babel[f[1]]||f[1]||"";"#"==b.charAt(0)&&7==b.length&&(b=b.substring(1));"family"==babel[f[0]]&&(c.useFamily="true");if(""!=p&&babel[f[0].substring(p.length+1)]&&f[0].substring(0,p.length)==p){if("interval"==babel[f[0].substring(p.length+1)]){c.family_interval=b;continue}if("steps"==babel[f[0].substring(p.length+1)]){c.family_steps=b;continue}}c[babel[f[0]]]=b}a.paramObj=
c;a.obj=this.toNameValueArray(c)};a.EditorGraphic3DPanel.prototype.configLeftPanel=function(d){function e(b){b=this.obj;f.hideAllAttributes();f.showAttributes(b);f.fillAttributes(b);a.showHTML(f.configRightSubPanel)}for(var f=this,c=document.createElement("ul"),b,k=0,g=this.params.length;k<g;k++)b=document.createElement("li"),b.innerHTML=this.params[k].paramObj.name+"  ("+this.params[k].paramObj.type+")",b.obj=this.params[k].obj,b.paramObj=this.params[k].paramObj,b.addEventListener("click",e),c.appendChild(b);
d.appendChild(c)};a.EditorGraphic3DPanel.prototype.configRightPanel=function(d){this.configRightSubPanel=document.createElement("div");d.appendChild(this.configRightSubPanel);this.attributes={};this.attributes.name=this.newLabelAndInput({name:"name",value:""},this.configRightSubPanel);this.attributes.space=this.newLabelAndInput({name:"space",value:""},this.configRightSubPanel);this.attributes.background=this.newLabelAndCheckbox({name:"background",value:"false"},this.configRightSubPanel);this.attributes.color=
this.newLabelAndInput({name:"color",value:""},this.configRightSubPanel);this.attributes.backcolor=this.newLabelAndInput({name:"backcolor",value:""},this.configRightSubPanel);this.attributes.drawif=this.newLabelAndInput({name:"drawif",value:""},this.configRightSubPanel);this.attributes.expresion=this.newLabelAndInput({name:"expresion",value:""},this.configRightSubPanel);this.attributes.useFamily=this.newLabelAndCheckbox({name:"useFamily",value:"false"},this.configRightSubPanel);this.attributes.family=
this.newLabelAndInput({name:"family",value:""},this.configRightSubPanel);this.attributes.family_interval=this.newLabelAndInput({name:"family_interval",value:""},this.configRightSubPanel);this.attributes.family_steps=this.newLabelAndInput({name:"family_steps",value:""},this.configRightSubPanel);this.attributes.inirot=this.newLabelAndInput({name:"inirot",value:""},this.configRightSubPanel);this.attributes.inipos=this.newLabelAndInput({name:"inipos",value:""},this.configRightSubPanel);this.attributes.endrot=
this.newLabelAndInput({name:"endrot",value:""},this.configRightSubPanel);this.attributes.endpos=this.newLabelAndInput({name:"endpos",value:""},this.configRightSubPanel);this.attributes.split=this.newLabelAndCheckbox({name:"split",value:"false"},this.configRightSubPanel);this.attributes.edges=this.newLabelAndCheckbox({name:"edges",value:"false"},this.configRightSubPanel);this.attributes.model=this.newLabelAndMenu({name:"model",value:"metal"},this.configRightSubPanel,["color","light","metal","wire"]);
this.attributes.text=this.newLabelAndInput({name:"text",value:""},this.configRightSubPanel);this.attributes.decimals=this.newLabelAndInput({name:"decimals",value:""},this.configRightSubPanel);this.attributes.fixed=this.newLabelAndCheckbox({name:"fixed",value:"false"},this.configRightSubPanel);this.attributes.width=this.newLabelAndInput({name:"width",value:""},this.configRightSubPanel);this.attributes.length=this.newLabelAndInput({name:"length",value:""},this.configRightSubPanel);this.attributes.height=
this.newLabelAndInput({name:"height",value:""},this.configRightSubPanel);this.attributes.Nu=this.newLabelAndInput({name:"Nu",value:""},this.configRightSubPanel);this.attributes.Nv=this.newLabelAndInput({name:"Nv",value:""},this.configRightSubPanel);a.hideHTML(this.configRightSubPanel)};a.EditorGraphic3DPanel.prototype.newParamObject=function(a){var e;"point"==a?e={name:"",space:"E0",type:"point",background:"false",color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"(0,0,0)",useFamily:"false",family:"",
family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",text:"",decimals:"2",fixed:"true",width:"1"}:"segment"==a||"polygon"==a||"curve"==a?(e={name:"",space:"E0",type:a,background:"false",color:"eeffaa",drawif:"",expresion:"",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",width:"1",Nu:"7"},e.expresion="segment"==a?"(0,0,0)(1,1,1)":"polygon"==
a?"(0,0,0)(1,0,0)(1,1,0)(1,1,1)":"x=cos(4*pi*u) y=sen(4*pi*u) z=2*u-1"):"triangle"==a||"face"==a?(e={name:"",space:"E0",type:a,background:"false",color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",edges:"false",model:"metal"},e.expresion="triangle"==a?"(1,0,0)(0,1,0)(0,0,1)":"(0,0)(0,1)(1,1)"):"polireg"==a?e={name:"",space:"E0",type:"polireg",background:"false",
color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"Polireg",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",edges:"false",model:"metal",width:"2",length:"2",Nu:"7"}:"surface"==a?e={name:"",space:"E0",type:"surface",background:"false",color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"x=2*u-1 y=2*v-1 z=x^2-y^2",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",
endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",edges:"false",model:"metal",Nu:"7",Nv:"7"}:"text"==a?e={name:"",space:"E0",type:"face",background:"false",color:"eeffaa",drawif:"",expresion:"[20,20]",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",text:"",decimals:"2",fixed:"true"}:"box"==a?e={name:"",space:"E0",type:"box",background:"false",color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"Paralelep\u00edpedo",useFamily:"false",family:"",family_interval:"",
family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",edges:"false",model:"metal",width:"2",length:"2",height:"2"}:"cube"==a||"tetrahedron"==a||"octahedron"==a||"dodecahedron"==a||"icosahedron"==a?(e={name:"",space:"E0",type:a,background:"false",color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",edges:"false",
model:"metal",width:"2"},e.expresion="cube"==a?"Cubo":"tetrahedron"==a?"Tetraedro":"octahedron"==a?"Octaedro":"dodecahedron"==a?"Dodecaedro":"Icosaedro"):"sphere"==a?e={name:"",space:"E0",type:"sphere",background:"false",color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"Esfera",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",edges:"false",model:"metal",width:"2",Nu:"7",Nv:"7"}:"ellipsoid"==a||"cone"==
a||"cylinder"==a?(e={name:"",space:"E0",type:a,background:"false",color:"eeffaa",backcolor:"6090a0",drawif:"",expresion:"",useFamily:"false",family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)",split:"false",edges:"false",model:"metal",width:"2",length:"2",height:"2",Nu:"7",Nv:"7"},e.expresion="ellipsoid"==a?"Elipsoide":"cone"==a?"Cono":"Cilindro"):e={name:"",space:"E0",type:"macro",background:"false",drawif:"",expresion:"mi_macro",useFamily:"false",
family:"",family_interval:"",family_steps:"",inirot:"(0,0,0)",inipos:"(0,0,0)",endrot:"(0,0,0)",endpos:"(0,0,0)"};return e};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.EditorAnimationPanel=function(d){a.EditorGenericPanel.call(this,d);if(0>=d.animParams.length)this.hasAnimation=!1,this.params=[{name:"Animation",value:"false"},{name:"delay",value:"1000"},{name:"controls",value:"false"},{name:"auto",value:"false"},{name:"loop",value:"false"},{name:"init",value:""},{name:"doExpr",
value:""},{name:"whileExpr",value:""}];else{this.hasAnimation=!0;d=d.animParams[0].value;for(var e=[{name:"Animation",value:"true"}],f=0,c=d.length;f<c;f++)e.push({name:babel[d[f][0]]||d[f][0],value:babel[d[f][1]]||d[f][1]});this.params=e}this.createPanel2()};a.extend(a.EditorAnimationPanel,a.EditorGenericPanel);a.EditorAnimationPanel.prototype.createPanel=function(){var a=document.getElementById("tab_8"),e=document.createElement("div");e.setAttribute("class","DescartesConfigPanel");a.appendChild(e);
this.parameters=[];this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(this.params,"Animation"),e));this.parameters.push(this.newLabelAndInput(this.findObjectByName(this.params,"delay"),e));this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(this.params,"controls"),e));this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(this.params,"auto"),e));this.parameters.push(this.newLabelAndCheckbox(this.findObjectByName(this.params,"loop"),e));this.parameters.push(this.newLabelAndInput(this.findObjectByName(this.params,
"init"),e));this.parameters.push(this.newLabelAndInput(this.findObjectByName(this.params,"doExpr"),e));this.parameters.push(this.newLabelAndInput(this.findObjectByName(this.params,"whileExpr"),e))};a.EditorAnimationPanel.prototype.createPanel2=function(a){a||(this.ulContainer=document.createElement("ul"),this.editor.listContainer.appendChild(this.ulContainer));var e,f;if(this.hasAnimation){this.ulContainer.style.display=null;a=document.createElement("li");e=document.createElement("span");e.innerHTML=
'&lt;param name="'+babel.toLanguage("Animation")+'" value="';a.appendChild(e);for(var c=0,b=this.params.length;c<b;c++)f=babel[this.params[c].name]||this.params[c].name,value=babel[this.params[c].value]||this.params[c].value,value=value.replace(/</g,"&lt;"),"Animation"!=f&&(e=document.createElement("span"),e.innerHTML=babel.toLanguage(f)+"='",a.appendChild(e),e=document.createElement("span"),e.setAttribute("class","DescartesSpanValue"),e.setAttribute("contenteditable","true"),e.innerHTML=babel.toLanguage(value),
a.appendChild(e),e=document.createElement("span"),e.innerHTML="'"+(c<b-1?" ":""),a.appendChild(e));e=document.createElement("span");e.innerHTML='"&gt;';a.appendChild(e);this.ulContainer.appendChild(a)}else this.ulContainer.style.display="none"};a.EditorAnimationPanel.prototype.add=function(){this.hasAnimation||(this.hasAnimation=!0,this.ulContainer.innerHTML="",this.createPanel2(!0))};a.EditorAnimationPanel.prototype.remove=function(){this.hasAnimation=!1;this.ulContainer.innerHTML="";this.createPanel2(!0)};
a.EditorAnimationPanel.prototype.getContent=function(){return this.hasAnimation?this.ulContainer.textContent:""};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d="Espacio 2D;Espacio 3D;Espacio HTMLIFrame;Pulsador;Campo de texto;Men\u00fa;Barra;Bot\u00f3n;Control gr\u00e1fico;Control de texto;Audio;Video;Variable;Funci\u00f3n;Vector;Matriz;Constante;Evento;Algoritmo;Ecuaci\u00f3n;Curva;Sucesi\u00f3n;Punto;Segmento;Flecha;Pol\u00edgono;Arco;Relleno;Texto;Image;Macro 2D;Punto 3D;Segmento 3D;Pol\u00edgono 3D;Curva 3D;Tri\u00e1ngulo;Cara;Pol\u00edgono regular 3D;Superficie;Texto 3D;Cubo;Paralelep\u00edpedo;Tetraedro;Octaedro;Dodecaedro;Icosaedro;Esfera;Elipsoide;Cono;Cilindro;Macro 3D;Animaci\u00f3n".split(";"),
e="R2 R3 HTMLIFrame spinner textfield menu scrollbar button graphic text audio video variable function array matrix constant event algorithm equation curve sequence point segment arrow polygon arc fill text image macro point segment polygon curve triangle face polireg surface text cube box tetrahedron octahedron dodecahedron icosahedron sphere ellipsoid cone cylinder macro animation".split(" ");a.Editor=function(a){this.parent=a;this.container=document.createElement("div");this.container.setAttribute("class",
"DescartesEditorContainer");document.body.appendChild(this.container);this.readConfiguration();this.hide();this.configDescartesParamList()};a.Editor.prototype.show=function(){this.container.style.display="block"};a.Editor.prototype.hide=function(){this.container.style.display="none"};a.Editor.prototype.readConfiguration=function(){this.documentClone=document.createElement("document");this.documentClone.innerHTML=document.documentElement.innerHTML;for(var a=this.documentClone.querySelectorAll("meta,#StyleDescartesApps,#StyleDescartesApps2,base,.DescartesEditorContainer"),
c=0,b=a.length;c<b;c++)a[c].parentNode.removeChild(a[c]);for(var a=document.querySelectorAll("applet,ajs"),d,c=0,b=a.length;c<b;c++)if(a[c]==this.parent.applet){d=c;break}a=this.documentClone.querySelectorAll("applet,ajs");this.appletClone=a[d];a[d].parentNode.replaceChild(document.createElement("DescartesPlaceholder"),a[d]);c=this.appletClone.querySelector("param");c.parentNode.removeChild(c);(this.script_docBase=this.appletClone.querySelector("script"))&&this.script_docBase.parentNode.removeChild(this.script_docBase);
a=this.parent.lessonParser;d=this.parent.applet.attributes;this.configAttributes=[];c=0;for(b=d.length;c<b;c++)this.configAttributes.push({name:d[c].name,value:d[c].value});var g=this.parent.children;this.sceneParams=[];this.spaceParams=[];this.ctrsParams=[];this.auxParams=[];this.defParams=[];this.progParams=[];this.graphParams=[];this.graph3DParams=[];this.animParams=[];var e="";d="";c=0;for(b=g.length;c<b;c++)e=g[c].getAttribute("name"),d=a.split(g[c].getAttribute("value")),e&&(e.match("E_")?this.spaceParams.push({name:e,
value:d}):e.match("C_")?this.ctrsParams.push({name:e,value:d}):e.match("A_")?this.auxParams.push({name:e,value:d}):e.match("G_")?this.graphParams.push({name:e,value:d}):e.match("S_")?this.graph3DParams.push({name:e,value:d}):"Animation"==babel[e]?this.animParams.push({name:e,value:d}):this.sceneParams.push({name:babel[e]||e,value:babel[g[c].getAttribute("value")]||g[c].getAttribute("value")}));for(var h,q,c=0,b=this.auxParams.length;c<b;c++){for(var a=this.auxParams[c].value,g=e=h=q=!1,m=0,l=a.length;m<
l;m++)d=babel[a[m][0]],"id"==d&&a[m][1].match(/\)$/)&&(e=!0),"algorithm"==d&&(g=!0),"event"==d&&(q=!0),"constant"==d&&(h=!0);g&&!e||h||q?this.progParams.push(this.auxParams[c]):this.defParams.push(this.auxParams[c])}};a.Editor.prototype.configDescartesTabs=function(){function d(){var a=this.parentNode.getAttribute("data-current");document.getElementById("tabHeader_"+a).removeAttribute("class");document.getElementById("tab_"+a).style.display="none";a=this.id.split("_")[1];this.setAttribute("class",
"tabActiveHeader");document.getElementById("tab_"+a).style.display="block";this.parentNode.setAttribute("data-current",a)}this.DescartesTabsContainer=document.createElement("div");this.DescartesTabsContainer.setAttribute("class","DescartesEditorTabContainer");this.DescartesTabsContainer.innerHTML="<div class='DescartesTabs'>\n<ul>\n<li id='tabHeader_1'>Configuraci&oacute;n</li>\n<li id='tabHeader_2'>Espacios</li>\n<li id='tabHeader_3'>Controles</li>\n<li id='tabHeader_4'>Definiciones</li>\n<li id='tabHeader_5'>Programa</li>\n<li id='tabHeader_6'>Gr&aacute;ficos</li>\n<li id='tabHeader_7'>Gr&aacute;ficos 3D</li>\n<li id='tabHeader_8'>Animaci&oacute;n</li>\n</ul>\n</div>\n<div class='DescartesTabscontent'>\n<div class='DescartesTabPage' id='tab_1'></div>\n<div class='DescartesTabPage' id='tab_2'></div>\n<div class='DescartesTabPage' id='tab_3'></div>\n<div class='DescartesTabPage' id='tab_4'></div>\n<div class='DescartesTabPage' id='tab_5'></div>\n<div class='DescartesTabPage' id='tab_6'></div>\n<div class='DescartesTabPage' id='tab_7'></div>\n<div class='DescartesTabPage' id='tab_8'></div>\n</div>\n<div class='DescartesButtonsPlace'>\n<input id='Descartes_OKButton' class='DescartesEditorButton' type='submit' value='Aceptar' />\n<input id='Descartes_CancelButton' class='DescartesEditorButton' type='submit' value='Cancelar' />\n</div>\n";
var c=this.DescartesTabsContainer.querySelector(".DescartesTabs ul li"),b=c.id.split("_")[1];c.parentNode.setAttribute("data-current",b);c.setAttribute("class","tabActiveHeader");b=this.DescartesTabsContainer.querySelectorAll(".DescartesTabPage");for(c=1;c<b.length;c++)b[c].style.display="none";b=this.DescartesTabsContainer.querySelectorAll(".DescartesTabs ul li");for(c=0;c<b.length;c++)b[c].addEventListener("click",d);this.container.appendChild(this.DescartesTabsContainer);this.configPanel=new a.EditorConfigPanel(this);
this.spacePanel=new a.EditorSpacePanel(this);this.controlPanel=new a.EditorControlPanel(this);this.definitionPanel=new a.EditorDefinitionPanel(this);this.programPanel=new a.EditorProgramPanel(this);this.graphicPanel=new a.EditorGraphicPanel(this);this.graphic3DPanel=new a.EditorGraphic3DPanel(this);this.animationPanel=new a.EditorAnimationPanel(this);var e=this;document.getElementById("Descartes_OKButton").addEventListener("click",function(a){a.preventDefault();this.blur();e.hide();console.log("ok")});
document.getElementById("Descartes_CancelButton").addEventListener("click",function(a){a.preventDefault();this.blur();e.hide();console.log("cancel")})};a.Editor.prototype.configDescartesParamList=function(){this.configToolbar();this.configListContainer();this.configFooter();this.configAddPanel()};a.Editor.prototype.configToolbar=function(){function d(a){p.showAddPanel()}function c(a){p.removeAttribute()}function b(a){p.cloneAttribute()}function e(a){p.moveUpAttribute()}function g(a){p.moveDownAttribute()}
var p=this,h=document.createElement("div");h.setAttribute("class","DescartesToolbarPlace");var q=this.newButton("Agregar"),m=this.newButton("Remover"),l=this.newButton("Duplicar"),s=this.newButton("Subir"),t=this.newButton("Bajar");h.appendChild(q);h.appendChild(m);h.appendChild(l);h.appendChild(s);h.appendChild(t);this.container.appendChild(h);a.hasTouchSupport?(q.addEventListener("touchend",d),m.addEventListener("touchend",c),l.addEventListener("touchend",b),s.addEventListener("touchend",e),t.addEventListener("touchend",
g)):(q.addEventListener("click",d),m.addEventListener("click",c),l.addEventListener("click",b),s.addEventListener("click",e),t.addEventListener("click",g))};a.Editor.prototype.configListContainer=function(){function d(a){var b=null;"li"==a.target.tagName.toLowerCase()?b=a.target:"li"==a.target.parentNode.tagName.toLowerCase()&&(b=a.target.parentNode);b&&(c.wichParamSelected&&(c.wichParamSelected.className=c.wichParamSelected.className.replace(/(?:^|\s)DescartesElementSelected(?!\S)/g,"")),c.wichParamSelected=
b,b.className+=" DescartesElementSelected")}var c=this;this.listContainer=document.createElement("div");this.listContainer.setAttribute("class","DescarteslistContainer");this.container.appendChild(this.listContainer);var b=document.createElement("div");b.setAttribute("class","DescartesExtraInfo");b.innerHTML="&lt;script type='text/javascript' src='http://arquimedes.matem.unam.mx/Descartes5/lib/descartes-min.js'&gt;&lt;/script&gt;";this.listContainer.appendChild(b);this.configPanel=new a.EditorConfigPanel(this);
this.spacePanel=new a.EditorSpacePanel(this);this.controlPanel=new a.EditorControlPanel(this);this.definitionPanel=new a.EditorDefinitionPanel(this);this.programPanel=new a.EditorProgramPanel(this);this.graphicPanel=new a.EditorGraphicPanel(this);this.graphic3DPanel=new a.EditorGraphic3DPanel(this);this.animationPanel=new a.EditorAnimationPanel(this);b=document.createElement("div");b.setAttribute("class","DescartesExtraInfo");b.innerHTML="&lt;/ajs&gt;";this.listContainer.appendChild(b);this.wichParamSelected=
null;a.hasTouchSupport?this.listContainer.addEventListener("touchend",d):this.listContainer.addEventListener("click",d)};a.Editor.prototype.configFooter=function(){function d(a){a.preventDefault();this.blur();var c=b.configPanel.getContent()+b.spacePanel.getContent()+b.controlPanel.getContent()+b.definitionPanel.getContent()+b.programPanel.getContent()+b.graphicPanel.getContent()+b.graphic3DPanel.getContent()+b.animationPanel.getContent();a=document.createElement("ajs");c=c.split("\n");a.innerHTML=
c[0];a=a.firstChild;c[0]="";a.innerHTML=c.join("\n");b.parent.applet.parentNode.replaceChild(a,b.parent.applet);b.parent.applet=a;b.parent.children=a.getElementsByTagName("param");b.parent.width=parseFloat(a.getAttribute("width"));b.parent.height=parseFloat(a.getAttribute("height"));b.hide();b.parent.init()}function c(a){a.preventDefault();this.blur();b.hide()}var b=this,e=document.createElement("div");e.setAttribute("class","DescartesButtonsPlace");var g=this.newButton("Aceptar"),p=this.newButton("Cancelar");
e.appendChild(g);e.appendChild(p);this.container.appendChild(e);a.hasTouchSupport?(p.addEventListener("touchend",c),g.addEventListener("touchend",d)):(p.addEventListener("click",c),g.addEventListener("click",d))};a.Editor.prototype.configAddPanel=function(){function f(a){e.previousAddSelected&&(e.previousAddSelected.className=e.previousAddSelected.className.replace(/(?:^|\s)DescartesElementSelected(?!\S)/g,""));e.previousAddSelected=a.target;a.target.className+=" DescartesElementSelected";e.addOptionValue=
a.target.getAttribute("data-index")}function c(a){a.preventDefault();this.blur();e.hideAddPanel();e.addAttribute()}function b(a){a.preventDefault();this.blur();e.hideAddPanel()}var e=this;this.addPanelContainer=document.createElement("div");this.addPanelContainer.setAttribute("class","DescartesEditorContainer");this.addPanelContainer.style.background="rgba(20,20,20,.75)";this.container.appendChild(this.addPanelContainer);var g=document.createElement("div");g.setAttribute("class","DescarteslistContainer DescartesAddPanel");
this.addPanelContainer.appendChild(g);var p=document.createElement("ul");g.appendChild(p);for(var h=0,q=d.length;h<q;h++)g=document.createElement("li"),g.setAttribute("style","-webkit-user-select:none; -moz-user-select:none; user-select:none; cursor:pointer;"),g.setAttribute("data-index",h),g.innerHTML=d[h],p.appendChild(g);this.addOptionValue=-1;this.previousAddSelected=null;a.hasTouchSupport?p.addEventListener("touchend",f):p.addEventListener("click",f);p=document.createElement("div");p.setAttribute("class",
"DescartesButtonsPlace");g=this.newButton("Aceptar");h=this.newButton("Cancelar");p.appendChild(g);p.appendChild(h);this.addPanelContainer.appendChild(p);a.hasTouchSupport?(g.addEventListener("touchend",c),h.addEventListener("touchend",b)):(g.addEventListener("click",c),h.addEventListener("click",b));this.hideAddPanel()};a.Editor.prototype.addAttribute=function(){var a=parseInt(this.addOptionValue);0<=a&&(this.wichParamSelected&&(this.wichParamSelected.className=this.wichParamSelected.className.replace(/(?:^|\s)DescartesElementSelected(?!\S)/g,
"")),0<=a&&3>a?this.wichParamSelected=this.spacePanel.add(e[a]):3<=a&&12>a?this.wichParamSelected=this.controlPanel.add(e[a]):12<=a&&16>a?this.wichParamSelected=this.definitionPanel.add(e[a]):16<=a&&19>a?this.wichParamSelected=this.programPanel.add(e[a]):19<=a&&31>a?this.wichParamSelected=this.graphicPanel.add(e[a]):31<=a&&a<e.length-1?this.wichParamSelected=this.graphic3DPanel.add(e[a]):this.animationPanel.add());this.wichParamSelected&&(this.listContainer.scrollTop=this.wichParamSelected.offsetTop);
this.addOptionValue=-1;this.previousAddSelected&&(this.previousAddSelected.className=this.previousAddSelected.className.replace(/(?:^|\s)DescartesElementSelected(?!\S)/g,""))};a.Editor.prototype.removeAttribute=function(){var a;this.wichParamSelected&&(a=this.wichParamSelected.parentNode,a!=this.configPanel.ulContainer&&(a==this.spacePanel.ulContainer?this.spacePanel.remove(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.controlPanel.ulContainer?this.controlPanel.remove(parseInt(this.wichParamSelected.getAttribute("data-index"))):
a==this.definitionPanel.ulContainer?this.definitionPanel.remove(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.programPanel.ulContainer?this.programPanel.remove(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.graphicPanel.ulContainer?this.graphicPanel.remove(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.graphic3DPanel.ulContainer?this.graphic3DPanel.remove(parseInt(this.wichParamSelected.getAttribute("data-index"))):this.animationPanel.remove()))};
a.Editor.prototype.cloneAttribute=function(){var a;this.wichParamSelected&&(a=this.wichParamSelected.parentNode,a==this.spacePanel.ulContainer?this.wichParamSelected=this.spacePanel.clone(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.controlPanel.ulContainer?this.wichParamSelected=this.controlPanel.clone(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.definitionPanel.ulContainer?this.wichParamSelected=this.definitionPanel.clone(parseInt(this.wichParamSelected.getAttribute("data-index"))):
a==this.programPanel.ulContainer?this.wichParamSelected=this.programPanel.clone(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.graphicPanel.ulContainer?this.wichParamSelected=this.graphicPanel.clone(parseInt(this.wichParamSelected.getAttribute("data-index"))):a==this.graphic3DPanel.ulContainer&&(this.wichParamSelected=this.graphic3DPanel.clone(parseInt(this.wichParamSelected.getAttribute("data-index")))))};a.Editor.prototype.moveUpAttribute=function(){var a;this.wichParamSelected&&
(a=this.wichParamSelected.parentNode,a==this.spacePanel.ulContainer?this.wichParamSelected=this.spacePanel.moveUp(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.controlPanel.ulContainer?this.wichParamSelected=this.controlPanel.moveUp(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.definitionPanel.ulContainer?this.wichParamSelected=this.definitionPanel.moveUp(parseInt(this.wichParamSelected.getAttribute("data-index")))||
this.wichParamSelected:a==this.programPanel.ulContainer?this.wichParamSelected=this.programPanel.moveUp(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.graphicPanel.ulContainer?this.wichParamSelected=this.graphicPanel.moveUp(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.graphic3DPanel.ulContainer&&(this.wichParamSelected=this.graphic3DPanel.moveUp(parseInt(this.wichParamSelected.getAttribute("data-index")))||
this.wichParamSelected))};a.Editor.prototype.moveDownAttribute=function(){var a;this.wichParamSelected&&(a=this.wichParamSelected.parentNode,a==this.spacePanel.ulContainer?this.wichParamSelected=this.spacePanel.moveDown(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.controlPanel.ulContainer?this.wichParamSelected=this.controlPanel.moveDown(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.definitionPanel.ulContainer?
this.wichParamSelected=this.definitionPanel.moveDown(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.programPanel.ulContainer?this.wichParamSelected=this.programPanel.moveDown(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.graphicPanel.ulContainer?this.wichParamSelected=this.graphicPanel.moveDown(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected:a==this.graphic3DPanel.ulContainer&&
(this.wichParamSelected=this.graphic3DPanel.moveDown(parseInt(this.wichParamSelected.getAttribute("data-index")))||this.wichParamSelected))};a.Editor.prototype.newButton=function(a){var c=document.createElement("input");c.setAttribute("class","DescartesEditorButton");c.setAttribute("type","submit");c.setAttribute("value",a);return c};a.Editor.prototype.showAddPanel=function(){this.addPanelContainer.style.display="block";this.addPanelContainer.firstChild.style.left=(parseInt(window.innerWidth)-350)/
2+"px"};a.Editor.prototype.hideAddPanel=function(){this.addPanelContainer.style.display="none"};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var d;a.DescartesLoader=function(a){this.children=a.children;this.lessonParser=a.lessonParser;this.images=a.images;this.images.length=a.images.length;this.audios=a.audios;this.audios.length=a.audios.length;this.arquimedes=a.arquimedes;this.descartesApp=a;var d=a.image_loader?a.image_loader:c(a.loader.width,a.loader.height);this.imageLoader=
document.createElement("div");this.imageLoader.width=a.width;this.imageLoader.height=a.height;this.imageLoader.setAttribute("class","DescartesLoaderImage");this.imageLoader.setAttribute("style","background-image: url("+d+"); width: "+a.width+"px; height: "+a.height+"px;");a.loader.appendChild(this.imageLoader);this.loaderBar=document.createElement("canvas");this.loaderBar.width=a.width;this.loaderBar.height=a.height;this.loaderBar.setAttribute("class","DescartesLoaderBar");this.loaderBar.setAttribute("style",
"width: "+a.width+"px; height:"+a.height+"px;");this.loaderBar.ctx=this.loaderBar.getContext("2d");a.loader.appendChild(this.loaderBar);this.barWidth=80;this.barHeight=Math.floor(a.loader.height/70);var f=this;this.timer=setInterval(function(){f.drawLoaderBar(f.loaderBar.ctx,a.width,a.height)},10);a.firstRun=!1;this.initPreloader()};a.DescartesLoader.prototype.initPreloader=function(){var b=this.children,c=this.images,d=this.audios,f=/[\w\.\-//]*(\.png|\.jpg|\.gif|\.svg)/gi,e=/[\w\.\-//]*(\.ogg|\.oga|\.mp3|\.wav)/gi;
this.arquimedes&&(c["lib/DescartesCCLicense.png"]=a.getCreativeCommonsLicenseImage(),c["lib/DescartesCCLicense.png"].addEventListener("load",function(){this.ready=1}),c["lib/DescartesCCLicense.png"].addEventListener("error",function(){this.errorload=1}));var q,m,l,s,t,n;l=0;for(t=b.length;l<t;l++)if("rtf"!==b[l].name){if(b[l].value.match(/'macro'|'makro'/g)){q="";var u;m=this.lessonParser.split(b[l].value);n=0;for(var r=m.length;n<r;n++)"expresion"===babel[m[n][0]]&&(q=m[n][1]);q&&((u=document.getElementById(q))&&
"descartes/macro"==u.type?u=u.text:(u=a.openExternalFile(q))&&!u.match(/tipo_de_macro/g)&&(u=null));if(u&&(q=u.match(f)))for(n=q.length;s<n;s++)m=q[s],m.toLowerCase().match(/vacio.gif$/)||""==m.substring(0,m.length-4)||(c[m]=new Image,c[m].addEventListener("load",function(){this.ready=1}),c[m].addEventListener("error",function(){this.errorload=1}),c[m].src=m)}if(q=b[l].value.match(f))for(s=0,n=q.length;s<n;s++)m=q[s],m.toLowerCase().match(/vacio.gif$/)||""==m.substring(0,m.length-4)||(c[m]=new Image,
c[m].addEventListener("load",function(){this.ready=1}),c[m].addEventListener("error",function(){this.errorload=1}),c[m].src=m);if(q=b[l].value.match(e))for(s=0,m=q.length;s<m;s++)this.initAudio(q[s])}for(var v in c)c.hasOwnProperty(v)&&this.images.length++;for(v in d)d.hasOwnProperty(v)&&this.audios.length++;var w=this,y=this.images.length+this.audios.length;this.sep=2*(this.barWidth-2)/y;var C=function(){w.readys=0;for(var a in c)c.hasOwnProperty(a)&&(c[a].ready||c[a].errorload)&&w.readys++;for(a in w.audios)d.hasOwnProperty(a)&&
(d[a].ready||d[a].errorload)&&w.readys++;w.readys!=y?setTimeout(C,30):(clearTimeout(w.timer),w.descartesApp.initBuildApp())};C()};a.DescartesLoader.prototype.initAudio=function(b){var c=this.audios;c[b]=new Audio(b);c[b].filename=b;var d=function(){this.ready=1},f=function(){this.canPlayType("audio/"+this.filename.substring(this.filename.length-3))||"mp3"!=this.filename.substring(this.filename.length-3)?(console.log("El archivo '"+b+"' no puede ser reproducido"),this.errorload=1):(c[b]=new Audio(this.filename.replace("mp3",
"ogg")),c[b].filename=this.filename.replace("mp3","ogg"),c[b].addEventListener("canplaythrough",d),c[b].addEventListener("load",d),c[b].addEventListener("error",f),c[b].load())};c[b].addEventListener("canplaythrough",d);c[b].addEventListener("load",d);c[b].addEventListener("error",f);a.hasTouchSupport?(c[b].load(),c[b].play(),setTimeout(function(){console.log("detenido");c[b].pause()},10),c[b].ready=1):c[b].load()};var e,f;a.DescartesLoader.prototype.drawLoaderBar=function(a,c,g){e=this.barWidth;
f=this.barHeight;a.translate(c/2,(g-65*d)/2+90*d);a.scale(d,d);a.strokeRect(-e,-f,2*e,f);a.fillStyle="#888";a.fillRect(-e+2,-f+2,2*(e-2),f-4);a.fillStyle="#1f358d";a.fillRect(-e+2,-f+2,this.readys*this.sep,f-4);a.setTransform(1,0,0,1,0,0)};var c=function(a,c){var f=document.createElement("canvas");f.width=a;f.height=c;var e=f.getContext("2d");e.save();e.strokeStyle=e.fillStyle="#1f358d";e.lineCap="round";e.lineWidth=2;e.beginPath();d=a<c?a/360:c/195;d=2.5<d?2.5:d;e.translate((a-120*d)/2,(c-65*d)/
2);e.scale(d,d);e.moveTo(3,25);e.lineTo(3,1);e.lineTo(21,1);e.bezierCurveTo(33,1,41,15,41,25);e.stroke();e.beginPath();e.moveTo(1,63);e.lineTo(1,64);e.moveTo(5,62);e.lineTo(5,64);e.moveTo(9,61);e.lineTo(9,64);e.moveTo(13,60);e.lineTo(13,64);e.moveTo(17,58);e.lineTo(17,64);e.moveTo(21,56);e.lineTo(21,64);e.moveTo(25,53);e.lineTo(25,64);e.moveTo(29,50);e.lineTo(29,64);e.moveTo(33,46);e.lineTo(33,64);e.moveTo(37,41);e.lineTo(37,64);e.moveTo(41,32);e.lineTo(41,64);e.stroke();e.font="20px descartesJS_sansserif, Arial, Helvetica, Sans-serif";
e.fillText("escartes",45,33);e.fillText("JS",98,64);e.restore();return f.toDataURL()};return a}(descartesJS||{}),descartesJS=function(a){function d(a){for(var c="[",b=0,k=a.length;b<k;b++)a[b]instanceof Array?c+=d(a[b]):(e=a[b],"undefined"!=typeof e&&e||(e=0),"string"==typeof e&&(e="'"+e+"'"),c+=e),b<k-1&&(c+=",");return c+"]"}if(a.loadLib)return a;a.DescartesApp=function(d){this.animation={playing:!1,stop:function(){}};this.applet=d;this.parentContainer=d.parentNode;this.width=parseFloat(d.getAttribute("width"));
this.height=parseFloat(d.getAttribute("height"));this.decimal_symbol=".";this.decimal_symbol_regexp=RegExp("\\"+this.decimal_symbol,"g");this.language="espa\u00f1ol";this.children=d.getElementsByTagName("param");a.creativeCommonsLicense=!0;for(var c=0,b=this.children.length;c<b;c++)"CreativeCommonsLicense"==this.children[c].name&&(a.creativeCommonsLicense="no"==this.children[c].value?!1:!0);this.code=d.getAttribute("code");this.saveState=[];this.images={};this.images.length=-1;this.audios={};this.audios.length=
-1;this.firstRun=!0;this.init()};a.DescartesApp.prototype.init=function(){this.stop();this.evaluator=new a.Evaluator(this);this.lessonParser=new a.LessonParser(this);this.arquimedes=!!this.code.match("descinst.DescartesWeb2_0.class","i")||!!this.code.match("Arquimedes","i")||!!this.code.match("Discurso","i");this.licenseA=a.creativeCommonsLicense?"{\\rtf1\\uc0{\\fonttbl\\f0\\fcharset0 Arial;\\f1\\fcharset0 Arial;\\f2\\fcharset0 Arial;\\f3\\fcharset0 Arial;\\f4\\fcharset0 Arial;}{\\f0\\fs34 __________________________________________________________________________________ \\par \\fs22                                        Los contenidos de esta unidad did\u00e1ctica interactiva est\u00e1n bajo una  {\\*\\hyperlink licencia Creative Commons|http://creativecommons.org/licenses/by-nc-sa/2.5/es/}, si no se indica lo contrario.\\par                                        La unidad did\u00e1ctica fue creada con Arqu\u00edmedes, que es un producto de c\u00f3digo abierto, {\\*\\hyperlink Creditos|http://arquimedes.matem.unam.mx/Descartes5/creditos/conCCL.html}\\par }":
"";for(var d=this.children,c,b=0,e=0,g=a.creativeCommonsLicense?90:0,p=0,h=d.length;p<h;p++)c=d[p],"rtf_height"==c.name&&(b=parseInt(c.value)),"Buttons"==babel[c.name]&&(this.buttonsConfig=this.lessonParser.parseButtonsConfig(c.value),e=this.buttonsConfig.height),"image_loader"==c.name&&(this.image_loader=c.value),"docBase"==c.name&&(this.docBase=c.value,c=document.createElement("base"),c.setAttribute("id","descartesJS_base"),c.setAttribute("href",this.docBase),document.head.appendChild(c));this.arquimedes&&
b&&(this.height=b+e+g);this.spaces=[];this.externalSpace&&document.body.removeChild(this.externalSpace.container);this.externalSpace=new a.SpaceExternal(this);this.northSpace={container:document.createElement("div"),controls:[]};this.southSpace={container:document.createElement("div"),controls:[]};this.eastSpace={container:document.createElement("div"),controls:[]};this.westSpace={container:document.createElement("div"),controls:[]};this.editableRegion={container:document.createElement("div"),textFields:[]};
a.Editor&&(this.editor=new a.Editor(this));this.controls=[];this.auxiliaries=[];this.events=[];this.cacheVars={};this.getVarsNames={};this.plecaHeight=this.tabindex=this.zIndex=0;this.numberOfIframes=1;void 0!=this.container&&this.parentContainer.removeChild(this.container);this.container=document.createElement("div");this.loader=document.createElement("div");this.parentContainer.appendChild(this.container);this.container.width=this.width;this.container.height=this.height;this.container.setAttribute("class",
"DescartesAppContainer");this.container.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px;");this.container.appendChild(this.loader);this.loader.width=this.width;this.loader.height=this.height;this.loader.setAttribute("class","DescartesLoader");this.loader.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px; z-index:1000;");this.firstRun?this.descartesLoader=new a.DescartesLoader(this):this.initBuildApp()};a.DescartesApp.prototype.initBuildApp=function(){for(var d=
this.children,c=this.lessonParser,b=[],e=[],g=[],p=[],h=[],q=[],m,l=0,s=d.length;l<s;l++)if(m=d[l],"language"==babel[m.name]&&(this.language=m.value),"pleca"==m.name)m=c.parsePleca(m.value,this.width),this.container.insertBefore(m,this.loader),this.plecaHeight=m.imageHeight?m.imageHeight:m.offsetHeight;else if("Buttons"==babel[m.name])this.buttonsConfig=c.parseButtonsConfig(m.value);else if("decimal_symbol"==babel[m.name])this.decimal_symbol=m.value,this.decimal_symbol_regexp=RegExp("\\"+this.decimal_symbol,
"g");else if("version"==babel[m.name])this.version=parseInt(m.value);else if("language"==babel[m.name])this.language=m.value;else if("rtf"==m.name){var t=(this.width-780)/2,n=parseInt(this.height)-this.plecaHeight-this.buttonsConfig.height-45;p.push("space='descartesJS_scenario' type='text' expresion='[10,20]' background='yes' text='"+m.value.replace(/'/g,"&squot;")+"'");p.push("space='descartesJS_scenario' type='text' expresion='["+t+","+(n-25)+"]' background='yes' text='"+this.licenseA+"'");a.creativeCommonsLicense&&
p.push("space='descartesJS_scenario' type='image' expresion='["+(t+15)+","+n+"]' background='yes' abs_coord='yes' file='lib/DescartesCCLicense.png'")}else"E"==m.name.charAt(0)?(m.value.match(/'HTMLIFrame'/)&&this.numberOfIframes++,b.push(m.value)):"C"==m.name.charAt(0)&&"_"==m.name.charAt(1)?e.push(m.value):"A"==m.name.charAt(0)&&"_"==m.name.charAt(1)?g.push(m.value):"G"==m.name.charAt(0)?p.push(m.value):"S"==m.name.charAt(0)?h.push(m.value):"Animation"==babel[m.name]&&q.push(m.value);this.scenarioRegion=
{container:document.createElement("div"),scroll:0};this.scenarioRegion.container.setAttribute("id","descartesJS_Scenario_Region");this.scenarioRegion.scenarioSpace=this.lessonParser.parseSpace("tipo='R2' id='descartesJS_scenario' fondo='blanco' x='0' y='0' fijo='yes' red='no' red10='no' ejes='no' text='no' ancho='"+this.width+"' alto='"+this.height+"'");this.scenarioRegion.container.appendChild(this.scenarioRegion.scenarioSpace.container);this.arquimedes&&(this.container.appendChild(this.scenarioRegion.container),
this.spaces.push(this.scenarioRegion.scenarioSpace));l=0;for(s=b.length;l<s;l++)d=c.parseSpace(b[l]),this.arquimedes&&this.scenarioRegion.container.appendChild(d.container),this.spaces.push(d),this.zIndex++;l=0;for(s=p.length;l<s;l++)if(b=c.parseGraphic(p[l]))b.visible&&(this.editableRegionVisible=!0),b.space.addGraph(b);l=0;for(s=h.length;l<s;l++)(b=c.parse3DGraphic(h[l]))&&b.space.addGraph(b,!0);l=0;for(s=e.length;l<s;l++)this.controls.push(c.parseControl(e[l]));l=0;for(s=g.length;l<s;l++)c.parseAuxiliar(g[l]);
l=0;for(s=q.length;l<s;l++)this.animation=c.parseAnimation(q[l]);this.configRegions();this.updateAuxiliaries();this.updateAuxiliaries();l=0;for(s=this.controls.length;l<s;l++)this.controls[l].init();this.updateControls();this.updateSpaces(!0);var u=this;this.numberOfIframes?setTimeout(function(){u.finishInit()},300*this.numberOfIframes):this.finishInit()};a.DescartesApp.prototype.finishInit=function(){this.update();this.loader.style.display="none";window.parent!==window&&(this.parentContainer.style.margin=
"0px",this.parentContainer.style.padding="0px",window.parent.postMessage({type:"reportSize",href:window.location.href,width:this.width,height:this.height},"*"),window.parent.postMessage({type:"ready"},"*"),a.onResize());window.opener&&window.opener.postMessage({type:"isResizeNeeded",href:window.location.href},"*");this.externalSpace.init()};a.DescartesApp.prototype.adjustSize=function(){document.body.style.margin="0px";document.body.style.padding="0px";this.parentContainer.style.margin="0px";this.parentContainer.style.padding=
"0px";var d=parseInt(this.width)+30,c=parseInt(this.height)+90;window.moveTo((parseInt(screen.width)-d)/2,(parseInt(screen.height)-c)/2);window.resizeTo(d,c);a.onResize()};a.DescartesApp.prototype.adjustDimensions=function(){var a,c,b;if(void 0==this.init_w||void 0==this.init_h)this.init_w=parseInt(this.container.style.width),this.init_h=parseInt(this.container.style.height);c=parseInt(this.parentContainer.offsetWidth);a=this.init_w;b=c/a;a>c?(this.parentContainer!=document.body&&(this.parentContainer.style.height=
this.init_h*b+"px"),this.percent=b,this.container.style.webkitTransform=this.container.style.MozTransform="scale("+b+")",this.container.style.webkitTransformOrigin=this.container.style.MozTransformOrigin="top left"):(this.parentContainer!=document.body&&(this.parentContainer.style.height="auto"),this.percent=1,this.container.style.webkitTransform=this.container.style.MozTransform="",this.container.style.webkitTransformOrigin=this.container.style.MozTransformOrigin="")};a.DescartesApp.prototype.configRegions=
function(){var d=this.evaluator.parser,c=this.buttonsConfig,b=this.container;if(2!=this.version)var e="15",g=100,p=100,h=100,q=100;else e="14",g=63,p=50,h=44,q=53;var m=0,l=0,s=0,t=s=0,n=0,u=0,r=0,v=0,u=this.northSpace.controls,w=this.southSpace.controls,y=this.eastSpace.controls,C=this.westSpace.controls;if(0<c.rowsNorth||0<u.length||c.about||c.config){0>=c.rowsNorth?(m=c.height,c.rowsNorth=1):m=c.height*c.rowsNorth;n=this.northSpace.container;n.setAttribute("id","descartesJS_northRegion");n.setAttribute("style",
"width:"+b.width+"px; height:"+m+"px; background:#c0c0c0; position:absolute; left:0px; top: "+this.plecaHeight+"px; z-index:100;");b.insertBefore(n,this.loader);var n=b.width,A=0;c.about?(A=g,n-=A):g=0;c.config&&(n-=p);for(var D=Math.ceil(u.length/c.rowsNorth),E=n/D,s=0,z=u.length;s<z;s++)u[s].expresion=d.parse("("+(A+s%D*E)+","+c.height*Math.floor(s/D)+","+E+","+c.height+")"),u[s].drawif=d.parse("1"),u[s].init();c.about&&(s="espa\u00f1ol"==this.language?"cr\u00e9ditos":"english"==this.language?"about":
"cr\u00e9ditos",s=new a.Button(this,{region:"north",name:s,font_size:d.parse(e),expresion:d.parse("(0, 0, "+g+", "+m+")")}),s.actionExec={execute:a.showAbout},s.update());c.config&&(new a.Button(this,{region:"north",name:"config",font_size:d.parse(e),action:"config",expresion:d.parse("("+(n+g)+", 0, "+p+", "+m+")")})).update()}if(0<c.rowsSouth||0<w.length||c.init||c.clear){0>=c.rowsSouth?(l=c.height,c.rowsSouth=1):l=c.height*c.rowsSouth;u=b.width;A=0;c.init?(A=h,u-=A):h=0;c.clear&&(u-=q);n=this.southSpace.container;
n.setAttribute("id","descartesJS_southRegion");n.setAttribute("style","width:"+b.width+"px; height:"+l+"px; background:#c0c0c0; position:absolute; left: 0px; top:"+(b.height-l)+"px; z-index:100;");b.insertBefore(n,this.loader);D=Math.ceil(w.length/c.rowsSouth);E=u/D;s=0;for(z=w.length;s<z;s++)w[s].expresion=d.parse("("+(A+s%D*E)+","+c.height*Math.floor(s/D)+","+E+","+c.height+")"),w[s].drawif=d.parse("1"),w[s].init();c.init&&(s="espa\u00f1ol"==this.language?"inicio":"english"==this.language?"init":
"inicio",(new a.Button(this,{region:"south",name:s,font_size:d.parse(e),action:"init",expresion:d.parse("(0, 0, "+h+", "+l+")")})).update());c.clear&&(s="espa\u00f1ol"==this.language?"limpiar":"english"==this.language?"clear":"limpiar",(new a.Button(this,{region:"south",name:s,font_size:d.parse(e),action:"clear",expresion:d.parse("("+(u+h)+", 0, "+q+", "+l+")")})).update())}if(0<y.length)for(s=b.height-m-l,r=c.widthEast,n=this.eastSpace.container,n.setAttribute("id","descartesJS_eastRegion"),n.setAttribute("style",
"width:"+r+"px; height:"+s+"px; background:#c0c0c0; position:absolute; left:"+(b.width-r)+"px; top:"+m+"px; z-index:100;"),b.insertBefore(n,this.loader),s=0,z=y.length;s<z;s++)y[s].expresion=d.parse("(0,"+c.height*s+","+r+","+c.height+")"),y[s].drawif=d.parse("1"),y[s].init();if(0<C.length)for(s=b.height-m-l,v=c.widthWest,n=this.westSpace.container,n.setAttribute("id","descartesJS_westRegion"),n.setAttribute("style","width: "+v+"px; height: "+s+"px; background: #c0c0c0; position: absolute; left: 0px; top: "+
m+"px; z-index: 100;"),b.insertBefore(n,this.loader),s=0,z=C.length;s<z;s++)C[s].expresion=d.parse("(0,"+c.height*s+","+v+","+c.height+")"),C[s].drawif=d.parse("1"),C[s].init();if(this.editableRegionVisible)for(t=c.height,n=this.editableRegion.container,n.setAttribute("id","descartesJS_editableRegion"),n.setAttribute("style","width:"+b.width+"px; height:"+t+"px; position:absolute; left:0px; top:"+(b.height-l-c.height)+"px; z-index:100; background:#c0c0c0; overflow:hidden;"),b.insertBefore(n,this.loader),
d=this.editableRegion.textFields,c=b.width/d.length,e=a.getFieldFontSize(t),s=0,z=d.length;s<z;s++)"div"==d[s].type?(n.appendChild(d[s].container),d[s].container.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; width: "+(c-4)+"px; height: "+t+"px; position: absolute; left: "+s*c+"px; top: 0px;"),g=d[s].container.firstChild,g.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; font-size: "+e+"px; padding-top: 0%; background-color: #e0e4e8; position: absolute; left: 0px; top: 0px; height:"+
t+"px; text-align: center; line-height: "+t+"px;"),p=g.offsetWidth,g.style.width=p+"px",g.firstChild.textContent=g.firstChild.textContent.substring(3,g.firstChild.textContent.length-3),d[s].container.lastChild.setAttribute("style","font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+e+"px; width:"+(c-p)+"px; height:"+t+"px; position:absolute; left:"+p+"px; top:0px; border:2px groove white;")):(n.appendChild(d[s]),d[s].setAttribute("style","font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+
e+"px; width:"+c+"px; height:"+t+"px; position:absolute; left:"+s*c+"px; top:0px; border:2px groove white;"));this.displaceRegionNorth=m;this.displaceRegionWest=v;b.width-=r;b.height=b.height-l-t;s=0;for(z=this.spaces.length;s<z;s++)this.spaces[s].init()};a.DescartesApp.prototype.update=function(){this.updateAuxiliaries();this.updateControls();this.updateEvents();this.updateControls();this.updateSpaces()};a.DescartesApp.prototype.clearClick=function(){for(var a=0,c=this.spaces.length;a<c;a++)this.spaces[a].clearClick()};
a.DescartesApp.prototype.deactivateGraphiControls=function(){for(var a,c=0,b=this.controls.length;c<b;c++)a=this.controls[c],"graphic"==a.type&&a.deactivate()};a.DescartesApp.prototype.updateAuxiliaries=function(){for(var a=0,c=this.auxiliaries.length;a<c;a++)this.auxiliaries[a].update()};a.DescartesApp.prototype.updateEvents=function(){for(var a=0,c=this.events.length;a<c;a++)this.events[a].update()};a.DescartesApp.prototype.updateControls=function(){for(var a=0,c=this.controls.length;a<c;a++)this.controls[a].update()};
a.DescartesApp.prototype.updateSpaces=function(a){for(var c=0,b=this.spaces.length;c<b;c++)this.spaces[c].update(a)};a.DescartesApp.prototype.clear=function(){for(var a=0,c=this.spaces.length;a<c;a++)this.spaces[a].spaceChange=!0,this.spaces[a].drawBackground&&this.spaces[a].drawBackground()};a.DescartesApp.prototype.play=function(){this.animation&&this.animation.play()};a.DescartesApp.prototype.stop=function(){this.animation&&this.animation.stop()};a.DescartesApp.prototype.reinitAnimation=function(){this.animation&&
this.animation.play()};a.DescartesApp.prototype.stopAudios=function(){this.stop();for(var a in this.audios)this.audios.hasOwnProperty(a)&&this.audios[a].pause&&(this.audios[a].pause(),this.audios[a].currentTime=0)};a.DescartesApp.prototype.getImage=function(a){var c=this.images;if(a)return c[a]||(c[a]=new Image,c[a].addEventListener("load",function(){this.ready=1}),c[a].addEventListener("error",function(){this.errorload=1}),c[a].src=a),c[a]};a.DescartesApp.prototype.getAudio=function(a){var c=this.audios;
if(a){if(!c[a]){var b=a.lastIndexOf("."),b=-1===b?a.lenght:b;a.substring(0,b);c[a]=new Audio(a);var d=function(a){this.ready=1};c[a].addEventListener("canplaythrough",d);var e=function(b){this.canPlayType("audio/"+a.substring(a.length-3))||"mp3"!=a.substring(a.length-3)?(console.log("El archivo '"+a+"' no puede ser reproducido"),this.errorload=1):(c[a]=new Audio(a.replace("mp3","ogg")),c[a].addEventListener("canplaythrough",d),c[a].addEventListener("load",d),c[a].addEventListener("error",e),c[a].load())};
c[a].addEventListener("error",e);c[a].play();setTimeout(function(){c[a].pause()},15)}return c[a]}return new Audio};a.DescartesApp.prototype.getControlByCId=function(a){for(var c,b=0,d=this.controls.length;b<d;b++)if(c=this.controls[b],c.cID==a)return c;return{update:function(){},w:0}};a.DescartesApp.prototype.getControlById=function(a){for(var c,b=0,d=this.controls.length;b<d;b++)if(c=this.controls[b],c.id==a)return c;return{update:function(){}}};a.DescartesApp.prototype.getSpaceByCId=function(a){for(var c,
b=0,d=this.spaces.length;b<d;b++)if(c=this.spaces[b],c.cID==a)return c;return{update:function(){},w:0}};a.DescartesApp.prototype.getSpaceById=function(a){for(var c,b=0,d=this.spaces.length;b<d;b++)if(c=this.spaces[b],c.id==a)return c;return{update:function(){},w:0}};var e;a.DescartesApp.prototype.getState=function(){var a,c="",b=this.evaluator.variables,e;for(e in b)b.hasOwnProperty(e)&&(a=b[e],"string"==typeof a&&(a="'"+a+"'"),void 0!=a&&"rnd"!=e&&"pi"!=e&&"e"!=e&&"Infinity"!=e&&"-Infinity"!=e&&
"object"!=typeof a&&(c=""!=c?c+"\n"+e+"="+a:e+"="+a));var b=this.evaluator.vectors,g;for(g in b)b.hasOwnProperty(g)&&(a=b[g],c=c+"\n"+g+"="+d(a));g=this.evaluator.matrices;for(var p in g)g.hasOwnProperty(p)&&(a=g[p],c=c+"\n"+p+"="+d(a));return c};a.DescartesApp.prototype.setState=function(a,c){for(var b=a.split("\n"),d,e,p=0,h=b.length;p<h;p++)d=b[p].split("="),2<=d.length&&(e=eval(d[1]),-1!=d[1].indexOf("[[")?(this.evaluator.matrices[d[0]]=e,this.evaluator.matrices[d[0]].rows=e.length,this.evaluator.matrices[d[0]].cols=
e[0].length):-1!=d[1].indexOf("[")?(this.evaluator.vectors[d[0]]=e,this.evaluator.variables[d[0]+".long"]=e.length):this.evaluator.variables[d[0]]=e);c||this.update()};a.DescartesApp.prototype.getEvaluation=function(){for(var a=0,c=0,b="",d=0,e=this.controls.length;d<e;d++)"textfield"==this.controls[d].gui&&this.controls[d].evaluate&&(a++,c+=this.controls[d].ok,this.controls[d].value=""==this.controls[d].value?"''":this.controls[d].value,b+=" \\n "+this.controls[d].id+"="+this.controls[d].value+"|"+
this.controls[d].ok);return"questions="+a+" \\n correct="+c+" \\n wrong="+(a-c)+b};a.DescartesApp.prototype.showSolution=function(){for(var a=this.controls,c=0,b=a.length;c<b;c++)"textfield"==a[c].gui&&a[c].evaluate&&a[c].changeValue(a[c].getFirstAnswer());this.update()};a.DescartesApp.prototype.showAnswer=function(){for(var a=0,c=this.saveState.length;a<c;a++)this.evaluator.evalExpression(this.saveState[a]);this.update()};return a}(descartesJS||{}),descartesJS=function(a){function d(){var a=document.getElementById("StyleDescartesApps");
a&&a.parentNode.removeChild(a);a=document.createElement("style");a.id="StyleDescartesApps";a.type="text/css";a.setAttribute("rel","stylesheet");a.innerHTML="applet.DescartesJS {display:none;} applet {display:none;} ajs.DescartesJS {display:none;} ajs {display:none;}";document.head.appendChild(a)}function e(b){b=document.createElement("div");b.innerHTML='<span style="font:12px descartesJS_serif;visibility:hidden;">_</span><span style="font:12px descartesJS_sansserif;visibility:hidden;">_</span><span style="font:12px descartesJS_monospace;visibility:hidden;">_</span>';
document.body.appendChild(b);a.getFeatures();if(a.hasCanvasSupport){window.scrollTo(0,10);for(var c=document.getElementsByTagName("*"),d=[],e=0,f=c.length;e<f;e++)"DescartesAppContainer"==c[e].className&&d.push(c[e]);e=0;for(f=d.length;e<f;e++)d[e].parentNode.removeChild(d[e]);for(var d=document.getElementsByTagName("applet"),e=document.getElementsByTagName("ajs"),c=[],m=0,l=d.length;m<l;m++)f=d[m],(f.getAttribute("code").match("DescartesJS")||f.getAttribute("code").match("descinst.DescartesWeb2_0.class")||
f.getAttribute("code").match("Descartes")||f.getAttribute("code").match("Arquimedes")||f.getAttribute("code").match("Discurso"))&&c.push(f);m=0;for(l=e.length;m<l;m++)f=e[m],(f.getAttribute("code").match("DescartesJS")||f.getAttribute("code").match("descinst.DescartesWeb2_0.class")||f.getAttribute("code").match("Descartes")||f.getAttribute("code").match("Arquimedes")||f.getAttribute("code").match("Discurso"))&&c.push(f);d=0;for(e=c.length;d<e;d++)a.apps.push(new a.DescartesApp(c[d])),c[d].className=
"DescartesJS";window.addEventListener("resize",a.onResize);window.scrollTo(0,2);document.body.setAttribute("tabIndex",1E6)}else document.getElementById("StyleDescartesApps").innerHTML="applet.DescartesJS {display:block;} applet {display:block;} ajs.DescartesJS {display:block;} ajs {display:block;}";document.body.removeChild(b)}if(a.loadLib)return a;a.apps=[];a.getDescartesApps=function(){return a.apps};window.hasOwnProperty("debugDescartesJS")&&debugDescartesJS||d();a.onResize=function(b){for(var c=
0,d=a.apps.length;c<d;c++){b=a.apps[c].spaces;for(var e=0,f=b.length;e<f;e++)b[e].findOffset()}};a.receiveMessage=function(b){if(0<a.apps.length){var c=b.data;if(c)if("set"===c.type)"string"==typeof c.value||"number"==typeof c.value?a.apps[0].evaluator.setVariable(c.name,c.value):c.value&&void 0!=c.value.rows?a.apps[0].evaluator.matrices[c.name]=c.value:a.apps[0].evaluator.vectors[c.name]=c.value;else if("update"===c.type)a.apps[0].update();else if("exec"===c.type){b=a.apps[0].evaluator.getFunction(c.name);
var d=[];""!==c.value&&(d=c.value.toString().split(","));b&&b.apply(a.apps[0].evaluator,d)}else"isResizeNeeded"===c.type?b.source.postMessage({type:"doResize"},"*"):"doResize"===c.type&&0<a.apps.length&&a.apps[0].adjustSize()}};if(void 0==a.loadLib){a.loadLib=!0;window.addEventListener("load",e);window.addEventListener("message",a.receiveMessage);for(var f=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd"],c=0,b=f.length;c<b;c++)window.addEventListener(f[c],function(b){a.onResize(b)})}return a}(descartesJS||
{});
